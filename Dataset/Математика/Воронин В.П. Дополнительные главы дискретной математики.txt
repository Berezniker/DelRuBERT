Московский Государственный Университет
имени М. В. Ломоносова
Факультет Вычислительной Математики и Кибернетики
Кафедра Математической Кибернетики

Д ОПОЛНИТЕЛЬНЫЕ ГЛАВЫ
ДИСКРЕТНОЙ МАТЕМАТИКИ
лектор — старший преподаватель В. П. Воронин
составитель — А. Д. Поспелов

Москва — 2002

Содержание
1 Комбинаторика
Бинарное отношение . . . . . . . . . . . . . . . . . . . . . . .
1.1 Простейшие комбинаторные числа . . . . . . . . . . . . . . .
Перестановки . . . . . . . . . . . . . . . . . . . . . . . . . .
Принцип включения и исключения . . . . . . . . . . . . . . .
Перестановки с ограничениями . . . . . . . . . . . . . . . . .
Примеры . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Упражнения . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.2 Производящие функции . . . . . . . . . . . . . . . . . . . . .
Разбиения множества . . . . . . . . . . . . . . . . . . . . . .
Рекуррентные соотношения и производящие функции . . . .
Основные свойства обычных производящих функций . . . .
Основные преобразования обычных производящих функций
Примеры . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Упражнения . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.3 Простейшие перечислительные задачи . . . . . . . . . . . .
Вводные замечания . . . . . . . . . . . . . . . . . . . . . . .
Основные леммы . . . . . . . . . . . . . . . . . . . . . . . . .
Теорема Пойа . . . . . . . . . . . . . . . . . . . . . . . . . .
Примеры . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Упражнения . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.4 Частично упорядоченные множества . . . . . . . . . . . . . .
Основные понятия . . . . . . . . . . . . . . . . . . . . . . . .
Цепи Анселя . . . . . . . . . . . . . . . . . . . . . . . . . . .
Алгебры инцидентности . . . . . . . . . . . . . . . . . . . . .
Решетки . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Примеры . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Упражнения . . . . . . . . . . . . . . . . . . . . . . . . . . .

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

2
2
4
5
7
8
11
16
18
18
22
27
28
29
33
34
34
35
37
38
42
42
42
46
51
54
60
61

2 Конечнозначные логики
2.1 Функции конечнозначной логики . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Определения и примеры . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Реализация функций формулами . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Первая и вторая формы . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Операция замыкания, свойства замыкания, замкнутые классы . . . . . . . . . . . . . . . . . . . . .
Полные системы, примеры полных систем . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Теорема о полноте системы Поста . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Функция Вебба . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Примеры . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Упражнения . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.2 Теоремы о функциональной полноте . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Теорема об алгоритмической разрешимости проблемы распознавания полноты в k-значной логике
Теорема Кузнецова о функциональной полноте . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.3 Существенные функции . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Леммы о существенных функциях . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Теоремы о существенных функциях . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Примеры . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Упражнения . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2.4 Особенности многозначных логик . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Представление функции k-значной логики полиномами . . . . . . . . . . . . . . . . . . . . . . . . .
Теоремы о замкнутых классах в Pk при k > 3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Примеры . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Упражнения . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

62
62
62
64
64
65
68
70
70
71
76
77
77
77
78
78
80
81
82
83
83
83
84
86

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.

2

ГЛАВА 1. КОМБИНАТОРИКА

Глава 1

Комбинаторика
Основным объектом изучения комбинаторики является как правило конечное (хотя, возможно, и счетное) множество,
из элементов которого составляются различные комбинаторные конфигурации. Основными вопросами при этом являются существование требуемых конфигураций, алгоритмы их построения, оптимизация алгоритмов (если таковые
существуют), а также задачи перечислительного характера (например, количество конфигураций с требуемыми свойствами).
Одним из наиболее популярных примеров комбинаторной постановки может служить задача о магическом квадрате. Она ставится следующим образом: для данного натурального n расположить числа от 1 до n2 в целочисленных
точках квадрата плоскости Oxy : 1 6 x 6 n, 1 6 y 6 n так, чтобы сумма всех чисел, расположенных в любом столбце,
была равна сумме всех чисел, расположенных в любой строке и равнялась сумме всех чисел, стоящих на каждой из
диагоналей. К положительным достижениям в решении этой задачи относится, например, факт существования алгоритма, строящего магический квадрат для любого заданного n. В то же время открытым остается вопрос о количестве
различных магических квадратов для n > 5. Примером магического квадрата для n = 3 может выступать следующий:
2
9
4

7
5
3

6
1 .
8

Другим известным примером является задача о шести офицерах, которая ставится следующим образом: имеется
шесть полков, в каждом полку имеется шесть офицеров, причем все имеют разные звания. Вопрос заключается в том,
возможно ли расположить всех этих офицеров в квадрате 6 × 6 так, чтобы на любой линии стояли офицеры из разных
полков и с разными званиями. Задача обобщается на случай n = 4k + 2 полков и званий. Доказано, что при k = 1
решения не существует, а при k > 2 решение имеется.
Бинарное отношение.
Определение 1.0.1. Декартовым произведением множеств X и Y называется множество
X ×Y = {(x, y) | x ∈ X, y ∈ Y }.
Определение 1.0.2. Любое подмножество декартова произведения ρ ⊆ X ×Y называется бинарным отношением.
Примерами бинарного отношения могут служить равенство x = y, предшествование x 6 y и другие. Областью определения бинарного отношения ρ называется множество
Dρ = {x ∈ X| ∃ (x, y) ∈ ρ}.
Областью значений бинарного отношения ρ называется множество
Rρ = {y ∈ Y | ∃ (x, y) ∈ ρ}.
Из определения следует, что пустое множество ∅ также считается бинарным отношением.
Бинарное отношение может задаваться также в виде прямоугольной (вообще говоря, бесконечной) 0, 1-матрицы:

i

j
..
.


· · · 1 · · ·


..

. 0

..
.








n×m

где n — мощность множества X, а m — мощность множества Y могут, вообще говоря, равняться счетной бесконечности.
Считается, что все элементы каждого из множеств X и Y пронумерованы натуральными числами. Элемент матрицы с
индексом (i, j) равняется единице тогда и только тогда, когда пара (xi , y j ) ∈ ρ, где xi — элемент из X, занумерованный
числом i, а y j — элемент из Y , занумерованный числом j; и равняется нулю в противном случае.

3
Бинарное отношение можно задать в виде двудольного орграфа:
`

` i` H
` ` ` `
H

C
j`
` CW` ` H
`
` H
j

`X
`Y

при этом дуга из элемента из X с номером i идет к элементу из Y с номером j тогда и только тогда, когда (xi , y j ) ∈ ρ.
Такое задание бинарного отношения позволяет рассматривать его как многозначное отображение.
Определение 1.0.3. Обратным бинарным отношением к ρ называется бинарное отношение
ρ −1 = {(y, x) | (x, y) ∈ ρ} .
Определение 1.0.4. Композицией бинарных отношений ρ1 и ρ2 называется бинарное отношение
ρ = ρ2 ◦ ρ1 = {(x, z) | ∃y : (x, y) ∈ ρ1 , (y, z) ∈ ρ2 } .
Очевидны простейшие свойства этих операций:
ρ −1
и

−1

=ρ

(ρ2 ◦ ρ1 )−1 = ρ1−1 ◦ ρ2−1 .

В дальнейшем будем рассматривать частный случай бинарного отношения — X = Y — бинарное отношение на декартовом квадрате. Введем для него следующие аксиомы.
1. Аксиома рефлексивности: для любого x ∈ X выполняется xρ x. Иными словами в матрице, задающей это бинарное отношение, на диагонали стоят единицы.
2. Аксиома симметричности: для любых x, y ∈ X выполняется xρ y ⇒ yρ x. Иными словами, матрица, задающая это
бинарное отношение, является симметрической.
3. Аксиома транзитивности: для любых x, y, z ∈ X выполняется xρ y & yρ z ⇒ xρ z.
4. Аксиома антисимметричности: для любых x, y ∈ X выполняется xρ y & yρ x ⇒ x = y.
Определение 1.0.5. Аксиомы 1, 2 и 3 определяют отношение эквивалентности. Такое отношение разбивает множество X, на котором оно задано, на классы эквивалентности, множество которых в свою очередь называется фактормножеством.
Часто в комбинаторных постановках требуется узнать по заданному основному множеству и отношению эквивалентности на нем число классов эквивалентности. Отношение эквивалентности можно задавать группой перестановок. В
этом случае возможен вопрос о числе элементов в множестве по известной группе перестановок.
Определение 1.0.6. Аксиомы 1, 3 и 4 определяют бинарное отношение частичного порядка. Примером может
.
служить упорядочение множества натуральных чисел по делимости: y | x или x..y означает, что y является делителем
числа x. Множество с заданным на нем частичным порядком называется частично упорядоченным.
Частично упорядоченное по делимости множество натуральных чисел обозначается (N, |). Бинарные отношения
частичного порядка удобно изображать с помощью диаграмм Хассе. Диаграмма Хассе представляет собой ориентированный ациклический граф, множеством вершин которого является исходное множество, а дуга между вершинами x
и y рисуется тогда и только тогда, когда xρ y и @z : xρ z & zρ y. Например, частичный порядок наборов из нулей и единиц,
определяющий монотонность функций алгебры логики, будет выглядеть на диаграмме Хассе следующим образом:
(111)
6
@
I
@
@
@ (011)
(110)
(101)
6
I
@
@
6
I
@
@
@
@
@
(100)
(010) @ (001)
I
@
6

@
@
@
(000)

4

ГЛАВА 1. КОМБИНАТОРИКА

В некоторых случаях можно обойтись без дуг, располагая элементы множества по ярусам. Так, например, вышеописанное частично упорядоченное множество (N, |) можно изобразить так:
`
`
8 ` 12 ` 30 `
\
L
L\
L\
L \
4 ` 6 ` 9 ` 10L` 15\`
, ,

, ,

, ,
, , 
, , 
` 3,
` 5
` 7`
`
2,
l \ L
l \ L
l \L
l
\L
l
l
\L`
1

`

`

`

`

квадраты простых, простое·простое

`

`

простые

кубы простых, простое2 ·простое,
простое·простое·простое

единица

Также в случае X = Y граф, описывающий частично упорядоченное множество, не обязательно будет двудольным и
может выглядеть по-другому:
`
`
`
`
`

`

По индукции можно определить также n-арные отношения. Помимо аксиом 1, 2, 3 и 4 может оказаться также, что
xρ y & xρ z ⇒ y = x. Если рассматривать бинарное отношение как функцию f , ставящую в соответствие множеству X
некоторое другое множество D f , то в этом случае она будет инъективной. Область определения f : X → Y совпадает с
X, область значений в то же время не обязательно совпадает с Y . В случае X = Y и D f = X при конечных множествах f
взаимно однозначна. На функции распространяются определенные на бинарных отношениях композиции и обратные
элементы. Таким образом, появляется связь комбинаторных чисел с функциями.
Часто бывает удобным исследовать не саму комбинаторную конфигурацию, а в некотором роде изоморфную ей. С
тем, чтобы сделать это рассмотрение корректным, сформулируем принцип взаимно однозначного соответствия.
Если одному множеству комбинаторных конфигураций с определенными свойствами изоморфно относительно этих
свойств ставится в соответствие другое множество комбинаторных конфигураций, то число комбинаций, обладающих
определенными свойствами в обоих множествах одно и то же.

1.1

Простейшие комбинаторные числа

Пусть X = {1, 2, . . . , n} ,Y = {y1 , . . . , ym }. Множество всех отображений множества X во множество Y обозначается Y X .
Оно имеет мощность mn . Это множество изоморфно множеству раскладок n шаров, помеченных числами 1, . . . , n по m
ящикам, помеченным элементами y1 , . . . , ym , также оно изоморфно множеству слов yi1 yi2 . . . yin длины n в алфавите Y .
Отображение f называется инъективным, если i 6= j & i → ys , j → y` ⇒ ys 6= y` . Для того, чтобы отображение было
инъективно, очевидно, необходимо, чтобы |X| 6 |Y |, то есть n 6 m. Число инъективных отображений равно убывающему факториалу [m]n = m (m − 1) (m − 2) · · · (m − n + 1). В терминах шаров и ящиков этому множеству соответствует
множество раскладок n различимых шаров по m различимым ящикам так, чтобы в каждом ящике было бы не более
одного шара. В терминах слов в алфавите Y этому множеству соответствует множество слов длины n в алфавите Y ,
все буквы в котором различны. Отображение f называется сюръективным, если R f = Y , то есть каждый элемент
из Y имеет хотя бы один прообраз. Для того, чтобы отображение было сюръективным, очевидно, необходимо, чтобы
|X| > |Y |. По принципу взаимно однозначного соответствия этой комбинаторной конфигурации соответствует множество раскладок n различимых шаров по m различимым ящикам так, чтобы в каждом ящике оказалось хотя бы по одному
шару или множество слов длины n в алфавите из m букв таких, что
 каждая буква алфавита присутствует в слове хотя
бы один раз. Число сюръективных отображений X в Y равно mn · m! · mn−m . Отображение, являющееся одновременно сюръективным и инъективным, называется биективным (взаимно однозначным, биекцией). Для того, чтобы
отображение было биективным, очевидно, необходимо, чтобы |X| = |Y |. В случае конечных множеств следующие три
утверждения эквивалентны:
1. f биективно;
2. f сюръективно и |X| = |Y |;
3. f инъективно и |X| = |Y |.

5

1.1. ПРОСТЕЙШИЕ КОМБИНАТОРНЫЕ ЧИСЛА
Определение 1.1.1. Биективные отображения конечных множеств в себя называются перестановками.
Введем бинарное отношение на множестве инъективных отображений: fρ g ⇔ R f = Rg .
X
A B B   
A B B  
AU BN  BN  
Rf = n

Y

Очевидно, это будет являться отношением эквивалентности. Оно разбивает все множество инъективных отображений
на n! классов эквивалентности. В силу свойств фактормножества, его мощность будет равна биномиальному коэф
[m]
m!
= Cmn = mn . По принципу взаимно однозначного соответствия вышеописанное фактормножефициенту n!n = n!(m−n)!
ство эквивалентно множеству n-элементных подмножеств m-элементного множества или множеству наборов из нулей
и единиц длины m ровно с n единицами.
Этот результат можно обобщить, если допустить вхождение элементов в подмножество с кратностью. Мультимножеством называется множество, у каждого элемента которого есть кратность — натуральное число, символизирующее количество вхождений данного элемента в мультимножество. Мощностью мультимножества называется
сумма кратностей всех его элементов. Иными словами необходимо найти число мультиподмножеств мощности n множества Y, |Y | = m. Используя принцип взаимно однозначного соответствия, подсчет можно перенести на наборы целых
неотрицательных чисел:

α1 + α2 + · · · + αm = n,
(1.1)
αi > 0, αi ∈ Z, i = 1, m.
Число различных решений этой системы и будет равно числу мультиподмножеств мощности n множества мощности
m. Число решений в данном случае будет также являться биномиальным коэффициентом. Действительно, применяя
принцип взаимно однозначного соответствия, можнокаждому решению (α1 , . 
. . , αm ) взаимно однозначно поставить в
соответствие набор длины n+m−1 из нулей и единиц 1| .{z
. . 1} 0 1| .{z
. . 1} 0 . . . 0 1| .{z
. . 1}. Таким образом, число решений равно

α1
α2
αm


числу наборов указанной длины с m − 1 нулем, то есть биномиальному коэффициенту n+m−1
= n+m−1
. Это число наm−1
n
зывается числом сочетаний с повторениями. Ему можно придать несколько другой содержательный смысл: число
различных последовательностей шаров, извлекаемых из урны с возвращением.
Число мультиподмножеств, содержащих каждый элемент исходного множества по крайней мере один раз, совпадает с числом решений системы

α1 + α2 + · · · + αm = n,
αi ∈ N, i = 1, m,

которое по принципу взаимно однозначного соответствия совпадает с числом решений системы
 0
α1 + α20 + · · · + αm0 = n − m,
αi0 > 0, αi ∈ Z, i = 1, m,
n−1 
то есть равно n−m
. Используя полученные результаты можно, например, найти число целочисленных точек в тетраэдре x, y, z > 0, x + y + z 6 k.
z
k6
\
 \

\ k 
0  y

k
x
 (k+1)(k+1)
Их число равно k+2
=
.
k
2
Введем еще одно комбинаторное число: [m]n = m (m + 1) · · · (m + n − 1) = [m + n − 1]n — возрастающий факториал. Это число имеет следующий содержательный смысл: имеется m-ярусный стеллаж, на который надо расставить
n книг, причем порядок книг на полке имеет значение. Действительно, для первой книги имеется ровно m различных
возможностей поставить ее на одну из полок. Для второй книги возможностей уже на одну больше, так как на одной из
полок есть уже две неравнозначные позиции. И так далее. В результате получится возрастающий факториал.

Перестановки. Рассмотрим теперь подробней взаимно однозначные отображения множества
X = {1, 2, . . . , n}

6

ГЛАВА 1. КОМБИНАТОРИКА

на себя, то есть перестановки. Всего их n!. Множество перестановок n-элементного множества называется симметрической группой степени n и обозначается Sn . Чтобы мотивировать такое определение, введем произведение (композицию) двух перестановок π1 , π2 ∈ Sn ⇒ π1 · π2 = π по следующему правилу: π1 · π2 (x) = π2 (π1 (x)).




π1
x







π2
?
?



Иногда в литературе композицию определяют наоборот: π1 · π2 (x) = π1 (π2 (x)), однако, мы будем придерживаться введенных выше обозначений. Таким образом, Sn — группа с введенным выше внутренним
законом компози
n . Для каждой перестановки
ции. Единичным элементом в этой группе служит единичная перестановка e = 11 22 ...
... n


... n
−1 = a1 a2 ... an ∈ S , при это подразумевается, что столбцы
π = a11 a22 ...
n
an ∈ Sn существует обратная перестановка π
1 2 ... n
последней переупорядочены так, что элементы первой строчки расположены по возрастанию. Действительно, в этом
случае π · π −1 = π −1 · π = e. Можно показать, что операция композиции ассоциативна, но некоммутативна. Также справедливо утверждение о том, что любая конечная группа изоморфна симметрической группе подходящего порядка n.
Перестановками можно описывать всевозможные повороты и симметрии. Так, например, группа симметрий графа
(группа перестановок вершин, приводящих к графу, изоморфному исходному)
2`
`4
#
c
#
# c #
`
c#
`
1 #
c
#c
#
6 c
c
c#
c`
`
3
5



содержит всего четыре элемента: e, π1 = 11 23 32 44 55 66 , π2 = 11 22 33 45 54 66 , π3 = 11 23 32 45 54 66 .
Граф, задающий перестановку имеет достаточно простой вид. Поясним это на примере: пусть дана перестановка


1 2 3 4 5 6 7 8 9 10
.
4 9 2 6 10 7 1 8 3 5
Тогда ей можно поставить в соответствие набор непересекающихся контуров
1`
6

`
7

2`
-9`
AK

A 
A`
?
`
3
6

-4`

5`

8̀
n

`
10

В этом случае говорят, что перестановка распадается на соответствующие циклы. В общем случае, начиная последовательно применять перестановку к элементу i, затем к π (i), и так далее, в силу конечности исходного множества
рано или поздно наступит повтор, а в силу взаимной однозначности перестановки этот повтор наступит тогда, когда
значение перестановки станет равным i. Таким образом, для любой перестановки допустимо представление в виде произведения своих простых циклов. Перестановка из примера представляется в виде произведения следующим образом:
[1, 4, 6, 7] [2, 9, 3] [5, 10] [8]. При этом порядок элементов внутри цикла важен, а порядок циклов в произведении не играет
никакой роли. По договоренности в дальнейшем будем писать циклы в порядке возрастания их наименьших элементов.
Также часто не будем выделять циклы единичной длины, то есть неподвижные элементы. Тогда, если π1 = [C1 ], где C1 —
упорядоченный набор элементов, образующих цикл, а π2 = [C2 ], при условии C1 ∩C2 = ∅ ⇒ π = π1 ·π2 = π2 ·π1 = [C1 ] [C2 ].
Заметим, что в данном случае перестановки, представляющие простые циклы, коммутируют в силу того, что на любой
элемент в таком произведении будет действовать только одна перестановка.
Определение 1.1.2. Типом перестановки π множества X = {1, 2, . . . , n} называется вектор длины n с целыми неотрицательными компонентами λ (π) = (λ1 , λ2 , . . . , λn ), где λ1 — число петель (неподвижных элементов), λi для i = 2, n —
число циклов длины i.
Тип рассмотренной в примере перестановки будет (1, 1, 1, 1, 0, 0, 0, 0, 0, 0).
Компоненты вектора типа перестановки удовлетворяют простому соотношению:
n

∑ iλi = n.

i=1

Зададимся вопросом, сколько перестановок из Sn имеют заданный тип. Ответом на него служит следующее число:
n!
.
λ1
λn
λ1 !···λn !1 ···n

[. . .] [. . .] [. . .] [. . .] . . . [. . .] [. . .]
| {z } | {z } | {z }
λn

λn−1

λ1

7

1.1. ПРОСТЕЙШИЕ КОМБИНАТОРНЫЕ ЧИСЛА

Расставляем все n элементов по местам (n! способов). Затем отождествляем порядок циклов внутри группы циклов
одной длины, то есть делим на λ1 ! · · · λn !. Также отождествляем порядки элементов внутри цикла, если они определяют
один и тот же цикл: для конкретного цикла длины k число различных способов его определить в одной группе равно k
(k циклических сдвигов), то есть делим на 1λ1 · · · nλn . Получаем
утверждаемое
число.


i ... j ...
образуют
инверсию, если i < j & ai > a j . Число
Будем говорить, что элементы ai и a j в перестановке ...
... ai ... a j ...
 n(n−1)

... n
инверсий перестановки π будем обозначать через I (π). Так, например, I (e) = 0, I n1 ...
= 2 = n2 . Для пере1
становки определяется знак:
(
1,
если перестановка четная,
I(π)
sgn (π) = (−1)
=
−1, если перестановка нечетная.
Для знака перестановки выполняется очевидное свойство sgn (π1 · π2 ) = sgn (π1 ) · sgn (π2 ). Транспозиция двух элементов i и j обозначается просто [i, j], частным случаем транспозиции выступает транспозиция двух соседних элементов
[i, i + 1]. Справедливо утверждение, что любую перестановку можно представить в виде произведения транспозиций
двух соседних элементов, число которых равно числу инверсий перестановки. Действительно,


... i i+1 ... [i, i + 1] = ... i i+1 ...
... a b ...
... b a ...

i ...
Берем произвольную перестановку и смотрим, что переводится ею в единицу: π = ...
... 1 ... . Тогда π · [i − 1, i] ·
[i − 2, i − 1] · · · [1, 2] = π1 единицу переводит в единицу, причем в силу того, что единица образовывала транспозиции
со всеми элементами левее, число транспозиций уменьшилось ровно на i − 1. Поступаем также со всеми остальными
элементами и получаем, что π · t1 · t2 · · ·tI(π) = e. Далее, так как обратным элементом к транспозиции двух элементов
является она сама, π = tI(π) · · ·t2 · t1 . Умножение на каждую транспозицию изменяет знак, следовательно, для любых
0
двух перестановок π1 = tI(π1 ) · · ·t1 и π2 = tI(π
· · ·t10 верно, что sgn (π1 · π2 ) = sgn (π1 ) (−1)I(π2 ) = sgn (π1 ) sgn (π2 ).
2)
Все четные перестановки образуют подгруппу симметрической группы. Знак любой транспозиции вида


... i ... j ...
... j ... i ...

|{z}
k

равен (−1)2k+1 = −1. Определим знак произвольного простого цикла как произведение знаков простых транспозиций,
композицией которых является данный цикл:
[a1 a2 . . . ak ] = [a1 a2 ] [a2 a3 ] · · · [ak−1 ak ] ⇒ sgn ([a1 . . . ak ]) = (−1)k−1 .
Таким образом, чтобы определить знак перестановки, нужно знать число циклов четной длины:
b 2n c

∑ λ2i

λ (π) = (λ1 , λ2 , . . . , λn ) ⇒ sgn (π) = (−1) i=1

.

Принцип включения и исключения. Из теории множеств известны простейшие мощностные равенства: |A ∪ B| =
|A|+|B|−|A ∩ B| , |A ∪ B ∪C| = |A|+|B|+|C|−|A ∩ B|−|B ∩C|−|C ∩ A|+|A ∩ B ∩C| и так далее. Следующее предложение
докажем по индукции. Пусть есть исходное множество N , |N | = N и набор свойств P1 , . . . , Pn , кодируемые набором
{1, 2, . . . , n} = [n]. Для каждого элемента формулируем n высказываний относительно обладания им каждого из этих
свойств. Пусть I = {i1 , i2 , . . . , is } ⊆ [n] — подмножество кодов свойств. Обозначим
N [I] = ] {a ∈ N | a обладает в точности свойствами Pi1 , . . . , Pis и больше не обладает никакими}
Так, например, N [∅] равно числу элементов N , не обладающих ни одним из указанных свойств. Далее, обозначим
N (I) =

∑

N [J]

I⊆J⊆[n]

— число элементов, обладающих заданными свойствами Pi1 , . . . , Pis с кодами из I и, быть может, еще какими-то. В
терминах n-мерного булева куба, все вершины которого помечены неотрицательными целыми числами, показывающими сколько элементов из N обладают соответствующими свойствами, эти числа имеют следующий содержательный
смысл: N [I] — это число, приписанное вершине, у которой все разряды с номерами из I равны единице, а оставшиеся
равны нулю; N (I) — это сумма чисел, приписанных всем вершинам грани между вершиной N [I] и единичной. Пусть
теперь
N[r] = ∑ N [J]
J⊆[n]
|J|=r

8

ГЛАВА 1. КОМБИНАТОРИКА

— число элементов, обладающих ровно r (неважно какими) свойствами. В n-мерном булевом кубе это сумма чисел,
приписанных вершинам r-го слоя;
N(r) = ∑ N (J)
J⊆(n)
|J|=r

— число элементов, обладающих не менее r (неважно какими) свойствами. В n-мерном булевом кубе это сумма чисел,
приписанных вершинам всех слоев, начиная с r-го.
Теперь можно сформулировать принцип включения и исключения:
Теорема 1.1 (Принцип включения и исключения).
N[0] = N(0) − N(1) + · · · + (−1)i N(i) + · · · + (−1)n N(n) ,
 




 
m
m+1
i m+i
n−m n
N[m] =
N −
N(m+1) + · · · + (−1)
N(m+i) + · · · + (−1)
N .
m (m)
m
m
m (n)

(1.2)
(1.3)

 Док-во. При n = 1 N[0] = N(0) −N(1) = N −N(1) и формула (1.2), очевидно, справедлива. Пусть формула справедлива
для n − 1 свойств. Имеем
N[0] = N(0) − N(1) + N(2) − N(3) + · · · + (−1)n−1 N(n−1) .
(1.4)
Эта формула справедлива и для совокупности объектов, обладающих свойством n:
n
n
N [n] = N(n) − N(1)
+ · · · + (−1)n−1 N(n−1)
,

(1.5)

где N(nj) — число объектов, обладающих свойством n и еще какими-то другими свойствами, число которых не меньше
j. Вычитая формулу (1.5) из (1.4), получаем формулу (1.2).
Докажем теперь формулу (1.3). Перепишем ее следующим образом:

 n
n−m
m+k
N[m] = ∑ (−1)k
∑ N[i] .
m
k=0
i=m+k
Докажем, что каждый предмет, обладающий в точности m свойствами, будет учтен в ней ровно один раз. В самом
деле, элементы, обладающие s < m свойствами, не учитываются очевидным
образом. Элемент, обладающий заданными
m+t 
s = m + t свойствами, будет учитываться во внутренней сумме m+k
раз. Но
n−m

∑ (−1)

k=0

k



m+k
k

 

  (
1 при t = 0,
m+t
m+t t
k t
=
∑ (−1) k = 0 при t > 0.
m+k
m
k=0



Таким образом, в (1.3) ровно по одному разу учитываются элементы, обладающие в точности m свойствами, а остальные
не учитываются.

Принцип включения и исключения имеет весовой аналог. Пусть задана некоторая весовая функция ω : N → K,
где K — кольцо, ставящая каждому элементу a ∈ N в соответствие его вес ω (a). Тогда если во всех обозначениях
поменять N на значение веса W , то суммарный вес элементов, обладающих ровно m свойствами будет равен
Теорема 1.2 (Весовой вариант принципа включения и исключения).
 




 
m
m+1
i m+i
n−m n
W[m] =
W −
W(m+1) + · · · + (−1)
W(m+i) + · · · + (−1)
W .
m (m)
m
m
m (n)

(1.6)

 Док-во. Доказательство формулы (1.6) полностью аналогично доказательству формул (1.2) и (1.3) с тем лишь различием, что считать необходимо не число элементов, а их суммарный вес.

Перестановки с ограничениями. Будем рассматривать взаимно однозначные отображения множества X =
{1, 2, . . . , n} в себя с ограничениями, то есть для каждого элемента будем запрещать его отображение в какие-то другие. В нижеприведенной таблице под чертой указаны запреты для каждого элемента.
1
a11
a12
...
a1i1
Некоторые запреты вполне могут быть пустыми.

2
a21
a22
...
a2i2

... j
. . . a1j
. . . a2j
.......
. . . aijj

...
...
...
...
...

n
an1
an2
...
anin

9

1.1. ПРОСТЕЙШИЕ КОМБИНАТОРНЫЕ ЧИСЛА

Примером задачи на перестановки с ограничениями может служить задача о беспорядках. В ней требуется найти
число перестановок со следующими ограничениями:
1 2 ... n
1 2 ... n
Такие перестановки называются беспорядками. Число беспорядков n-элементного множества обозначим Dn .
Задачи на перестановки с ограничениями часто сводятся к подсчету перманента 0, 1-матрицы. Вспомним, что
определителем квадратной матрицы An размера n × n называется следующее число:
det (An ) =

∑

sgn (π) · a1,π(1) · a2,π(2) · · · an,π(n) .

π∈Sn

Обобщениями определителя служат числа, получаемые заменой в правой части знака перестановки sgn (π) некоторой
другой функцией перестановки f (π), называемой в этом случае функцией Шура. Из всех таких функций рассмотрим
одну: f (π) ≡ 1. Выражение
per (An ) = ∑ a1,π(1) · a2,π(2) · · · an,π(n) ,
π∈Sn

получаемое в этом случае, называется перманентом матрицы. Он обладает некоторыми свойствами, схожими со
свойствами определителя. Так, например, если матрицу транспонировать, то ее перманент не изменится. Также, при
вычислении перманента можно использовать разложение по строке или столбцу. Но есть и различия: если переставить
две строки (два столбца), перманент не изменится в отличии от определителя, который поменяет знак. Также, добавление к одной из строк (одному из столбцов) линейной комбинации других строк (столбцов), вообще говоря, меняет перманент. Определение перманента можно обобщить на случай прямоугольной матрицы: если, например, число столбов
m больше числа строк n, то перманент будет равен сумме всевозможных различных произведений элементов, взятых
из разных строк и разных столбцов. В добавление к вышесказанному заметим, что вычисление перманента является
NP-полной задачей (в настоящий момент известны только экспоненциальные алгоритмы вычисления
 перманента), в
то время как задача вычисления определителя полиномиальна (известный метод Гаусса требует O n2 умножений).
Для таблицы запретов строим 0 − 1-матрицу размера n × n, в которой столбцам припишем элементы исходного множества, а строкам — запреты на отображения. Единицу в позиции (i, j) ставим тогда и только тогда, когда элемент i
может отображаться перестановкой в элемент j, в противном случае (если отображение i в j запрещено), ставим нуль.
Между перестановками и слагаемыми в перманенте устанавливается взаимно однозначное соответствие. Если перестановка нарушает хотя бы один запрет, то соответствующее ей слагаемое будет равно нулю, в противном случае оно
будет равно единице. Таким образом, число перестановок с запретами будет просто равно перманенту соответствующей
матрицы.
Для задачи о беспорядках перманент выглядит следующим образом:


0 1 1 ... 1
1 0 1 . . . 1


1 1 0 . . . 1




. . . . . . . . . . 
1

1

per


0
1

1

...

0

При n = 2

1
= 1;
0

При n = 3

0
per 1
1


1 1
0 1 = 2.
1 0

Вызывает интерес поведение величины числа беспорядков n-элементного множества Dn при n → ∞. Возможны четыре
варианта:
Dn
→ 0;
n!

Dn
→ a,
n!

1
0<a< ;
2

Dn
→ a,
n!

1
6 a < 1;
2

Dn
→ 1.
n!

Воспользуемся принципом включения и исключения. Обозначим для i = 1, n свойством Pi перестановки тот факт, что
i → i. Задача свелась к подсчету общего числа перестановок, не обладающих ни одним из этих свойств:
N[0] = N(0) − N(1) + · · · + (−1)i N(i) + · · · + (−1)n−m N(n) =
 
 
 
 
n
n
m n
n n
n! −
(n − 1)! +
(n − 2)! + · · · + (−1)
(n − m)! + · · · + (−1)
(n − n)! =
1
2
m
n


n! n!
(−1)m n!
(−1)n n!
1
1
(−1)m
(−1)n
n! − + + · · · +
+···+
= n! 1 − + + · · · +
+···+
.
1! 2!
m!
n!
1! 2!
m!
n!

10

ГЛАВА 1. КОМБИНАТОРИКА

Устремляя n к бесконечности получаем асимптотику числа беспорядков:
∞
Dn
1
1
−−−→ S = ∑ (−1)m ·
= e−1 = .
n! n→∞
m!
e
m=0

Таким образом, правильным оказался второй вариант. Задачу о числе беспорядков называют также задачей Монмора.
Другой известной задачей на перестановки с ограничениями является задача Люка, или задача о супружеских
парах. Она заключается в нахождении числа рассадок за круглый 2n-местный стол n супружеских пар так, чтобы никакая супружеская пара не оказалась на соседних стульях. Иногда эту задачу называют также задачей мажордома.
Пусть все стулья пронумерованы символами 1, 10 , 2, 20 , . . . , n, n0 . Будем без ограничения общности рассуждений считать, что на стульях со штрихами могут сидеть персоны лишь одного пола. Для начала заметим, что перед тем, как
будут рассажены все пары, можно рассмотреть всевозможные рассадки дам и относительно уже их искать допустимые рассадки мужчин. Таким образом, число разрешенных рассадок супружеских пар равно 2 · n! ·Un , где Un — число
способов рассадить n мужчин так, чтобы супруги не сидели рядом. Таблица запретов будет в данном случае выглядеть
следующим образом:
1 2 ...
i
... n−1 n
1 2 ...
i
... n−1 n
2 3 ... i+1 ...
n
1
(1.7)
p1 p2 . . .
pi
. . . pn−1 pn
p01 p02 . . .
p0i
. . . p0n−1 p0n
Задача сводится к вычислению перманента матрицы

0 0
1 0

1 1

1 1

. . . .

1 1
0 1

1
0
0
1
...
1
1

1
1
0
0
..
1
1

...
...
...
...
....
...
...

1
1
1
1
..
0
1


1
1

1

1

. .

0
0

Если обозначить через J матрицу, все элементы которой суть единицы, I — единичную (на диагонали которой стоят
единицы, а вне диагонали нули), C — циркулярную матрицу, у которой над диагональю, а также на месте элемента первого столбца последней строки стоят единицы, а остальные элементы равны нулю, то задача Люка сводится к
вычислению per (J − I −C), а задача Монмора к per (J − I).
Введем 2n вообще говоря противоречивых свойств, причем противоречивыми являются любые наборы, содержащие хотя бы одну из пар









p1 , p01 , p01 , p2 , p2 , p02 , p02 , p3 , . . . , pi , p0i , p0i , pi+1 , . . . , p0n−1 , pn , pn , p0n , p0n , p1 .
Это легко представить на рисунке, расположив эти свойства в круг:
p1
p0n

p01



H


pn
AA

p2
AA

p02


···

···
H

p0i

pi



(1.8)

Из этих 2n объектов, расположенных в круге, выбирается k, не расположенных рядом. Решим сначала вспомогательную задачу: найдем число способов выбрать из n расположенных в ряд объектов k, не расположенных рядом.
Лемма 1.1.1 (Капланский).



n−k+1
n
e ∈ B | ∀ i = 1, n − 1 =⇒ αi αi+1 = 0 =
f (n, k) = ] α
.
k
 Док-во. Очевидно, что f (1, 0) = f (1, 1) = 1, k > 2 ⇒ f (1, k) = 0. Докажем по индукции следующее предложение:
f (n, k) = f (n − 1, k) + f (n − 2, k − 1)

(1.9)

11

1.1. ПРОСТЕЙШИЕ КОМБИНАТОРНЫЕ ЧИСЛА

Действительно, способы выбрать k несоседствующих объектов распадаются на два непересекающихся варианта: последний элемент не выбран, но тогда число способов выбрать k объектов среди n − 1 первых равно как раз f (n − 1, k);
последний элемент выбран, в этом случае выбирать k − 1 объектов можно только среди первых n − 2, то есть число способов f (n − 2, k − 1). Предложение доказано. Для полного определения f (n, k) осталось определить вторую строчку и
первые два столбца:
f (2, 0) = 1, f (2, 1) = 2, k > 3 ⇒ f (2, k) = 0, f (n, 0) = 1, f (n, 1) = n.
Наглядно это можно представить на таблице:
b k
n b
0
1
2
3
4
5
6

0
1
1
1
1
1
1
1

1
0
1
2
3
4
5
6

2 3
0 0
0 0
0 0
. 0
. . .
....
....

4 5
...
0 0
...
0 0
...
0 0
...
............
0 .........
.............
.............
n−2,
k−1

..
.

..
.

..
.

(1.10)

n−1,
k
n,
k

Теперь легко понять, что решением такого рекуррентного уравнения будет являться как раз требуемый биномиальный
коэффициент n−k+1
.

k
Лемма 1.1.2 (Капланский).

e ∈ Bn | ∀ i = 1, n − 1 =⇒ αi αi+1 = 0, α1 αn = 0 =
g (n, k) = ] α



n
n−k
.
n−k
k

 Док-во. При выборе k объектов из цикла (1.8) возможны два случая: последний объект не выбран — в этом случае
число вариантов просто равно f (n − 1, k); последний объект выбран — тогда число вариантов f (n − 3, k − 1), так как
помимо последнего нельзя выбирать также теперь предпоследний и первый. Таким образом,
g (n, k) = f (n − 1, k) + f (n − 3, k − 1) =





 
 

n
n−k
n−k
n−k−1
n−k
k
=
, (1.11)
+
=
1+
n−k
n−k
k
k
k−1
k

что и требовалось доказать



Теперь мы готовы дать ответ на вопрос задачи Люка: Mn = 2n!Un , где Un — число перестановок с ограничениями,
входящими в противоречие
друг с другом в соответствии с (1.8). Число выбрать из 2n свойств k непротиворечивых

2n 2n−k
.
Тогда
легко видеть, что согласно принципу включения и исключения
равно vk = 2n−k
k
Un = v0 · n! − v1 · (n − 1)! + v2 · (n − 2)! − · · · + (−1)k vk · (n − k)! + · · · + (−1)n vn · (n − n)! =
n



2n
2n − k
∑ (−1) 2n − k k (n − k)!.
k=0
k

Примеры.
1. Имеется колода из 4n (n > 5) карт, которая содержит карты четырех мастей по n карт каждой масти, занумерованных числами 1, 2, . . . , n. Подсчитать, сколькими способами можно выбрать пять карт так, что среди них окажутся:
(a) Пять последовательных карт одной масти.
 Решение. Если представить колоду в виде таблицы 4 × n, строки которой будут содержать карты одной
масти, упорядоченные по возрастанию, то легко увидеть, что число искомых способов равно 4 (n − 4).

n
Действительно, одним из 4 способов можно выбрать одну строку, а затем одним из n − 4 способов — последовательность из 5 подряд идущих карт.


12

ГЛАВА 1. КОМБИНАТОРИКА
(b) Пять последовательных карт, из которых по крайней мере две разных мастей.
 Решение. Снова обращаясь к таблице, можно понять, что всего подряд идущих пятерок 45 (n − 4), из
которых согласно (1a) 4 (n − 4) состоят из карт одной масти. Следовательно, неоднородных пятерок всего
45 (n − 4) − 4 (n − 4) = 1020 (n − 4).

(c) Четыре карты из пяти с одинаковыми номерами.
 Решение. Снова из таблицы видно, что такому выбору соответствует выбор целого столбца таблицы
(n способов) и выбор еще одной карты среди оставшихся n − 1 столбцов, то есть всего возможностей
n (4n − 4) = 4n (n − 1).

(d) Три карты с одним номером и две карты с другими.
 Решение. Такой выбор равносилен
выделению в таблице одного столбца (n способов), в котором затем

выбираются 3 элемента ( 43 способов), после чего выбираются два других столбца ( n−1
2 ), в каждом из
4
которых выбирается по 1 элементу ( 1 способов независимо для каждого столбца). Таким образом, всего

 42
n · 43 · n−1

2 · 1 = 32n (n − 1) (n − 2) способов.
2. Найти число способов раскладки n различных шаров по m различным урнам.
 Решение. Это число, очевидно, равно найденному в параграфе 1.1 числу различных отображений nэлементного множества в m-элементное, то есть mn .

3. Сколькими способами можно разместить n одинаковых шаров по m различным урнам?
 Решение. Это число является числом решений системы (1.1), то есть числу сочетаний с повторениями

n+m−1
.
n


4. Сколькими способами можно разложить n = n1 + n2 + · · · + nk различных шаров по k различным урнам так, чтобы
в первую урну попало n1 шаров, во вторую — n2 и так далее, в k-ю — nk ?

 Решение. Это число вычисляется непосредственно: сначала из n шаров выбираем n1 шаров ( nn1 способами)

1 способами) и помеи помещаем их в первую урну. Затем из оставшихся n − n1 шаров выбираем n2 шаров ( n−n
n2
щаем их во вторую
урну и так далее, из оставшихся невыбранными n − n1 − · · · − nk−1 шаров
nk шаров

 n−n выбираем

1 · · · n−n1 −···−nk−1 =
k−1 = 1 способами) и помещаем их в k-ю урну. Всего способов получается n
( n−n1 −···−n
nk
n1
n2 
nk
n
n!
n1 !n2 !···nk ! . Это число называется полиномиальным коэффициентом и обозначается n1 n2 ···nk . По аналогии с биn

номиальными коэффициентами, являющимися коэффициентами разложения бинома Ньютона (1 + x)n = ∑ nk xk
n

n

или, что то же самое, (a + b) = ∑
k=0
жения аналогичного полинома:

k=0
n k n−k
, полиномиальные коэффициенты являются коэффициентами разлоk a b

(a1 + a2 + · · · + ak )n =

∑

n1 +n2 +···+nk =n
ni >0, i=1,k

n

an11 an22 · · · ak k .


5. n (n > 2) человек садятся за круглый стол. Два размещения по местам будем считать совпадающими, если каждый
человек имеет одних и тех же соседей в обоих случаях. Сколько существует способов сесть за стол?
 Решение. Каждой рассадке взаимно однозначно соответствует перестановка n целых чисел 0, 1, . . . , n − 1. Все
n! перестановок разбиваются на классы эквивалентности по следующему принципу: две перестановки π1 и π2
эквивалентны в том и только в том случае, когда либо π1 (x) = π2 (x + i) для некоторого i ∈ {0, . . . , n − 1} (сложение
производится по модулю n) и для всех x = 1, n, либо π1 (x) = π2 (i − x) для некоторого i ∈ {0, . . . , n − 1} (вычитание
производится по модулю n) и для всех x = 1, n. В каждом классе эквивалентности 2n перестановок, n сдвигов и n
n!
отраженных сдвигов. Таким образом, всего классов эквивалентности 2n
= (n−1)!
= [n − 1]n−2 .

2
6. Сколькими способами можно посадить за круглый стол n мужчин и n женщин так, чтобы никакие два лица одного
пола не сидели рядом?

13

1.1. ПРОСТЕЙШИЕ КОМБИНАТОРНЫЕ ЧИСЛА

 Решение. Будем обозначать множество женщин числами 1, . . . , n, а множество мужчин — числами n+1, . . . , 2n.
Каждая рассадка являются перестановкой объединения этих множеств. Перестановка, соответствующая рассадке, удовлетворяющей условию, должна числа 1, . . . , n сопоставлять либо только четным числам, либо нечетным (2 возможности), при этом автоматически числа n + 1, . . . , 2n сопоставятся только нечетным, либо только
четным числам. Переставить первые n чисел указанным образом можно n! способами, при этом для каждой их
перестановки вторые n чисел можно переставить также n! способами. Таким образом, всего искомых перестановок 2 (n!)2 .

7. Сколькими способами можно составить три пары из n шахматистов?


n−4
 Решение. Первую пару можно выбрать n2 способами, вторую n−2
2 , третью
2 . При этом порядок пар не
имеет значения. Одну и ту же тройку пар можно упорядочить 3! способами, то есть всего способов составить три
 [n]
(n)(n−2)(n−4)
пары 2 23! 2 = 15 n6 = 486 .

8. Сколько делителей имеет число q = pα1 1 pα2 2 · · · pαn n , где pi — различные простые числа, αi — некоторые натуральные числа? Чему равна сумма делителей?
 Решение. Очевидно, что число r является делителем числа q в том и только в том случае, когда q =
n

p1 1 p2 2 · · · pn n , βi 6 αi . Следовательно, что всего делителей ∏ (αi + 1). Далее, суммой всех делителей является
β

β

β

i=1

∑

β

p1 1 · · · pβn n .

(1.12)

βi 6αi
i=1,n

Очевидно, что эта сумма равна
n pαi +1 − 1

1 + p1 + · · · + pα1 1 · · · (1 + pn + · · · + pαn n ) = ∏ i
,
i=1 pi − 1

(1.13)

так как всякое слагаемое из (1.12) можно найти в (1.13) и наоборот.



9. Сколько можно составить перестановок из n элементов, в которых данные m элементов не стоят рядом в любом
порядке?
 Решение. Всего перестановок n!. Фиксированные m элементов можно поставить рядом m! способами. Оставшиеся элементы можно упорядочить (n − m)! различными способами. Разместить группу выделенных m элементов среди n элементов можно n − m + 1 способом. Таким образом, число искомых перестановок равно
n! − m! (n − m + 1)!.

10. Сколько существует чисел от 0 до 10n , в которые не входят две идущие друг за другом одинаковые цифры?
 Решение. Рассмотрим k-разрядные числа, в которых никакие две подряд идущие цифры не повторяются. Найдем их количество. Первый разряд может быть произвольным из множества {1, 2, 3, 4, 5, 6, 7, 8, 9}. Второй разряд
может быть произвольным из этого же множества или нулем, но не равен первому и так далее. Таким образом,
каждый разряд при построенном предыдущем принадлежит девятиэлементному множеству, то есть всего чисел
длины k, удовлетворяющих условию задачи 9n . Будем также считать число 0 состоящим их 0 разрядов. Поскольку искомые числа имеют в десятичной записи от 1 до n цифр (10n имеет n + 1 цифру, но не подходит при n > 2),
всего чисел
n
9n+1 − 1
∑ 9k = 8
k=0

11. Сколько существует n-значных натуральных чисел, у которых цифры расположены в неубывающем порядке?
 Решение. Каждому n-значному числу в десятичной системе счисления, у которого цифры расположены в
неубывающем порядке, можно взаимно однозначно поставить в соответствие последовательность из нулей и единиц длины n + 9 следующим образом: числу 1| ·{z
· · 1} · · · 9| ·{z
· · 9} соответствует 1| ·{z
· · 1} 0 1| ·{z
· · 1} 0 · · · 0 1| ·{z
· · 1}, то есть сначала
k1

k9

k1

k2

k9

идет столько единиц, сколькими единицами начинается число, затем идет нуль, затем столько единиц, сколько
двоек, и так далее. Очевидно, что длина такой последовательности будет n+8, так как каждой из n цифр исходного

14

ГЛАВА 1. КОМБИНАТОРИКА
числа соответствует одна единица, а разделителями выступают нули. Обратно, по каждой такой последовательности можно однозначно восстановить число: сначала пишем столько единиц, сколько единиц стоит перед первым
нулем в последовательности, затем пропускаем нуль и пишем столько двоек, сколько стоит в последовательности
между первым и вторым нулями и так далее. Итак, искомых чисел
столько же, сколько последовательностей из

нулей и единиц длины n + 8, содержащих 8 нулей, то есть n+8
.

n

12. Доказать свойство биномиальных коэффициентов
  
 

n
n−1
n−1
=
+
.
k
k
k−1

(1.14)

 Решение. Пусть n > 2, k > 1. Тогда множество наборов длины n с k единицами распадается на два непересекающихся множества: заканчивающихся нулем
и заканчивающихся единицей. Число
наборов длины n c k едини
n−1
цами, заканчивающихся нулем, равно n−1
,
а
заканчивающихся
единицей
.
Так
как
мощность объединения
k
k−1
двух непересекающихся множеств равна сумме их мощностей, свойство доказано.
Все вышесказанное дает возможность рекуррентно определить биномиальные коэффициенты. Будем считать,
что существует одна последовательность длины нуль, содержащая нуль единиц, и не существует ни одной последовательности той же длины, содержащей больше единиц. Также, вполне естественно полагать, что существует
одна последовательность длины единица, содержащая нуль единиц, одна последовательность той же длины, содержащая одну единицу, и иных последовательностей той же длины не существует. Таким образом, биномиальные
коэффициенты могут быть определены следующей системой:
  
0


= 1,



0

 n
= 0,
если n < 0 или k < 0,


k  
 



n
n−1
n−1


=
+
, иначе

k
k
k−1
или

  
n


= 1,
n > 0,



0

 0
= 0,
k > 1,



 
k  


n−1
n−1
n


, n, k > 1.
+
=

k−1
k
k

Наглядно это можно представить на таблице:
b k
n b
0
1
2
3
4
5
6

0
1
1
1
1
1
1
1

1
0
1
2
3
4
5
6

..
.

..
.

..
.

2
0
0
1
..
..
..
..

3
0
0
0
..
..
..
..

4
0
0
0
...
...
...
...

5
0
0
0
..
..
..
..

.
.
.
.

.
.
.
.

.
.
.
.

...
...
...
...
...
...
...
...

.
.
.
.

.
.
.
.

n−1, n−1,
k−1
k
n,
k

Иногда бывает удобно представить в виде треугольника:
1
 ZZ
1
1
 Z
 Z

Z 
Z
1
2
1
 Z
 Z

Z  ZZ 
Z
1
3
3
1
 ZZ 
 Z
 Z

Z 
Z  ZZ
1
4
6
4
1


15

1.1. ПРОСТЕЙШИЕ КОМБИНАТОРНЫЕ ЧИСЛА
n

13. Доказать равенство ∑

k=1

(−1)k−1 n
k
k

n

 Решение. Обозначим ∗ = ∑

k=1

Z1 n

∑ (−1)k−1

0 k=1

= 1 + 12 + · · · + 1n .

(−1)k−1 n
k
k .

n

Рассмотрим функцию t ∑ (−1)k−1
k=1

n k−1
k t

и интеграл от нее:

 
Z1
Z1
Z1

n k−1
1 − (1 − t)n
1 − tn
t dt =
dt =
dt =
1 + t + · · · + t n−1 dt
k
t
1−t
0

0

0

=


1
t2
tn
1
1
t + +···+
= 1+ +···+ .
2
n 0
2
n

С другой стороны
Z1 n

∑ (−1)

k−1

0 k=1

 
n k−1
t dt =
k

n

∑ (−1)

k−1

k=1

  k
n t
k k

1

= ∗.
0

Таким образом, равенство доказано.



14. Доказать тождества:
n
n 
(a) ∑ 2k
= ∑ 2k+1
= 2n−1 .
k

k

 Решение. Это равенство отражает очевидный факт, что число наборов равной длины из нулей и единиц с
четным числом единиц равно числу наборов из нулей и единиц с нечетным числом единиц и равно половине
полного числа наборов.

(b) 4 ∑
k

n
4k

= 2n + 2n/2+1 cos πn
4 .

 Решение. Число в левой части равно учетверенному числу вершин n-мерного единичного куба, число
единиц в которых кратно четырем. Рассмотрим вспомогательную сумму
S=

1
(1 + 1)n + (1 − 1)n + (1 + i)n + (1 − i)n .
4

Заметим, что
4S = 2n + 2

√ n
n
πn
πn
2 cos
= 2n + 2 2 +1 cos .
4
4

Составим таблицу сумм степеней
0
1
2
3

1 −1
i −i сумма
1
1
1
1
4
1 −1
i −i
0
1
1 −1 −1
0
1 −1 −i
i
0

Получаем
n

4S =

 
n  
n  
n  
n n−k k
n n−k
n n−k k
n
k
1
1
+
1
(−1)
+
1
i
+
∑ k
∑ k
∑ k
∑ k 1n−k (−i)k
k=0
k=0
k=0
k=0
 
b 4n c  

n n−k  k
n
k
k
k
=∑
1
1 + (−1) + i + (−i) = 4 ∑
.
k
4k
k=0
k=0
n


15. При обследовании читательских вкусов студентов оказалось, что 60% студентов читают журнал A, 50% — журнал
B, 50% — журнал C, 30% — журналы A и B, 20% — журналы B и C, 40% — журналы A и C, 10% — журналы A, B
и C. Сколько процентов студентов:
(a) не читает ни одного из журналов?

16

ГЛАВА 1. КОМБИНАТОРИКА
 Решение. Согласно принципу включения и исключения
N[0] = N(0) − N(1) + N(2) − N(3) =
100% − (60% + 50% + 50%) + (30% + 20% + 40%) − 10% = 20%.

(b) читает в точности 2 журнала?
 Решение. Согласно принципу включения и исключения
 
 
2
3
N[2] =
N −
N = 30% + 20% + 40% − 3 · 10% = 60%.
2 (2)
2 (3)

(c) читает не менее 2 журналов?
 Решение. Согласно принципу включения и исключения
 
 
 
2
3
3
N[2] + N[3] =
N(2) −
N(3) +
N = 30% + 20% + 40% − 3 · 10% + 10% = 70%.
2
2
3 (3)


Упражнения.
1. Имеется колода из 4n (n > 5) карт, которая содержит карты четырех мастей по n карт каждой масти, занумерованных числами 1, 2, . . . , n. Подсчитать, сколькими способами можно выбрать пять карт так, что среди них окажутся:
(a) три карты с одним номером и две карты с другим;
(b) пять карт одной масти;
(c) пять последовательно занумерованных карт;
(d) три карты из пяти с одним и тем же номером;
(e) не более двух карт каждой масти.
2. Доказать следующие свойства биномиальных коэффициентов:

n 
(a) nk = n−k
;


 n
(b) nk kr = n−r
k−r r ;
[k]r
n  n
(c) k−r
k = [n−k+r] ;
r

n

(d)

n

(e)

n−r n
k−r
k

(f)
(g)

k


= ∑ n−r−1
k−r ;
r=0

=

[k]r
[n]r ;

n+1 n
n+1
k
k = n−k+1 ;
n
r
n+1
∑ k = k+1 .
r=k

3. Доказать, что

(a) nk возрастает по n при фиксированном k;

(b) n−r
k−r убывает по r при фиксированных n и k;

(c) если n фиксировано, то nk возрастает по k при k 6 bn/2c и убывает при k > dn/2e;

n 
(d) max nk = bn/2c
;
06k6n

(e) минимальное значение суммы
bn/sc , r = n − s bn/sc;

n1 
n2 
ns 
k + k + ··· + k

s

при условии ∑ ni = n равно (s − r)
i=1

q
q+1
r +r k ,

где q =

17

1.1. ПРОСТЕЙШИЕ КОМБИНАТОРНЫЕ ЧИСЛА
(f) максимальное значение суммы
n
∑
j ;

n
n
n
k1 + k2 + · · · + ks

при условии 0 6 k1 < · · · < ks 6 n (1 6 s 6 n + 1) равно

n−s 6 j< n+s
2
2


(g) при простом p и любом p > k > 1 число kp кратно p;
2n
(h)
∏ pi 6 n , где произведение берется по всем простым числам pi (n < pi 6 2n).
n<pi 62n

4. Индукцией по n с использованием соотношения (1.14) доказать тождество
n  
n k
(1 + t)n = ∑
t .
k=0 k

(1.15)

5. Пусть n и m — целые положительные числа. С использованием тождества (1.15) или иным способом доказать
следующие равенства:
n

n
k

(a) ∑

k=0
n

= 2n ;

(b) ∑ (−1)k
k=0
n

(c) ∑ k
k=1
n

n
k

n
k

= 0;

= n2n−1 ;

(d) ∑ k (k − 1)

n
k

= n (n − 1) 2n−2 ;

(e) ∑ (2k + 1)

n
k

= (n + 1) 2n ;

k=2
n

k=0
n

(f) ∑


1 n
k+1 k

=

1
n+1

1
(g) ∑ (−1)k k+1

n
k

k=0
n

k=0
k

m m 
r k−r

(h) ∑

r=0
n

(i) ∑

k=0
n

n2
k

n n−k

k=0 r=0
n

n
r

r=k

n
k+r

(m) ∑

r=0
m

(n) ∑

k=n

 m
r

=

2n2
n ;

=

n n−k
k
r

(l) ∑ (−1)k−r
n−k

1
n+1 ;

2n
n ;

=

2

(k) ∑ ∑

=

n+m
k ;

=

(2n)!
(k!)
((n−k)!)2
k=0

(j) ∑


2n+1 − 1 ;

= 3n ;
n−k

= ∑ (−1)n−k−r
r=0

n
r ;

m+n
n−k ;

 
(−1)k−n nk mk

(
0 при m 6= n,
=
.
1 при m = n.

6. Доказать тождества:
m−1
n
= ∑ e−2πirν/m 1 + e2πiν/m , где i2 = −1;
ν=0
k

π
n
n/2+1
2 +2
cos 4 (n − 2r) , 0 6 r 6 3.

(a) если 0 6 r < m, то m ∑
(b) ∑
k

n 
4k+r

=

1
4

n 
mk+r

7. На одной из кафедр университета работают 13 человек, причем каждый из них знает хотя бы один иностранный
язык. Десять человек знают английский, семеро — немецкий, шестеро — французский. Пятеро знают английский
и немецкий, четверо — английский и французский, трое — немецкий и французский.
(a) Сколько человек знают все 3 языка?
(b) Сколько человек знают ровно 2 языка?

18

ГЛАВА 1. КОМБИНАТОРИКА
(c) Сколько человек знают только английский язык?
8.

(a) Показать, что количество целых положительных чисел, делящихся на n и не превосходящих x равно bx/nc.
(b) Найти число целых положительных чисел, не превосходящих 1000, и не делящихся ни на одно из чисел 3, 5
и 7.
(c) Найти число целых положительных чисел, не превосходящих 1000, и не делящихся ни на одно из чисел 6, 10
и 15.
(d) Показать, что если n = 30m, то количество целых положительных чисел, не превосходящих n и не делящихся
ни на одно из чисел 6, 10, 15, равно 22m.
√
(e) Пусть p1 , . . . , pr — все простые числа, не превосходящие n. Показать, что число простых чисел p таких,
r
√
что n < p 6 n, равно n − 1 + ∑ (−1)k Sk , где сумма
k=1

Sk = ∑
берется по всевозможным
остальные равны 0.

r
k



n
pα1 1 · · · pαr r



наборам показателей α1 , . . . , αr , в которых ровно k из показателей равны 1, а

(f) Найти число простых чисел, не превосходящих 100.

1.2

Производящие функции

Разбиения множества. Пусть X — некоторое конечное множество, |X| = n, на котором задано разбиение X = X1 ∪
X2 ∪ · · · ∪ Xk , то есть ∀ i = 1, k ⇒ Xi 6= ∅ & i 6= j ⇒ Xi ∩ X j = ∅. Заметим, что порядок блоков и элементов в блоке не важен.
Определение 1.2.1. Числом Стирлинга второго рода S (n, k) для n > 1, k > 1 называется число разбиений nэлементного множества на k блоков.
В качестве примера рассмотрим случай n = 3. Заметим предварительно, что разбиения можно упорядочить: разбиение D2 предшествует разбиению D1 (D2 4 D1 ), если D2 можно получить из D1 , разбивая блоки последнего на подблоки.
Иными словами, любой блок из D2 содержится лишь в одном блоке D1 . Это отношение можно рассматривать как
уточнение эквивалентности: из эквивалентности по разбиению D2 следует эквивалентность по разбиению D1 , но не
наоборот. Итак, диаграмма Хассе частично упорядоченного множества разбиений выглядит следующим образом:
{{1, 2, 3}}





H
HH

HH
{{1, 2} , {3}}
{{2, 3} , {1}}
{{3, 1} , {2}}
H

HH

HH


{{1} , {2} , {3}}
Отсюда видно, что S (3, 1) = 1, S (3, 2) = 3, S (3, 3) = 1.
Вообще, очевидны следующие тривиальные равенства:
S (n, n) = 1 (n > 1) , S (n, 1) = 1 (n > 1) , S (n, k) = 0 (k > n > 1) .
Опираясь на эти начальные условия, найдем рекуррентное соотношение для чисел Стирлинга второго рода, доказав
следующую формулу:
S (n, k) = S (n − 1, k − 1) + k · S (n − 1, k) .
(1.16)
 Док-во. Действительно, выделим в n-элементном множестве последний элемент и рассмотрим всевозможные разбиения оставшегося множества. Возможны два случая:
1. последний элемент составляет отдельный блок. Но всего таких разбиений столько, сколько существует разбиений оставшегося (n − 1)-элементного множества на k − 1 блоков.
2. Последний элемент не составляет отдельного блока. Но тогда он принадлежит одному из k блоков разбиения
(n − 1)-элементного оставшегося множества.
Поскольку эти два случая несовместны, получаем (1.16).



19

1.2. ПРОИЗВОДЯЩИЕ ФУНКЦИИ
Таким образом, числа Стирлинга второго рода могут задаваться следующей таблицей:
b k
n b
0
1
2
3
4
5
6
7

0
1
0
0
0
0
0
0
0

..
.

..
.

1
0
1
1
1
1
1
1
1

2
0
0
1
3
7
15
31
63

3
0
0
0
1
6
25
90
301

4
5
0
0
0
0
0
0
0
0
1
0
10
1
65
15
350 140

6
0
0
0
0
0
0
1
21

...
...
...
...
...
...
...
...
...
×k

7
0
0
0
0
0
0
0
1

n−1, n−1,
k−1
k
n,
k

..
.

Эти числа растут очень быстро. Так, например, S (10, 5) = 42525. Начальные условия могут задаваться по-другому:

 S (0, 0) = 1,
S (n, n) = 1, n > 0,

S (n, 0) = 0, n > 1;
или


 S (0, 0) = 1,
S (0, k) = 0, k > 1

S (n, 0) = 0, n > 1.

В качестве следующего примера найдем все разбиения четырехэлементного множества {1, 2, 3, 4}:
D1,1 = {1, 2, 3, 4} ,
D2,1 = {1} {2, 3, 4} ,
D2,2 = {2} {1, 3, 4} ,
D2,3 = {3} {1, 2, 4} ,
D2,4 = {4} {1, 2, 3} ,
D2,5 = {1, 2} {3, 4} ,
D2,6 = {1, 3} {2, 4} ,
D2,7 = {1, 4} {2, 3} ,
D3,1 = {1} {2} {3, 4} ,
D3,2 = {1} {3} {2, 4} ,
D3,3 = {1} {4} {2, 3} ,
D3,4 = {2} {3} {1, 4} ,
D3,5 = {2} {4} {1, 3} ,
D3,6 = {3} {4} {1, 2} ,
D4,1 = {1} {2} {3} {4} .
Диаграмма Хассе этого частичного упорядоченного множества будет иметь следующий вид:
`
{1, 2, 3, 4}
{2, 3, 4}

`

{1, 3, 4}

{3, 4}

`

`

{1, 2, 4}

{2, 4}

`

`

{1, 2, 3}

{2, 3}

`

`

` {1, 2}
` {1, 4}

`

`{1, 3}
` {1, 3}

{1, 4}

`

` {1, 2}

{1} {2} {3} {4}

Теорема 1.3. Для k > 2 справедливо следующее соотношение:

n−1 
n−1
S (n, k) = ∑
S (i, k − 1) .
i
i=k−1

(1.17)

20

ГЛАВА 1. КОМБИНАТОРИКА

 Док-во. Выделяем последний элемент и объявляем его уникальным.
Затем, для каждого j = 0, n − k выделяем среди

оставшихся элементов блок размера j (это можно сделать n−1
способами)
и присоединяем уникальный элемент этоj
му блоку. После этого (для каждого j) рассматриваем все возможные разбиения оставшегося (n − j − 1)-элементного
множества S (n − j − 1, k − 1). Ввиду уникальности последнего элемента и одного из блоков все вышеописанные ситуации несовместны, то есть перебирают различные разбиения. Таким образом,

n−k 
n−1
S (n, k) = ∑
S (n − j − 1, k − 1) .
j
j=0
Выполняя формальную замену переменной i = n − j − 1, получаем


n−1 
n−1 
n−1
n−1
S (n, k) = ∑
S (i, k − 1) = ∑
S (i, k − 1) ,
i
i=k−1 n − i − 1
i=k−1
что и требовалось доказать.



Заметим, что равенство 1.17 не может использоваться для корректного задания чисел Стирлинга второго рода.
Обозначим для разбиения n-элементного множества на k блоков для i = 1, n через ki > 0 число блоков, содержащих
i элементов. При этом
n

∑ iki = n,

i=1

n

∑ ki = k.

i=1

Обозначим за B (n; k1 , . . . , kn ) число разбиений n-элементного множества, содержащих ki блоков из i элементов для
i = 1, n. При условиях ∑ni=1 iki = n, ∑ni=1 ki = k
B (n; k1 , . . . , kn ) =

n!
k1 ! · · · kn ! (1!)k1 . . . (n!)kn

.

Действительно, раскидываем n элементам по n позициям.
[. . . ] . . . [. . . ] [. . . ] . . . [. . . ] . . . [. . . ] . . . [. . . ]
| {z } | {z } | {z }
kn

kn−1

k1

Это можно сделать n! различными способами. Затем отождествляем порядок блоков внутри групп блоков одного размера и отождествляем порядок элементов в каждом блоке. Очевидно, при этом получается требуемое число. Очевидно,
что согласно определению
S (n, k) = ∑ B (n; k1 , . . . , kn ) .
n

∑ iki =n

i=1

Определение 1.2.2. Числом Белла Bn называется число всевозможных разбиений n-элементного множества на блоки:
∞

Bn =

∑ S (n, k) ,

B0 = 1.

k=0

В терминах диаграмм Хассе частично упорядоченного множества разбиений число Белла равно числу вершин в
диаграмме.
Теорема 1.4. Для чисел Белла выполняется следующее равенство:
n  
n
Bn+1 = ∑
Bi .
i=0 i

(1.18)

 Док-во. Действительно, выбираем последний из n + 1 элементов исходного множества и называем его особым. Для
любого i = 0, n рассматриваем всевозможные различные блоки размера i оставшегося n-элементного множества и присоединяем к каждому из них по очереди особый элемент. Для оставшихся n − i элементов рассматриваем их всевозможные разбиения. Заметим, что таким образом перебираются различные разбиения ввиду различности выбираемых
блоков среди первых n неособых элементов. Далее, для разных i будут перебираться также все различные разбиения, так как в них особый элемент принадлежит блокам разных размеров. Таким образом, доказана справедливость
(1.18).

Заметим, что из симметричности биномиальных коэффициентов следует
n  
n  
n
n
Bn+1 = ∑
Bn− j = ∑
Bi .
j
j=0
i=0 i

21

1.2. ПРОИЗВОДЯЩИЕ ФУНКЦИИ
Числа Белла растут быстрей чисел Стирлинга второго рода: так, например, B20 = 51724158235372.
Рассмотрим два базиса полиномов над некоторым полем: стандартный
1, x, x2 , . . . , xn , . . .
и базис из убывающих факториалов
[x]0 , [x]1 , [x]2 , . . . , [x]n , . . .

Теорема 1.5. Числа Стирлинга второго рода суть коэффициенты перехода от второго базиса к первому:
xn =

n

∑ S (n, k) [x]k .

(1.19)

k=0

0

 Док-во. Докажем это по индукции. Для n = 0 равенство (1.19) превращается в очевидное: 1 = x0 = ∑ S (0, k) [x]k =
k=0

S (0, 0) [x]0 = 1. Докажем индуктивный переход. Рассмотрим для этого конечные множества A и B с мощностями соответственно |A| = n ∈ N и |B| = x ∈ N, x > n. Рассматриваем далее всевозможные отображения f : A → B. Их число равно
xn .
A
B

i1 , . . . , ik

n

k

x

В то же время каждое отображение f с областью значений D f = {i1 , . . . , ik } ⊆ B, |Ds | = k можно единственным образом
представить следующим образом: выбираем какие-то k различных элементов множества B ( kx способов) и разбиение
множества A на k блоков (S (n, k) способов) и рассматриваем все взаимно однозначные отображения множества блоков
на D f (их число — k!). При этом функция f будет очевидным образом всюду определена. Далее заметим, что разным k,
разным разбиениям A на k блоков, разным биекциям разбиений A на D f соответствуют разные функции, отображающие
A в B. Таким образом,
n
x  
x
[x]
x
xn = ∑
(1.20)
k! · S (n, k) = ∑ k k! · S (n, k) = ∑ S (n, k) [x]k ,
k=0
k=1 k
k=1 k!
поскольку S (n, 0) = 0, n > 1. Равенство (1.20) справедливо для всех натуральных n и k. Теперь заметим, что если два
полинома равны во всех целочисленных точках, то они равны тождественно на всей числовой оси.

Определение 1.2.3. Числом Стирлинга первого рода s (n, k) называется коэффициент перехода от стандартного
базиса полиномов к базису из убывающих факториалов:
n

[x]n =

∑ s (n, k) xk .

k=0

Очевидно, s (0, 0) = 1, s (n, 0) = 1, n > 1. Также понятно, что s (n, n) = 1, ∀ n ∈ N, s (n, k) = 0, k > n, так как коэффициенты при любых равных степенях, в том числе и при старшей, у тождественно равных полиномов должны совпадать.
Запишем определение числа Стирлинга первого рода:
n−1

[x]n = [x]n−1 (x − n + 1) =

∑ s (n − 1, k) · x

!
k

n

(x − n + 1) =

k=0

∑ s (n, k) xk .

k=0

Приравнивая коэффициенты при равных степенях в последнем равенстве, получаем тождество, которое может служить
рекуррентным определением чисел Стирлинга первого рода:
s (n, k) = s (n − 1, k − 1) − (n − 1) · s (n − 1, k) .
Видно, что если n и k одной четности, то s (n, k) > 0, если же n и k разной четности, что s (n, k) < 0. Поведение этих чисел

22

ГЛАВА 1. КОМБИНАТОРИКА

можно показать на таблице.
b k
n b
0
1
2
3
4
5
6

0
1
0
0
0
0
0
0

1
2
3
4
5
0
0
0
0
0
1
0
0
0
0
−1
1
0
0
0
2 −3
1
0
0
−6
11
−6
1
0
24 −50
35 −10
1
−120 274 −225
85 −15

6
0
0
0
0
0
0
1

...
...
...
...
...
...
...
...
×(1−n)

..
.

..
.

n−1, n−1,
k−1
k
n,
k

..
.

Из свойств коэффициентов перехода от одного базиса к другому вытекает справедливость равенства
∞

∑ s (n, k) S (k, m) = δnm .

k=0

Начальные условия в свою очередь могут задаваться двумя способами:

 s (0, 0) = 1,
s (n, n) = 1, n > 0,

s (n, 0) = 0, n > 1;
или


 s (0, 0) = 1,
s (0, k) = 0, k > 1

s (n, 0) = 0, n > 1.

Перед тем, как перейти к содержательному смыслу, связанному с числами Стирлинга первого рода, отметим, что их
модулю растет достаточно быстро, значительно быстрей, чем числа Стирлинга второго рода. Так, например, s (10, 3) =
−1026576.
Обозначим за c (n, k) число перестановок из n элементов, которые представляются в виде произведения k простых
циклов (перестановки вида π = [. . . ]1 [. . . ]2 · · · [. . . ]k ). Понятно, что
c (n, n) = 1, c (n, 1) = n!/n = (n − 1)! = |s (n, 1)| .
Далее, очевидно, что
c (n, k) = c (n − 1, k − 1) + (n − 1) c (n − 1, k) .
Это равенство доказывается тем же самым приемом с уникальным элементом, что и теоремы 1.3 и 1.5. В то же время
c (n, k) = (−1)n−k s (n, k) = |s (n, k)| .
Таким образом, если знакопеременной двухиндексной последовательности чисел Стирлинга первого рода трудно приписать комбинаторный смысл, то модули этих чисел имеют вполне конкретный содержательный смысл: они выражают
число перестановок, представляющихся в виде произведения заданного числа циклов.
Рекуррентные соотношения и производящие функции. Пусть u0 , u1 , . . . , un , . . . — последовательность (например,
из поля комплексных чисел). Тогда формальный степенной ряд
f (x) = u0 + u1 x + u2 x2 + · · · + un xn + · · ·
называется производящей функцией последовательности {un }∞
n=0 . Если этот степенной ряд сходится, то следующие формально введенные операции приобретают общепринятый смысл. Для производящей функции
g (x) = v0 + v1 x + v2 x2 + · · · + vn xn + · · ·
последовательности v0 , v1 , . . . , vn , . . . над тем же полем естественным образом вводятся линейные комбинации производящих функций α f (x) + β f (x), а также произведение:
∞

f (x) · g (x) = h (x) =

∑ wn xn ,

n=0

23

1.2. ПРОИЗВОДЯЩИЕ ФУНКЦИИ
где
n

wn = u0 vn + u1 vn−1 + · · · + ui vn−i + · · · + un v0 = ∑ ui vn−i .
i=0

−1 (x): f (x) ·
Если u0 6= 0, то для производящей функции последовательности {un }∞
n=0 существует обратный элемент f
−1
f (x) = 1, формальный ряд которого определяется следующим образом:

1
u0
v0 · u1
⇒ v1 = −
u0
...
u1 vn−1 + · · · + ui vn−i + · · · + un v0
⇒ vn = −
u0
...

0 = v0 · u0

⇒ v0 =

0 = v0 · u1 + v1 · u0

0 = u0 · vn + u1 vn−1 + · · · + ui vn−i + · · · + un v0

Рассмотрим известный пример последовательности Фибоначчи F0 , F1 , . . ., задаваемой начальными условиями F0 =
F1 = 1 и рекуррентным соотношением Fn+2 = Fn+1 + Fn . Первые ее пять членов будут равны:
F0 = 1,

F1 = 1,

F2 = 2,

F3 = 3,

F4 = 5,

F5 = 8.

Найдем ее производящую функцию. Поскольку последовательность, легко видеть положительная и строго возрастающая (Fn+1 > Fn ), а Fn+1 = Fn + Fn−1 , легко заключить, что Fn+1 < 2Fn ⇒ Fn < 2n . Таким образом, производящая функция
последовательности
∞

f (x) =

∑ Fn xn

(1.21)

n=0

сходится в открытом круге R < 21 . В нем допустимы следующие действия:
f (x) = F0
−x f (x) =
−x2 f (x) =

+F1 x
−F0 x

+F2 x2
−F1 x2
−F0 x2

+F3 x3 + · · ·
+Fn xn + · · ·
3
−F2 x − · · · −Fn+1 xn+2 − · · ·
−F1 x3 − · · ·
−Fn xn+3 − · · ·

Сложим эти три равенства. Заметим при этом, что согласно рекуррентному определению чисел Фибоначчи коэффициенты при всех степенях, начиная со второй, обнулятся:

1 − x − x2 f (x) = F0 + (F1 − F0 ) x =⇒ f (x) =

1
.
1 − x − x2

Обозначим k (x) = 1 − x − x2 — многочлен, обратный к производящей функции последовательности. Характеристическим многочленом называется функция
√
√
 
1
1− 5
1+ 5
h (x) = x2 k
= x2 − x − 1 = (x − α1 ) (x − α2 ) , где α1 =
, α2 =
.
x
2
2
Отсюда легко видеть, что
k (x) = x2 h

 
1
= (1 − α1 x) (1 − α2 x) .
x

Таким образом, производящую функцию можно разложить на простые дроби следующим образом:
f (x) =

1
1
A
B
=
=
+
,
1 − x − x2
(1 − α1 x) (1 − α2 x) 1 − α1 x 1 − α2 x

где A и B определяются из системы линейных уравнений

A+B
= 1,
−α2 A − α1 B = 0.
Решением являются значения A =

√
1+√ 5
2 5

√

=

α1
√
,
5

α2
√ 5 = −√
B = − 1−
. Теперь можно разложить производящую функцию в
2 5
5

степенной ряд по степеням x, используя то, что
∞

f (x) = A ∑

n=0

α1n xn + B

∞

∑

n=0

1
1−z

α2n xn

= 1 + z + z2 + · · ·.
∞

=

∑

n=0

(Aα1n + Bα2n ) xn

∞

=

∑

n=0

α1n+1 α2n+1
√ − √
5
5

!
xn .

(1.22)

24

ГЛАВА 1. КОМБИНАТОРИКА

Приравнивая коэффициенты при равных степенях в (1.21) и (1.22), получаем

√ !n+1
√ !n+1 

1
1
+
5
1
−
5
1
.
−
Fn = √ α1n+1 − α2n+1 = √ 
2
2
5
5
Числа Фибоначчи имеют понятный содержательный смысл: для n > 1 это число двоичных последовательностей длины n − 1, у которых никакие две единицы не стоят рядом. Легко понять, что fn+2 = Fn+3 путем выделения последнего
разряда складывается из последовательностей длины n + 1, у которых никакие две единицы не стоят рядом с выделенным разрядом нулем и последовательностей длины n, у которых никакие две единицы не стоят рядом с выделенным
разрядом единицей: fn+2 = fn+1 + fn .
Пусть дана последовательность {un }∞
n=0 над некоторым полем. Линейных однородным рекуррентным соотношением
с постоянными коэффициентами порядка r называется равенство вида
un+r − p1 un+r−1 − p2 un+r−2 − · · · − pr−1 un+1 − pr un = 0.
При известных начальных условиях u0 , u1 , . . . , ur−1 при его помощи может быть достаточно легко найден общий вид uk .
Действительно, если производящая функция для этой последовательности равна
∞

u (x) =

∑ un xn ,

x ∈ C,

n=0

то, поступая также, как и в случае последовательности Фибоначчи, получим
k (x) = 1 − p1 x − p2 x2 − · · · − pr xr .
Имеем,
k (x) · u (x) = C (x) ,

degC (x) 6 r − 1,

что также ясно из рассмотренного выше примера последовательности Фибоначчи. Поступаем далее аналогично:
 
 
1
1
r
r−1
r
r
h (x) = x k
= x − p1 x − · · · − pr , k (x) = x h
x
x
и по основной теореме алгебры существует единственное представление
h (x) = xr − p1 xr−1 − · · · − pr = (x − α1 )s1 (x − α2 )s2 · · · (x − αq )sq ,

s1 + s2 + · · · + sq = r.

Отсюда способ нахождения явного выражения для степенного ряда производящей функции
u (x) =

q si
βi j
C (x)
.
sq = ∑ ∑
(1 − α1 x) · · · (1 − αq x)
(1
−
αi x) j
i=1 j=1
s1

(1.23)

В качестве еще одного примера можно найти, какую последовательность определяет производящая функция
1
.
(1 − αx)n
Для этого воспользуемся разложением в ряд функции
1
(−1) (−n − 1) · · · (−n − m + 1) m
(1 + z)−n = 1 + (−n) z + (−n) (−n − 1) · z2 + · · · +
z +··· .
2
m!
Тогда
∞
∞
1
(−n) (−n − 1) · · · (−n − m + 1)
(n + m − 1) · · · (n + 1) n m m
(−αx)m = ∑
α x =
n = ∑
(1 − αx)
m!
m!
m=0
m=0


∞ 
∞ 
n+m−1 m m
n+m−1 m m
α x , (1.24)
∑ n−1 α x = ∑
m
m=0
m=0


= Pn−1 (m), выступающий
то есть это — производящая функция чисел сочетаний с повторениями. Заметим, что n+m−1
n−1
в роли коэффициента при α m xm в сумме (1.24), является многочленом от m степени n − 1. Используя этот факт, окончательное выражение для производящей функции можно переписать несколько иначе, подставив разложение (1.24) в
(1.23):
!
q si
q
∞
βi j
n
u (x) = ∑ ∑
= ∑ ∑ Q6si−1 (n) αi xn .
j
(1
−
α
x)
i
i=1 j=1
n=0 i=1

25

1.2. ПРОИЗВОДЯЩИЕ ФУНКЦИИ
Исходя из r начальных условий можно получить общий член последовательности из линейной системы уравнений:
q

un = ∑ Q6si −1 (n) αin .
i=1

Найдем теперь производящую функцию
∞

∞

∑ ∑ fn,k xn yk

F (x, y) =

n=0 k=0


двухиндексной последовательности чисел сочетаний с повторениями fn,k = n−k+1
, задаваемой линейным рекурk
рентным соотношением
f
−
f
−
f
=
0,
что
продемонстрировано
на
таблице
(1.10). Легко получить, что
n,k
n−1,k
n−2,k−1

1 − x − x2 y F (x, y) = 1 + xy. Тогда
F (x, y) =

∞
∞
1 + xy
= (1 + xy) ∑ x` (1 + xy)` = ∑ x` (1 + xy)`+1 =
1 − x (1 + xy)
`=0
`=0



∞
`+1 
∞
∞ 
∞ ∞ 
`+1 m m
`+1 m m
` + 1 `+m m
`
`
∑x ∑ m x y = ∑x ∑ m x y = ∑ ∑ m x y .
`=0 m=0
`=0 m=0
`=0 m=0

Выполняя замену переменных n = ` + m, k = m, получаем
∞

F (x, y) =

∞



∑∑

n=0 k=0


n−k+1 n k
x y.
k

Таким образом, получено, что единственным решением
линейного однородного рекуррентного соотношения с постоян
ными коэффициентами (1.9) является fn,k = n−k+1
.
k
Определение 1.2.4. Числом Каталана un называется число способов корректной расстановки скобок в произведении n сомножителей
x1 · x2 · · · xn .
Очевидно, что u0 = 0, u1 = u2 = u1 ·u2 = 1 и числа Каталана удовлетворяют следующему соотношению un = u1 ·un−1 +
u2 · un−2 + · · · + un−1 · u1 , n > 2. Действительно, первый сомножитель в каждом слагаемом указывает число способов
расстановки скобок слева, а второй — справа. Заметим, что ничего не изменится, если это соотношение дополнить
двумя нулевыми слагаемыми:
un = u0 · un + u1 · un−1 + · · · + un · u0 , n > 2.
Производящая функция последовательности чисел Каталана
∞

∑ un xn

u (x) =

n=0

удовлетворяет простому соотношению: u2 (x) = −x + u (x). Действительно, возведем ее в квадрат и соберем коэффициенты при равных степенях: u2 (x) = 0+0·x+u2 ·x2 +u3 ·x3 +· · · = −x+u (x). Заметим, что это тождество выполняется как
формальное для рядов. В действительности решить это функциональное уравнение традиционными методами не удается, так как неизвестно, сходится этот формальный ряд или нет. Поэтому прибегают к следующему приему: рассмотрим
функцию
√
1 − 1 − 4x
1
|x| < ,
v (x) =
;
2
4
удовлетворяющую этому же функциональному отношению и аналитическую в открытом круге с центром в нуле ненулевого радиуса. Осталось доказать только начальные условия: очевидно, что коэффициент разложения v (x) в ряд по
степеням x
∞

v (x) =

∑ vn · xn

n=0

и v0 = v (0). Надо найти v1 . Разложим для этого в ряд функцию
(1 + z)m =

∞

∑ an · zn ,

n=0

Отсюда


1
vn = −
2

1
2

1
2


−1 ···
n!

1
2


−n+1

(−4)n =

an =

1
2

√
1 − 4x. Используем известное разложение

m (m − 1) · · · (m + 1 − n) n
·z .
n!

1 12 · 12 · 32 · · · 2n−3
2
4n =
2
n!
1 · 3 · · · (2n − 3) n−1 1 · 3 · · · (2n − 3) · 2 · 4 · · · (2n − 2)
(2n − 2)!
2
=
=
.
n!
n! (n − 1)!
n! (n − 1)!

26

ГЛАВА 1. КОМБИНАТОРИКА

Отсюда получается, что v1 = u1 = 1. Таким образом, v (x) — действительно производящая функция последовательности
чисел Каталана. Сразу можно показать общую формулу для них:




(2n − 2)!
2n − 1
1
1 2n − 2
un =
=
·
=
.
n! (n − 1)!
n
2n − 1 n n − 1
Числа Каталана играют важную роль во многих комбинаторных задачах. Так, например, если обозначить an —
число способов разбить (n + 2)-угольник на треугольники, то оно будет являться числом Каталана индекса на единицу
больше:
 
n−1
(2n)!
1
2n
an = ∑ al an−` , an = un+1 =
=
.
n!
(n
+
1)!
n
+
1
n
`=1
Другим примером является точная оценка числа деревьев (имеется ввиду их укладок на плоскости) на n вершинах. Действительно, между последовательностями из нулей и единиц длины 2n, кодирующими деревья и расстановками скобок
можно установить изоморфизм: в каждом префиксе число единиц (открывающихся скобок) не меньше числа нулей
(закрывающихся скобок). Этот же результат может быть сформулирована по-другому: число путей в целочисленной
решетке от вершины (0, 0) к вершине (n, n), проходящих под диагональю.
Рассмотрим для последовательности {an }∞
n=0 линейное неоднородное рекуррентное соотношение с постоянными
коэффициентами:
an+r − p1 an+r−1 − · · · − pr an = f (n) .
Общее решение неоднородного соотношения an представляется в виде суммы общего решения однородного соотношения a0n и некоторого частного решения неоднородного: an = a0n + a00n . Частное решение ищется достаточно просто в
случае f (n) = λ n Pm (n). Тогда если h (λ ) = 0 кратности k, где h (x) = 0 — характеристическое уравнение, то частное
решение ищется в виде nk Qm (n) λ n , где Qm (m) — полином степени m.
Рассмотрим некоторую последовательность чисел {an }∞
n=0 из поля F. Наряду с обычной производящей функцией
∞

A (x) =

∑ an xn

n=0

введем экспоненциальную производящую функцию:
Ae (x) =

∞

an

∑ n! xn .

n=0

∞
∞
Для производящих функций этих двух видов последовательностей {an }∞
n=0 , {bn }n=0 , {cn }n=0 выполняются очевидные
свойства:

A (x) = B (x) ⇐⇒ an = bn ,
A (x) + B (x) = C (x) ⇐⇒ an + bn = cn ,
n

A (x) · B (x) = C (x) ⇐⇒

∑ ak bn−k = cn ,

k=0

Ae (x) = Be (x) ⇐⇒ an = bn ;
Ae (x) + Be (x) = Ce (x) ⇐⇒ an + bn = cn ;
n  
n
e
e
e
A (x) · B (x) = C (x) ⇐⇒ ∑
ak bn−k = cn .
k=0 k

(1.25)
(1.26)
(1.27)

Соотношение (1.25) называется также принципом равенства, а случай экспоненциальных производящих функций
(1.27) легко запомнить, используя следующее мнемоническое правило: надо раскрыть правую часть (a + b)n = cn , используя формулу бинома Ньютона, и перевести все степени в индексы. В случае полей R или C соответствующие бесконечные алгебры многочленов R [[x]] и C [[x]] получили название алгебры Коши, а Re [[x]] и Ce [[x]] — формального
исчисления Блиссара.
Принцип Лагранжа. Если формальные степенные ряды существуют в некоторой ненулевой окрестности
нуля как аналитические функции, то над ними можно осуществлять любые допустимые операции как над
функциями.
Из принципа Лагранжа вытекает в частности, что в случае сходимости ряда его можно дифференцировать по следующему правилу:
∞
∞
d
A (x) = ∑ an xn =⇒ A (x) = ∑ nan xn−1 .
dx
n=0
n=1
Это корректно в силу теоремы Коши-Адамара, утверждающей, что если степенной ряд сходится в некоторой ненулевой
окрестности нуля, то он сходится абсолютно, и того факта, что сходимость ряда из производных равномерна.
Пусть дана последовательность {an }∞
n=0 чисел с известной производящей функцией A (x). Требуется найти последовательность Sn = a0 + a1 + · · · + an . Легко видеть, что производящая функция этой последовательности будет выглядеть
так:
A (x)
.
S (x) =
1−x

27

1.2. ПРОИЗВОДЯЩИЕ ФУНКЦИИ
Пусть для начала ai = i, ∀ i > 0. Для любого 0 < ε < 1 ряд A (x) сходится в окрестности нуля (−1 + ε, 1 − ε) к


1
d
x
1
.
A (x) = x ·
= 0 + 1 · x + 2 · x2 + · · · + n · xn + · · · =
dx 1 − x
(1 − x)2
Тогда
S1 (x) =
и

x
(1 − x)3



(n + 2) (n + 1)
n+1
(−3) (−3 − 1) · · · (−3 − n + 1)
· (−1)n =
=
.
n!
2!
2

Sn1 =

В качестве еще одного примера рассмотрим ai = i2 , ∀ i > 0. Для любого 0 < ε < 1 ряд A (x) сходится в окрестности нуля
(−1 + ε, 1 − ε) к



d
d
1
x (x + 1)
x·
= 0 + 1 · x + 4 · x2 + · · · + n2 · xn + · · · =
A2 (x) = x ·
.
dx
dx 1 − x
(1 − x)3
Тогда
S2 (x) =

x (x + 1)
4

(1 − x)

= x2 + x

∞



(−4) (−5) · · · (−4 − n + 1)
(−1)n xn =
n!
n=0

∑

x2 + x

∞



(n + 3) (n + 2) (n + 1) n
x
3!
n=0

∑

и

1
n (n + 1) (2n + 1)
((n + 2) (n + 1) n + (n + 1) n (n − 1)) =
.
6
6
Сумму первых n кубов можно также найти, используя аппарат производящих функций, но есть и более изящный способ, основанный на тождестве, которое легко доказывается по индукции: (1 + 2 + · · · + n)2 = 13 + 23 + · · · + n3 , то есть


n+1 2
3
Sn =
.
2
Sn2 =

Основные свойства обычных производящих функций.
fn1 = fn2
fn =

fn1 + fn2

(
0,
Fn =
fn−1

n = 0,
иначе;

Fn = fn+1

⇐⇒ f1 (x) = f2 (x) ;

(1.28)

⇐⇒ f (x) = f1 (x) + f2 (x) ;

(1.29)

⇐⇒ F (x) = x · f (x) ;

(1.30)

⇐⇒ F (x) =

f (x) − f0
,
x

( f0 = f (0)) ;

(1.31)

k−1

f (x) − ∑ fr xr
Fn = fn+k
Fn = k · fn
Fn = α n fn
Fn = n · fn
n

Fn =

∑ fr

r=0

(
0,
n = 1, k − 1,
Fn =
fn−k , n > k,

r=0

⇐⇒ F (x) =

xk
⇐⇒ F (x) = k · f (x) ;
⇐⇒ F (x) = f (αx) ;
d
⇐⇒ F (x) = x f (x) ;
dx
f (x)
⇐⇒ F (x) =
;
1−x

;

(1.32)
(1.33)
(1.34)
(1.35)
(1.36)

⇐⇒ F (x) = xk f (x) ;

(1.37)

⇐⇒ F (x) = f (x) · g (x) ;

(1.38)

n

Fn =

∑ fr gn−r

r=0

Fn = fn+1 − fn
1 N
∑ fn
N→∞ N
n=0

⇐⇒ F (x) =

(1 − x) f (x) − f0
;
x

1 N
lim (1 − x) · f (x) ;
∑ fn = x→1
N→∞ N
n=0

∃ lim

=⇒ lim

∃ lim fn

=⇒ lim fn = lim (1 − x) f (x) .

n→∞

n→∞

x→1

(1.39)
(1.40)
(1.41)

28

ГЛАВА 1. КОМБИНАТОРИКА

Основные преобразования обычных производящих функций.
(
1,
fn =
0,
(
1,
fn =
0,

n = 0,
n > 1,

⇐⇒ f (x) ≡ 1;

(1.42)

n = k,
n 6= k,

⇐⇒ f (x) = xk ;

(1.43)

1
;
1−x
1
f (x) =
;
1 − αx
αx
f (x) =
;
(1 − αx)2
ax
f (x) =
;
(1 − x)2
1
;
f (x) =
(1 − αx) p
1
f (x) =
;
(1 − αx) p
d
f (x) = x · g (x) , где gn = nk−1 ;
dx
αx (1 + αx)
f (x) =
;
(1 − αx)3

αx α 2 x + 4αx + 1
f (x) =
;
(1 − αx)4
d
f (x) = x g (αx) , где gn = nk−1 ;
dx

fn ≡ 1

⇐⇒ f (x) =

(1.44)

fn = α n

⇐⇒

(1.45)

fn = n · α n

⇐⇒

fn = a · n

⇐⇒



n+ p−1 n
fn =
α , n > 0, p > 1
n

⇐⇒

fn = n2

⇐⇒

fn = nk

⇐⇒

fn = n2 α n

⇐⇒

fn = n3 α n

⇐⇒

fn = nk α n
( 
k
α n β k − n, k > n,
fn = n
0,
n > k,
(
0,
n = 0,
fn = α n
n , n > 1,
(
0,
n — четное,
fn = α n
,
n
— нечетное,
n
(
0,
n = 0 ∨ n — нечетное,
fn = α n
n , n > 2 & n — четное,

⇐⇒

fn =
fn =
fn =

αn
n!
(
0,
αn
n! ,

n — четное,
n — нечетное,

(
0,

n = 0 ∨ n — нечетное,
n! , n > 2 & n — четное,

αn

fn =

(ln α)n
n!

(1.48)
(1.49)
(1.50)
(1.51)
(1.52)
(1.53)
(1.54)

⇐⇒ f (x) = − ln (1 − αx) ;

(1.55)

⇐⇒ f (x) = Arctg (αx) =



1
1 + αx
ln
;
2
1 − αx

(1.56)


1
⇐⇒ f (x) = − ln 1 − α 2 x2 ;
2

(1.57)

⇐⇒ f (x) = eαx ;

(1.58)

⇐⇒ f (x) =

eαx − e−αx
= sh x;
2

(1.59)

⇐⇒ f (x) =

eαx + e−αx
= ch x;
2

(1.60)

⇐⇒ f (x) = α x ;
⇐⇒ f (x) =

fn = cos αn

⇐⇒ f (x) =

fn = a−β n cos αn

(1.47)

⇐⇒ f (x) = (β + αx)k ;

fn = sin αn

fn = a−β n sin αn

(1.46)

(1.61)
x sin α

x2 − 2x cos α + 1

;

1 − x cos α
;
x2 − 2x cos α + 1
x sin α
⇐⇒ f (x) = −β 2
;
a x − 2x cos α + aβ
aβ − x cos α
;
⇐⇒ f (x) = −β 2
a x − 2x cos α + aβ

(1.62)
(1.63)
(1.64)
(1.65)

29

1.2. ПРОИЗВОДЯЩИЕ ФУНКЦИИ
x sh α
;
x2 − 2x ch α + 1
1 − x ch α
⇐⇒ f (x) = 2
;
x − 2x ch α + 1
x sh α
⇐⇒ f (x) = −β 2
;
a x − 2x ch α + aβ
aβ − x ch α
⇐⇒ f (x) = −β 2
.
a x − 2x ch α + aβ
⇐⇒ f (x) =

fn = sh αn
fn = ch αn
fn = a−β n sh αn
fn = a−β n ch αn

(1.66)
(1.67)
(1.68)
(1.69)

Примеры.
1. Найти an по рекуррентным соотношениям и начальным условиям:
(a) an+2 − 4an+1 + 3an = 0, a1 = 10, a2 = 16.
 Решение. Для начала найдем, что a0 = 8, и заменим начальные условия на эквивалентные a0 = 8, a1 = 10.
Характеристическим уравнением этой последовательности является x2 − 4x + 3 = 0. Оно имеет два вещественных корня кратности один: α1 = 1, α2 = 3. Таким образом, общее решение данного линейного однородного рекуррентного соотношения с постоянными коэффициентами выписывается в виде an = C1 +C2 · 3n . Из
начальных условий получаем, что C1 +C2 = 8, C1 + 3C2 = 10 ⇒ C1 = 7, C2 = 1. Таким образом, окончательно

an = 7 + 3n .
(b) an+3 − 3an+1 + 2an = 0, a1 = a, a2 = b, a3 = c.
 Решение. Для начала найдем, что a0 = 3a−c
и заменим начальные условия на эквивалентные a0 =
2
3a−c
3
2 , a1 = a, a2 = b. Характеристическим уравнением для последовательности является x − 3x + 2 = 0. Оно
имеет вещественный корень α1 = 1 кратности два и вещественный корень α2 = −2 кратности один. Таким
образом, общее решение данного линейного однородного рекуррентного соотношения с постоянными коэффициентами выписывается в виде an = C1 +C2 n +C3 (−2)n . Из начальных условий получаем, что


,
 C1 = 14a−b−4c
 C1 +C3 = 3a−c
9
2 ,
C1 +C2 − 2C3 = a, ⇐⇒
C2 = b−2a+c
,
3


C1 + 2C2 + 4C3 = b;
C3 = 2b−a−c
18 .
Таким образом, окончательно an =

14a−b−4c
9

+ b−2a+c
n + 2b−a−c
(−2)n .
3
18



(c) an+2 − 2 cos αan+1 + an = 0, a1 = cos α, a2 = cos 2α.
 Решение. Для начала найдем, что a0 = 1 и заменим начальные условия на эквивалентные a0 = 1, a1 =
cos α. Характеристическим уравнением для последовательности является x2 − 2x cos α + 1 = 0. Оно имеет
два комплексно сопряженных корня α1 = cos α − i sin α и α2 = cos α + i sin α кратности один каждый. Таким образом, общее решение данного линейного однородного рекуррентного соотношения с постоянными
коэффициентами выписывается в виде an = C1 (cos α − i sin α)n +C2 (cos α + i sin α)n . Из начальных условий
получаем, что C1 + C2 = 1, (C1 +C2 ) cos α − (C1 −C2 ) sin α = cos α ⇒ C1 = C2 = 12 . Таким образом, окончательно
1
e−inα + einα
an = ((cos α − i sin α)n + (cos α + i sin α)n ) =
= cos nα.
2
2

2. Вывести общее выражение для определителя трехдиагональной матрицы порядка n.
 Решение. Трехдиагональная матрица порядка n имеет следующий вид:


a b 0 0 ... 0 0 0
c a b 0 . . . 0 0 0


0 c a b . . . 0 0 0


0 0 c a . . . 0 0 0


An = 

. . . . . . . . . . . . . . . . . . .
0 0 0 0 . . . a b 0 


0 0 0 0 . . . c a b
0 0 0 0 . . . 0 c a n×n

30

ГЛАВА 1. КОМБИНАТОРИКА
Обозначим det An = ∆n . Начальные условия для нее выписываются достаточно просто:

∆0 = 1 (по
 договоренности),
∆1 = det a = a.
Далее, для n > 2, используя разложение по первой строке, а затем по первому столбцу легко получить, что ∆n =
a∆n−1 − bc∆n−2 ⇔ ∆n+2 − a∆n+1 + bc∆n = 0. Характеристическое уравнение для данного линейного однородного
рекуррентного соотношения с постоянными коэффициентами имеет вид x2 − ax + bc = 0. В зависимости от того,
равен или не равен нулю его дискриминант D = a2 − 4bc, возможны два случая:
(a) D 6= 0. Тогда
∆n = C1

!n
√
a − a2 − 4bc
+C2
2

!n
√
a + a2 − 4bc
,
2

где C1 и C2 определяются из уравнений
(

C1 +C2 = 0,
−C1 +C2 = √

a
.
a2 −4bc

Решением являются
√
a − a2 − 4bc
C1 = − √
,
2
a2 − 4bc
1

√
a + a2 − 4bc
C2 = √
,
2
a2 − 4bc
1

где квадратные корни являются алгебраическими и во всех случаях их значения полагаются одинаковыми.
Таким образом, в случае некратных корней
!n+1
!n+1
√
√
1
1
a − a2 − 4bc
a + a2 − 4bc
∆n = − √
+√
.
2
2
a2 − 4bc
a2 − 4bc
(b) D = 0. Тогда
∆n = (C1 +C2 n)

 a n
2

,

где C1 и C2 определяются из уравнений


C1 = 1,
C1 +C2 = 2.

Решением являются C1 = C2 = 1. Таким образом, в случае кратных корней
 a n
∆n = (1 + n)
.
2

3. Найти общие решения рекуррентных соотношений:
(a) an+2 + 3an = 0.
 Решение. Характеристическое уравнение для данной√
последовательности
x2 + 3 = 0 имеет два комплекс√
но сопряженных мнимых корня кратности один: α1 = −i 3 и α2 = i 3. Таким образом, общее решение данного линейного однородного рекуррентного соотношения с постоянными коэффициентами выписывается в
виде
 √ n
 √ n
n
an = C1 −i 3 +C2 i 3 = C1 3 2 (in + (−i)n ) =


n
n
πn
πn 
πn
πn 
− i sin
+C2 3 2 cos
+ i sin
.
C1 3 2 cos
2
2
2
2

(b) an+2 + 2an+1 + an = 0.
 Решение. Характеристическое уравнение для данной последовательности x2 + 2x + 1 = 0 имеет один
вещественный корень α = −1 кратности два. Таким образом, общее решение данного линейного однородного рекуррентного соотношения с постоянными коэффициентами выписывается в виде an =
(C1 +C2 n) (−1)n .


31

1.2. ПРОИЗВОДЯЩИЕ ФУНКЦИИ
(c) an+3 + 10an+2 + 32an+1 + 32an = 0.

 Решение. Характеристическое уравнение для исходной последовательности имеет вид x3 + 10x2 +
32x + 32 = 0. Оно имеет вещественный корень α1 = −2 кратности один и вещественный корень α2 =
−4 кратности два. Таким образом, общее решение данного линейного однородного рекуррентного соотношения с постоянными коэффициентами выписывается в виде an = C1 (−2)n + (C2 +C3 n) (−4)n =
(−2)n (C1 + (C2 +C3 n) 2n ).

4.

(a) Пусть {an } и {bn } — две последовательности, члены которых связаны соотношениями
an+1 = p1 an + q1 bn ,
bn+1 = p2 an + q2 bn ,
∆ = p1 q2 − p2 q1 6= 0,
где p1 , q1 , p2 , q2 — данные числа. Найти выражения для an и bn , считая, что a1 и b1 заданы.
 Решение. Найдем a0 , b0 из системы уравнений


a1 = p1 a0 + q1 b0 ,
⇐⇒
b1 = p2 a0 + q2 b0 ;

(

1 b1
a0 = q2 a1 −q
,
∆
p2 a1 −p1 b1
b0 = −
.
∆

и заменим начальные условия на эквивалентные при n = 0. Пусть q1 6= 0. Выражаем из первого уравнения
bn =

1
(an+1 − p1 an ) ,
q1

bn+1 =

1
(an+2 − p1 an+1 )
q1

и подставляем их во второе:
1
1
(an+2 − p1 an+1 ) = p2 an + q2 (an+1 − p1 an ) .
q1
q1
Преобразуем последнее равенство и получаем
an+2 − (p1 + q2 ) an+1 + ∆an = 0.


q
2
1
и α2 =
Корни этого характеристического уравнения равны α1 = 2 p1 + q2 − (p1 + q2 ) − 4∆


q
1
(p1 + q2 )2 − 4∆ , где корень алгебраический и один и тот же в обоих случаях. Таким обра2 p1 + q2 +
зом, в случае некратных корней
q
q
n
n

(p1 + q2 )2 − 4∆
p1 + q2 + (p1 + q2 )2 − 4∆
 ,
 +C2 
an = C1 
2
2
q
q
n
n


p1 + q2 − (p1 + q2 )2 − 4∆
p1 + q2 + (p1 + q2 )2 − 4∆
 .
 +C4 
bn = C3 
2
2


p1 + q2 −

В случае кратных корней

p1 + q2 n
an = (C1 +C2 n)
,
2


p1 + q2 n
bn = (C3 +C4 n)
.
2


Подставляя эти выражения в исходную систему, находим зависимость между C1 , C2 , C3 и C4 , оставляющую
две степени свободы (поскольку система не вырождена). Затем, подставляем начальные условия a0 , b0 и
находим константы.
Если q1 = 0, то проведем те же рассуждения, поменяв a на b и b на a. При этом необходимо p2 6= 0. Если же
p2 = 0 & q1 = 0, то ∆ = 0, что противоречит условию. Таким образом, решение найдено.


32

ГЛАВА 1. КОМБИНАТОРИКА
(b) Найти решение системы рекуррентных соотношений
an+1 = 3an + bn ,
bn+1 = −an + bn ,
a1 = 14, b1 = −6.
 Решение. Воспользуемся результатом упражнения 4a (в данном случае корни кратные).
an = (C1 +C2 n) 2n ,

bn = (C3 +C4 n) 2n .

Подставляя в исходную систему, находим C4 = −C2 , C3 = −C1 + 2C2 , то есть
an = (C1 +C2 n) 2n ,

bn = (−C1 + 2C2 −C2 n) 2n .

Далее, учитывая, что a0 = 5, b0 = −1, получаем C1 = 5, C2 = 2. Таким образом, окончательно
an = (5 + 2n) 2n ,

bn = (−1 − 2n) 2n .


5. Найти решение системы рекуррентных соотношений

 an+1 = −an + 2bn ,
bn+1 = 2an + 2bn ,

a0 = 3, b0 = 1.
 Решение. Решим задачу на языке матриц. Система задается матрицей


−1 2
A=
2 2
и начальным вектором
 
3
X0 =
1
Собственные значения A равны λ1 = −2, λ2 = 3 с собственными векторами соответственно


1

2
1 2
−1
5
5
собственных векторов составим матрицу Q =
⇒Q = 2
. Далее,
2 −1
− 15
5
A = QΛQ−1 ,

Yn = Q−1 Xn =⇒ Yn+1 = ΛYn ,

   
1
2
и
. Из
2
−1

Yn = ΛnY0 =⇒ Xn = QΛn Q−1 X0 .

В то же время
n

A

=

n

−1

QΛ Q



 n
1 2
3
2 −1
0

0
(−2)n

1
5
2
5

2
5

− 15

1


=

5
2
5

· 3n + 45 · (−2)n
· 3n − 25 · (−2)n

2
5
4
5


· 3n − 25 (−2)n
.
· 3n + 15 (−2)n

Таким образом,


an = 3n − (−2)n+1 ,
bn = 2 · 3n − (−2)n .


6. Решить рекуррентное соотношение an+3 − 6an+2 + 11an+1 − 6an = 4n, a0 = 1, a1 = 3, a2 = 4.
 Решение. Характеристическое уравнение для решения однородного соотношения последовательности x3 −
6x2 + 11x − 6 = 0 имеет три различных вещественных корня кратности один каждый: α1 = 1, α2 = 2, α3 = 3. Таким
образом, общее решение однородного соотношения имеет вид a0n = A · 1n + B · 2n + C · 3n . Частное решение имеет смысл искать в виде a00n = n (αn + β ) · 1n . Подставляя его в исходное уравнение и приравнивая коэффициенты
при равных степенях, получаем α = 1, β = 2, откуда an = a0n + a00n = A + B · 2n + C · 3n + n (n + 2). Теперь можно
определить константы A, B, C, исходя из начальных условий:


 A + B +C = 1,
 A = 1,
A + 2B + 3C = 0,
B = 1,
⇐⇒


A + 4B + 9C = −4;
C = −1.
Итак, окончательно, an = 1 + 2n − 3n + n (n + 2).



33

1.2. ПРОИЗВОДЯЩИЕ ФУНКЦИИ
7. Решить рекуррентные соотношения:
(a) an+1 − an = n, a1 = 1.

 Решение. Легко видеть, что a0 = 1. Заменим начальное условие на эквивалентное a0 = 1. Характеристическое уравнение для однородного соотношения x − 1 = 0 имеет один корень α = 1 кратности один. Таким
образом, общее решение однородного соотношения имеет вид a0n = A. Частное решение имеет смысл искать
в виде a00n = n (β n + γ). Подставляя его в исходное уравнение и приравнивая коэффициенты при равных степенях, получаем β = 12 , γ = − 12 , откуда an = a0n + a00n = A + 12 n (n − 1). Из начальных условий находим, что
A = 1 и an = 1 + n2 .

(b) an+2 + 2an+1 − 8an = 27 · 5n , a1 = −9, a2 = 45.
 Решение. Легко видеть, что a0 = 0. Заменим начальные условия на эквивалентные a0 = 0, a1 = −9.
Характеристическое уравнение для однородного соотношения x2 + 2x − 8 = 0 имеет два корня кратности один каждый α1 = −4, α2 = 2. Таким образом, общее решение однородного соотношения имеет вид
a0n = A (−4)n + B · 2n . Частное решение имеет смысл искать в виде a00n = β · 5n . Подставляя его в исходное уравнение и приравнивая коэффициенты при равных степенях, получаем β = 1, откуда an = a0n + a00n =
A (−4)n + B · 2n + 5n . Из начальных условий находим, что A = 2, B = −3 и an = 2 · (−4)n − 3 · 2n + 5n .

8. Решить систему линейных рекуррентных соотношений:

 an+1 = −bn + n,
bn+1 = an + 2bn + 1,

a0 = 1, b0 = −2.
 Решение. Заметим предварительно, что b1 = −2. Далее, выражая из второго уравнения bn+2 = an+1 + 2bn+1 + 1
и подставляя туда an+1 = −bn + n, получаем линейное рекуррентное соотношение относительно bn : bn+2 − 2bn+1 +
bn = n + 1. Его характеристическое уравнение имеет корень α = 1 кратности два, в связи с чем общим решением
однородного соотношения является b0n = A + Bn, а частное решение имеет смысл искать в виде b00n = n2 (β n + γ).
2
Подставляя последнее в уравнение, находим α = 61 , β = 0. Таким образом, bn = b0n + b00n = A + Bn + n6 . Используя
начальные условия на bn , получаем A = −2, B = − 61 . Таким образом,
bn = −2 −

n n3
+ ,
6
6

an = 2 +

7 (n − 1) (n − 6)3
2
1
1
−
= 1 + n + n2 − n3 .
6
6
3
2
6


Упражнения.
1. Найти числа Стирлинга второго рода:
(a) S (n, n − 1) и
(b) S (n, n − 2).
2. Найти общие решения рекуррентных соотношений:
(a) an+2 − 4an+1 + 3an = 0;
(b) an+2 − a + n + 1 − an = 0;
(c) an+3 + 3an+2 + 3an+1 + an = 0.
3. Найти общее решение системы рекуррентных соотношений

an+1 = bn + 5,
bn+1 = −an + 3.
4. Решить рекуррентные соотношения:
(a) an+2 − 2an+1 + 2an = 2n , a0 = 1, a1 = 2;
(b) an+2 + an+1 − 2an = n, a0 = 1, a1 = −2;
(c) an+2 − 4an+1 + 2an = 2n , a0 = 1, a1 = 2;
(d) an+2 + an+1 − 6an = 5 · 2n+1 , a0 = 2, a1 = 1.
5. Пользуясь аппаратом производящих функций, вывести формулу суммы кубов первых n натуральных чисел.

34

ГЛАВА 1. КОМБИНАТОРИКА

1.3

Простейшие перечислительные задачи

Вводные замечания. В этом параграфе рассматриваются задачи, представляющие собой нахождение числа классов
эквивалентности комбинаторных конфигураций. Чтобы пояснить это, рассмотрим пример. Найдем число раскрасок
граней куба в два разных цвета (например, в белый и черный): всего (не учитывая симметрий куба) их 26 = 64. Теперь
отождествим раскраски, получающиеся друг из друга поворотами куба. Тогда все различные раскраски описываются в
следующем списке:
1. все грани белые (1 раскраска),
2. одна грань белая, остальные — черные (1 раскраска),
3. две грани белые, четыре — черные (2 раскраски: в одной белые грани имеют общее ребро, а в другой не имеют),
4. три грани белые, три — черные (2 раскраски: в одной белые грани имеют общую вершину, а в другой не имеют),
5. четыре грани белые, две — черные (2 раскраски: в одной черные грани имеют общее ребро, а в другой не имеют),
6. пять граней белых, одна — черная (1 раскраска),
7. все грани черные (1 раскраска).
Таким образом, всего 10 классов эквивалентности и столько же соответствующих им неэквивалентных раскрасок.
Чтобы обосновать многие из последующих рассуждений, сформулируем и докажем следующую теорему.
Теорема 1.6 (Кэли). Любая конечная группа G изоморфна некоторой подходящей подгруппе симметрической группы Sn .
 Док-во. Пусть |G| = n; G = {g0 = e, g1 , . . . , gn−1 }. Для любого g ∈ G рассмотрим подстановку


g0
g1
...
gn−1
gb =
g · g0 g · g1 . . . g · gn−1
b ⊆ Sn . Действительно,
Она является инъективным отображением G → G
g · gi = g · g j =⇒ g−1 · g · gi = g−1 · g · g j =⇒ gi = g j .
Таким образом, отображение gb является перестановкой, а, следовательно, и взаимно однозначным. Осталось провеb выполняется равенство gb1 · gb2 = g\
b
рить только, что в G
1 · g2 ∀ g1 , g2 , то есть G — группа. Действительно, пусть


g0
... y ...
gn−1
g1 ↔ gb1 =
,
g1 · g0 . . . z . . . g1 · gn−1


g0
... x ...
gn−1
g2 ↔ gb2 =
,
g2 · g0 . . . y . . . g2 · gn−1


g0
...
gn−1
g1 · g2 ↔ g\
.
1 · g2 =
(g1 · g2 ) · g0 . . . (g1 · g2 ) · gn−1
Тогда согласно определению композиции перестановок
gb1 · gb2 (x) = gb1 (gb2 (x)) = gb1 (y) = z,
g\
1 · g2 (x) = (g1 · g2 ) (x) = g1 (g2 · x) = g1 · y = z.
b установлено взаимно однозначное отображение, сохраняющее внутренний закон компоТаким образом, между G и G
зиции, то есть изоморфизм.

Построенное в теореме 1.6 представление конечной группы называется левым регулярным представлением Кэли.
Правое регулярное представление, которое может быть построено по аналогии, называется антиизоморфизмом.
Теорема 1.7 (Лагранж). Пусть G = {α0 = e, α1 , . . . , αn−1 } — некоторая конечная группа, а множество H =
{β0 = e, β1 , . . . , βm−1 } ⊆ G — ее подгруппа (m 6 n). Тогда m | n.
 Док-во. Обозначив S0 = H, γ0 = e, рассмотрим множество G \ S0 . Если оно пусто, то теорема выполнена, в противном случае выбираем из него произвольный элемент γ1 .
S0 γ0 = e :
S1
γ1 :
S2
γ2 :
.........
Sk
γk :

β0 ,
γ1 β 0 ,
γ2 β 0 ,
.....
γk β 0 ,

β1 ,
γ1 β 1 ,
γ2 β 1 ,
.....
γk β 1 ,

...,
...,
...,
....
...,

βm−1
γ1 βm−1
γ2 βm−1
......
γk βm−1

(1.70)

35

1.3. ПРОСТЕЙШИЕ ПЕРЕЧИСЛИТЕЛЬНЫЕ ЗАДАЧИ


Обозначим S1 = γ1 βi , ∀ i = 0, m − 1 . Среди них нет одинаковых и S0 ∩ S1 = ∅: действительно, если γ1 βi = γ1 β j ⇒ βi =
β j ⇒ i = j (домножением справа на γ1−1 ), а если γ1 βi = β j ⇒ γ1 = β j βi−1 ∈ H. Если (G \ S0 ) \ S1 = ∅, то теорема доказана:
порядок группы равен удвоенному порядку подгруппы. В противном случае выбираем произвольный γ2 ∈ (G \ S0 ) \ S1 и
повторяем те же рассуждения. На k-ом шаге мы получаем набор Sk = {γk β0 , γk β1 , . . . , γk βm−1 }, причем все элементы в
нем различны и не встречались во множествах Si , ∀ i = 0, k − 1. Действительно пусть ` < k и
γk βi = γ` β j ⇒ γk = γ` β j βi−1 = γ` βr ∈ S` ,
| {z }
∈H

но γk выбиралось из дополнения S` . Остановка этого процесса может произойти только в случае
(· · · ((G \ S0 ) \ S1 ) \ · · · ) \ Sm = ∅,
но тогда ` · m = n, где m — порядок H, что и требовалось доказать.



Основные леммы.
Определение 1.3.1. Индексом подгруппы H группы G называется число
[G : H] =

|G|
.
|H|

Пусть N = {1, 2, . . . , n}, G — подгруппа Sn . Введем следующее бинарное отношение на элементах множества N:
a ∼ b (mod G) ⇐⇒ ∃ π ∈ G : π (a) = b.
Легко проверить, что оно удовлетворяет аксиомам
1. рефлексивности:
π = e ∈ G =⇒ a ∼ a (mod G),
2. симметричности:
π ∈ G ⇐⇒ π −1 ∈ G =⇒ a ∼ b (mod G) ⇐⇒ b ∼ a (mod G),
3. транзитивности:
π1 , π2 ∈ G =⇒ π1 · π2 = π ∈ G =⇒ (a ∼ b (mod G)) & (b ∼ c (mod G)) =⇒ a ∼ c (mod G).
Иными словами, оно является отношением эквивалентности. Оно разбивает исходное множество N на классы эквивалентности. В двух крайних случаях G = Sn и G = {e} соответственно все элементы эквивалентны и никакие два не
являются эквивалентными.
Определение 1.3.2. Орбитой элемента a ∈ N называется множество
Oa = {b ∈ N | a ∼ b (mod G)} .
Так как класс эквивалентности порождается любым своим представителем, допустимо обозначать через Oa орбиту
произвольного элемента a ∈ N. Найдем ее. Пусть G = {α0 = e, α1 , . . . , αr−1 }, r = ` · m. Тогда среди элементов e (a) =
α0 (a) , α1 (a) , . . . , αr−1 (a) могут быть повторы, но среди них содержатся все элементы, эквивалентные a и только они.
То есть, множество этих элементов и составляет Oa . Далее, a ∼ b (mod G) ⇔ Oa = Ob ⇒ |Oa | = |Ob |.
Определение 1.3.3. Стабилизатором элемента a называется множество элементов
Ga = {αi ∈ G | α i (a) = a} .
Легко проверить, что Ga — подгруппа G.
Утверждение 1.3.1.
[G : Ga ] = |Oa |

(|Ga | |Oa | = |G|) .

 Док-во. Пусть Ga = {β0 = e, β1 , . . . , βm−1 }. Покажем, что среди элементов (1.70) не встречается одинаковых. Этим
мы и покажем, что мощность орбиты является индексом стабилизатора.
S0 γ0 = e :
S1
γ1 :
S2
γ2 :
.........
Sk
γk :
.........
S`
γ` :

β0 ,
γ1 β 0 ,
γ2 β 0 ,
.....
γk β 0 ,
.....
γ` β0 ,

β1 ,
γ1 β 1 ,
γ2 β 1 ,
.....
γk β1 ,
.....
γ` β1 ,

...,
...,
...,
....
...,
....
...,

βm−1
γ1 βm−1
γ2 βm−1
......
γk βm−1
......
γ` βm−1

e (a)
γ1 (a)
γ2 (a)
.....
γk (a)
.....
γ` (a)

36

ГЛАВА 1. КОМБИНАТОРИКА

Пусть i > 1, k > s > 1. Тогда
γi β j (a) = βs (a) = a =⇒ γi βi ∈ Ga =⇒ γi ∈ Ga
γk β j (a) = γs β j (a) =⇒ γk (a) = γs (a) =⇒ ∃ β ∈ Ga :

γs−1 γk

(противоречие)

= β =⇒ k = s

(противоречие.)

Таким образом, действительно, Oa = ` + 1.



Если a ∼ b (mod G), то |Ga | = |Gb | и между стабилизаторами этих двух элементов можно установить изоморфизм.
Действительно, пусть π (a) = b, g ∈ Ga . Тогда πgπ −1 ∈ Gb .
Лемма 1.3.1 (Бернсайд). Пусть N (G) — число орбит по группе G. Тогда
N (G) =

1
∑ λ1 (π) ,
|G| π∈G

где λ1 (π) — число неподвижных элементов перестановки π (первая координата вектора типа перестановки).
 Док-во. Рассмотрим таблицу из нулей и единиц, строки которой соответствуют элементам N, а столбцы — перестановкам из G.
Z G
NZ
π0
........
πm−1
|G1 |
1
1
........
...
|G2 |
2
1
........
...
..
..
.
...
... 0 ...
...
.
..
..
.
...
... 1 ...
...
.
|Gn |
n
1
........
...
λ1 (π0 ) . . . . . . . . λ1 (πm−1 )
Элемент этой таблицы ti j для i = 1, n, j = 0, m − 1 определяется по следующему правилу:
(
0, π j (i) 6= i,
ti j =
1, π j (i) = i.
Число единиц в i-ой строке есть порядок стабилизатора элемента i, а число единиц в j-ом столбце есть число неподвижных элементов j-ой перестановки. Обозначим через O i орбиту i-го класса эквивалентности для i = 1, N (G). Далее,
в силу того, что мощности стабилизаторов эквивалентных элементов равны, а также того, что |Ga | |Oa | = |G| получаем,
n

a | + · · · + |Ga | + |Gb | + · · · + |Gb | + · · · + |Gc | + · · · + |Gc | = |G| · N (G)
∑ λ1 (π) = ∑ |Gi | = |G
|
{z
} |
{z
}
|
{z
}

π∈G

i=1

O1

O2

O N(G)

=⇒ N (G) =
где a из первого класса эквивалентности, b — из второго, c — из N (G)-го.

1
∑ λ1 (π) ,
|G| π∈G


Введем на N весовую функцию ω : N → R такую, что a ∼ b (mod G) ⇒ ω (a) = ω (b). Весом орбиты назовем вес ее
произвольного представителя: W (Oa ) = ω (a). Тогда справедлива следующая лемма.
Лемма 1.3.2 (Бернсайд, весовой вид).
N(G)

∑W

j=1


1
Oj =
∑ ∑ ω (a) .
|G| π∈G
a=π(a)

 Док-во. Рассмотрим таблицу весов, аналогичную используемой в лемме 1.3.1.
Z G
π0
NZ
1
ω (1)
2
ω (2)
.........
n
ω (n)

. . . πm−1
...
...
...
...
.........
...
...

|G1 |
|G2 |
....
|Gn |

37

1.3. ПРОСТЕЙШИЕ ПЕРЕЧИСЛИТЕЛЬНЫЕ ЗАДАЧИ

Элементы этой таблицы определяются по правилу: wi j = ω (π j (i)) для i = 1, n, j = 0, m − 1. Отметим, что если i — неподвижный элемент перестановки π j , то wi j = ω (i). Воспользуемся теперь тем же приемом: перейдем от суммы по всем
элементам к сумме по классам эквивалентности. Внутри каждого класса эквивалентности веса элементов одинаковы и
равны весу орбиты, но каждый такой элемент участвует в сумме |G| раз, так как (далее a — элемент из первой орбиты,
b — из последней)

∑ ∑

n

π∈G a:a=π(a)

ω (a) = ∑

∑

i=1 π:π(i)=i

n

n

i=1

i=1

ω (i) = ∑ ω (i) ] {π ∈ G : π (i) = i} = ∑ ω (i) |Gi | =

ω (1) + · · · + ω (1) + ω (2) + · · · + ω (2) + · · · + ω (n) + · · · + ω (n) =
{z
} |
{z
}
|
{z
}
|
|G1 |

|G2 |

|Gn |

N(G)







W O 1 + · · · +W O 1 + · · · +W O N(G) + · · · +W O N(G) = |G| ∑ W O j
{z
}
|
j=1
|
{z
}
∑ |Gi |=|O 1 ||Ga |=|G|
N(G) ||G |=|G|
|G
|=
O
∑
|
i
b
i∈O 1
i∈O N(G)

N(G)

=⇒

∑W

j=1


1
Oj =
∑ ∑ ω (a) ,
|G| π∈G
a=π(a)

что и требовалось доказать.



Лемма 1.3.3 (Бернсайд, ограниченная форма). Пусть N 0 — некоторое подмножество множества N. Если
определить эквивалентность в ограниченной форме:
a ∼0 b (mod G) ⇐⇒ a ∼ b (mod G) & a, b ∈ N 0 ,
то число орбит по группе G на множестве N 0 равно


1
N G| N 0 =
λ1 π | N 0 ,
∑
|G| π∈G

где λ1 π | N 0 — число петель перестановки π на множестве N 0 .
 Док-во. Аналогично основной лемме 1.3.1 с тем лишь отличием, что рассуждения проводятся для части орбит.



Теорема Пойа. Обозначим N = {1, . . . , n} — множество вершин, M = {1, . . . , m} — множество красок. Функции вида
f : N → M будем называть раскрасками множества N в цвета из M. Их множество — map (N, M) с числом элементов
] map (N, M) = mn . Для некоторой подгруппы G ⊆ Sn будем называть раскраски f и g эквивалентными и обозначать
f ∼ g (mod G) ⇐⇒ ∃ π ∈ G : ∀x ∈ N ⇒ f (π (x)) = g (x) .
Определение 1.3.4. Цикловым индексом группы перестановок G будем называть многочлен
Z (G; x1 , . . . , xn ) =

1
λ (π) λ (π)
λ (π)
∑ x11 x22 · · · xnn ,
|G| π∈G

где λ (π) = (λ1 (π) , λ2 (π) , . . . , λn (π)) — тип перестановки π.
В примере 5 рассмотрено значение Z (G; k, . . . , k) циклового индекса групп вращений и вращений с отражениями для
простого p. В общем виде они выглядят для простых p следующим образом:

1 p
x1 + (p − 1) x p ,
p


p−1
1
p
2
Z (G; x1 , . . . , x p ) =
x + (p − 1) x p + px1 x2
,
p 1
Z (G; x1 , . . . , x p ) =

для группы вращений;
для группы вращений с отражениями.

Установим изоморфизм между элементами π ∈ G и перестановками Smn . Определим для начала раскраске f и перестановке π функцию f π по следующему правилу: ∀ j = π (i) ⇒ f π ( j) = f (i). Легко убедиться, что такое соответствие
инъективно: действительно, если
f1 → f1π , f2 → f2π

и

f1π ( j) = f2π ( j) ∀ j = 1, n =⇒ f1 (i) = f2 (i) ∀ i = π −1 ( j) .

Так поставим в соответствие группе G некоторое множество раскрасок { f π }. При этом перестановке π ставится в
b Легко видеть, что это соответствие изоморфно (поэтому
соответствие некоторая другая перестановка раскрасок πb ∈ G.

38

ГЛАВА 1. КОМБИНАТОРИКА



−1 , e
b симметрической группы Smn ), так как (πb)−1 = πd
b а
b — единичный элемент в G,
можно говорить о подгруппе G
π\
2 · π1 = πb2 · πb1 . Осталось показать, что это соответствие взаимно однозначно: пусть G 3 π1 6= π2 ∈ G, а π1 , π2 порождают
соответственно πb1 , πb2 . Тогда ∃ i : j = π1 (i) 6= π2 (i) = k. Рассмотрим раскраску, окрашивающую i-ый элемент в первый
цвет, а все остальные во второй. Тогда πb1 окрасит все элементы, кроме j-го в первый цвет, а j-ый элемент во второй,
а πb2 все элементы, кроме k-го окрасит в первый цвет, а k-ый элемент во второй. Следовательно, πb1 , πb2 — разные
b установлен изоморфизм.
перестановки раскрасок. Таким образом, можно окончательно утверждать, что между G и G
Теорема 1.8 (Пойа, упрощенный вид). Число орбит раскрасок по группе G (подгруппе Sn ) равно значению
циклового индекса Z (G; m, m, · · · , m).
 Док-во. Заметим предварительно, что в силу изоморфизма
f1 ∼ f2

b ⇐⇒ f1 ∼ f2
(mod G)

(mod G).

b
Пусть F = {F1 , . . . , Ft } — множество орбит. Тогда по лемме Бернсайда 1.3.1 и в силу изоморфизма групп G и G
1
b
G

t=

∑ ∑

1=

b f =b
π( f )
πb∈G

1
∑ mλ1 (π) mλ2 (π) · · · mλn (π) = Z (G; m, m, . . . , m) .
|G| π∈G

Последнее равенство вытекает из того, что петля в перестановке группы G при изоморфно переходит в окрашивание
b
всех циклов в один цвет раскраской группы G

Пусть W = {w1 , . . . , wr } — множество цветов. Введем все окрасок ω : M → K (W ), то есть ω (i) = wi . Весом раскраски
будем называть произведение весов ее цветов:
ω ( f ) = ∏ ω ( f (i)) .
i∈N

Очевидно, что f1 ∼ f2 (mod G) ⇒ ω ( f1 ) = ω ( f2 ):
ω ( f2 ) = ∏ ω ( f2 (i)) = ∏ ω ( f1 (π (i))) = ∏ ω ( f1 (i)) = ω ( f1 ) .
i∈N

i∈N

i∈N

По аналогии с обычными группами перестановок, весом орбиты назовем вес любой ее раскраски: W (Fi ) = ω ( f ) ∀ f ∈ Fi .
Теорема 1.9 (Пойа).

∑

F∈F

m

m

m

i=1

i=1

i=1

!

W (F) = Z G; ∑ ω (i) , ∑ ω 2 (i) , . . . , ∑ ω n (i) .

 Док-во. Пусть W = {W1 , . . . ,Wr } — множество всех возможных весов раскрасок (весов орбит), r 6 mn . Тогда

∑

F∈F

r

W (F) = ∑ Wi
i=1

=

∑

F∈F
W (F)=Wi

1
b
G

r

1 = ∑ Wi ·
i=1

1
b
G

∑ ∑
b
πb∈G

1

F∈F
W (F)=Wi

∑ (ω (1) + · · · + ω (m))λ1

λ
ω 2 (1) + · · · + ω 2 (m) 2 · · · (ω n (1) + · · · + ω n (m))λn

π∈G
m

m

m

i=1

i=1

i=1

!

= Z G; ∑ ω (i) , ∑ ω 2 (i) , . . . , ∑ ω n (i) .
Последнее равенство вытекает из того, что петля в перестановке группы G при изоморфно переходит в окрашивание
b
всех циклов в один цвет раскраской группы G

В дальнейшем под витражом будем понимать прозрачную прямоугольник, разлинованный квадратами, которые
могут быть окрашены в цвета. При этом окраска квадрата с двух сторон одинаковая. По пластиной будем понимать
непрозрачный (двусторонний) прямоугольник, разлинованный квадратами, которые могут быть окрашены в цвета с
обеих сторон независимо друг от друга.
Примеры.
1. Найти число орбит на множестве S = {a, b, c, d} по группе



G = aa bb cc dd , ab ba cc dd ,

ab c d
abd c



,

ab c d
bad c



.

39

1.3. ПРОСТЕЙШИЕ ПЕРЕЧИСЛИТЕЛЬНЫЕ ЗАДАЧИ

 Решение. Нетрудно проверить, что G — группа. Действительно, первый ее элемент является единицей, оставшиеся три являются сами себе обратными, композицией второго и третьего является четвертый, второго и четвертого — третий, третьего и четвертого — второй. Легко видеть, что орбитами здесь являются лишь два множества:
{a, b} и {c, d}. Согласно лемме 1.3.1 число орбит равно
N (G) =

1
(4 + 2 + 2 + 0) = 2.
4


2. Найти число орбит на множестве {a, b, c, d, e, f , g, h} по группе.
n



G = eb = aa bb cc dd ee ff gg hh , π = π −1 = ab ba dc
 Решение. По лемме 1.3.1, очевидно,
N (G) =

d e f gh
c f e gh

o

.

1
(8 + 4) = 6
2


3. Найти число различных вершинных раскрасок треугольников в два цвета (используется модель "ожерелья", то
есть орбиты определяются по группе вращений).
 Решение. Здесь легко представить себе все эти раскраски:
1
2a
3
4
5a
6
7a
8a
A
A
A
A
A
A
A
A
 A  A  Aa a A  Aa a Aa a A a Aa
(обведены вершины, раскрашенные в один цвет, отличный от цвета необведенных). Группа вращений в данном
случае содержит три перестановки: тождественную и вращения на углы 2pi/3 и 4π/3:


G = eb = 11 22 33 44 55 66 77 88 = [1] [2] · · · [8] ,

π = 11 23 34 42 56 67 75 88 = [234] [567] [1] [8] ,

π −1 = π 2 = 11 24 32 43 57 65 76 88 = [423] [756] [1] [8] .
Таким образом, по лемме 1.3.1
1
(8 + 2 + 2) = 4.
3
Действительно, неэквивалентными раскрасками являются, например, раскраски 1, 2, 5, 8.
N (G) =



4. Найти число различных вершинных раскрасок правильного пятиугольника в три цвета по группе вращений и по
группе вращений и симметрий.
 Док-во. Группа вращений в данном случае состоит из пяти перестановок: тождественной, которая оставляет
все раскраски неподвижными, и поворотов на π · n/5, где n = 2, 4, 6, 8, которые оставляют неподвижными лишь
одноцветные раскраски (потому что 5 — простое число). Тогда по лемме 1.3.1
N (G) =

 255
1 5
3 +3+3+3+3 =
= 51.
5
5

Добавляя также симметрии, имеем еще пять перестановок, соответствующих каждой из пяти осей симметрии,
каждая из которых сохраняет 33 раскрасок.
1`
#c
#
#
c
#
5#
`
L
L
L
L`
4

c
c` 2

`
3

40

ГЛАВА 1. КОМБИНАТОРИКА
Действительно, можно выбрать любой цвет для вершины, через которую проходит ось, а также два любых цвета
для вершин, лежащих по одну сторону от оси. В этом случае
N (G) =

 390
1  5
3 + 3 + 3 + 3 + 3 + 33 + 33 + 33 + 33 + 33 =
= 39.
10
10


5. Найти число различных вершинных раскрасок правильного p-угольника, где p — простое в k цветов, отождествляя раскраски, получающиеся друг из друга вращениями и вращениями с симметриями.
 Решение. Группа вращений будет состоять из p перестановок, из которых одна (единичная) сохраняет все k p
раскрасок, а остальные (p − 1 различных поворотов, совмещающих вершины) в силу простоты p сохраняют лишь
одноцветные раскраски. Таким образом, число раскрасок по группе вращений равно для простого числа вершин
N (G) =

1 p
(k + (p − 1) k) .
p

Группа симметрий будет содержать p перестановок (для начал пусть p — нечетное), каждая из которых соответствует оси, проходящей через выделенную вершину (в силу простоты p все оси различны). Каждая симметрия
сохраняет раскраски, у которых выделенная вершина имеет произвольный цвет, а оставшиеся p−1
2 вершин, ле,
лежащих
по
другую
сторону
жащих по одну сторону от оси определяют однозначно раскраску оставшихся p−1
2
оси, то есть в этом случае

p+1
1  p
k + (p − 1) k + p · k 2 .
N (G) =
2p
В случае четного простого p = 2 симметрий наблюдаться не будет, поэтому
N (G) =

1 k (k + 1)
=
,
2
2

также, как и по группе вращений.



6. Найти число различных вершинных раскрасок правильного шестиугольника в 2 цвета, отождествляя раскраски,
получающиеся друг из друга сначала только вращениями, а затем вращениями с симметриями.
 Решение. Группа вращений будет содержать 6 перестановок, где единичная сохраняет все 26 раскрасок, повороты на π/3 и 5π/3 сохраняют только одноцветные раскраски (так как 1 и 5 взаимно просты с числом вершин 6),
повороты на 2π/3 и 4π/3 сохраняет четыре раскраски (четные вершины раскрашены в один цвет, а нечетные —
в другой), поворот на π сохраняет восемь раскрасок (противоположные вершины окрашены в один цвет). Таким
образом, в случае группы вращений
N (G) =

 84
1 6
2 + 2 · 2 + 2 · 22 + 23 =
= 14.
6
6

Группа симметрий содержит шесть перестановок (3 оси, проходящие через две противоположные вершины и 3
оси через середины противоположных ребер). Симметрии, соответствующие осям, проходящим через вершины,
сохраняют 24 раскрасок (две вершины на оси и две вершины по одну сторону оси произвольны), а симметрии, соответствующие осям, проходящим через середины ребер, сохраняют 23 раскрасок (три вершины по одну сторону
оси определяют однозначно остальные). В случае вращений с симметриями
N (G) =

 156
1  6
2 + 2 · 2 + 2 · 22 + 23 + 3 · 24 + 3 · 23 =
= 13.
12
12


7. Найти цикловой индекс групп вращений вершин и ребер тетраэдра.
 Решение. Группы вращений вершин и ребер тетраэдра содержат по 12 перестановок: тождественную, восемь
перестановок, отвечающих выбору одной из четырех осей, проходящих через одну из вершин и середину противоположной грани, а затем вращения вершин тетраэдра на 2π/3 и 4π/3, а также три перестановки, отвечающие

1.3. ПРОСТЕЙШИЕ ПЕРЕЧИСЛИТЕЛЬНЫЕ ЗАДАЧИ

41

выбору одной из трех осей, проходящих через середины противоположных ребер, а затем вращения вершин тетраэдра на π.

A
 A

A

A

A
H
A
`
HH
H
Рассмотрим случай вращения вершин. Тождественная перестановка образует 4 цикла единичной длины. Каждое
вращение вокруг оси, проходящей через вершину, образует одну петлю и один цикл длины 3, а вращения вокруг
реберных осей образуют два цикла длины 2. Таким образом,

1 4
Z (GV ; x1 , x2 , x3 , x4 ) =
x1 + 8x1 x3 + 3x22 .
12
В случае вращения ребер тождественная перестановка образует шесть петель, вращения вокруг вершинных осей
образуют по два цикла длины 3, а вращения вокруг реберных осей — две петли и два цикла длины 2. Таким
образом,

1  6
Z (GE ; x1 , x2 , x3 , x4 , x5 , x6 ) =
x1 + 8x32 + 3x12 x22 .
12

8. Найти вес орбит раскрасок граней куба по группе вращений в два цвета с весами 1, x.
 Решение. Группа вращений и симметрий состоит из 24 перестановок: тождественной, трех поворотов на π
вокруг прямых, соединяющих центры противоположных граней, шести поворотов на π/2 вокруг прямых, соединяющих центры противоположных граней, шести поворотов на π вокруг прямых, соединяющих середины противоположных ребер и восьми поворотов на 2π/3 вокруг прямых, соединяющих противоположные вершины. Они
образуют соответственное число циклов: восемь петель, две петли и два цикла длины 2, две петли и один цикл
длины 4, три цикла длины 2 и два цикла длины 3. Соответственно цикловой индекс группы вращений равен

1  6
Z (G; x1 , x2 , x3 , x4 , x5 , x6 ) =
x1 + 3x12 x22 + 6x12 x4 + 6x23 + 8x32 .
24
Вес раскраски по теореме Пойа 1.9 равен

Z G; 1 + x, 1 + x2 , 1 + x3 , 1 + x4
2

3
2 
1 
=
(1 + x)6 + 3 (1 + x)2 1 + x2 + 6 (1 + x)2 1 + x4 + 6 1 + x2 + 8 1 + x3
24
= 1 + x + 2x2 + 2x3 + 2x4 + x5 + x6 .

9. Найти вес раскрасок пирамиды из 10 шариков (основание составляют шесть шариков, сложенных в виде правильного треугольника, поверх них лежат, касаясь друг друга еще три, пирамиду замыкает десятый, лежащий на
трех верхних) по группе вращений в два цвета с весами 1, x.
 Решение. Группа вращений здесь совпадает с группой вращений тетраэдра. При этом тождественная перестановка образует 10 петель, вращения вокруг вершинных осей образуют одну петлю и три цикла длины 3, а
вращения вокруг реберных осей — две петли и четыре цикла длины 2. Таким образом,

1 10
x1 + 8x1 x33 + 3x12 x24 .
Z (G, x1 , . . . , x10 ) =
12
Вес раскраски по теореме Пойа 1.9 равен

Z G, 1 + x, 1 + x2 , 1 + x3
3
4 
1 
(1 + x)10 + 8 (1 + x) 1 + x3 + 3 (1 + x)2 1 + x2
=
12
= 1 + 2x + 5x2 + 14x3 + 22x4 + 24x5 + 22x6 + 14x7 + 5x8 + 2x9 + x10 .


42

ГЛАВА 1. КОМБИНАТОРИКА

10. Найти вес орбит по группе вращений и симметрий раскрасок витража 2 × 2 в три цвета с весами 1, x, y.
 Решение. Группа вращений содержит 8 перестановок: тождественную, образующую 4 петли, вращения на π/2
и 3π/2, образующие один цикл длины 4, вращение на π, образующее два цикла длины 2, две симметрии относительно диагоналей, образующие две петли и один цикл длины 2, а также две симметрии относительно осей,
проходящих через середины противоположных ребер, образующие по два цикла длины 2. Таким образом,
Z (G; x1 , x2 , x3 , x4 ) =


1 4
x + 2x4 + 3x22 + 2x12 x2 .
8 1

Вес раскраски по теореме Пойа 1.9 равен

Z G; 1 + x + y, 1 + x2 + y2 , 1 + x3 + y3 , 1 + x4 + y4

2

1
=
(1 + x + y)4 + 2 1 + x4 + y4 + 3 1 + x2 + y2 + 2 (1 + x + y)2 1 + x2 + y2
8
= 1 + x + y + 2x2 + 2xy + 2y2 + x3 + 2x2 y + 2xy2 + y3 + x4 + x3 y + 2x2 y2 + xy3 + y4 .

Упражнения.
1. Найти цикловой индекс группы вращения вершин куба.
2. Найти цикловой индекс группы вращения ребер куба.
3. Найти цикловой индекс группы вращения вершин октаэдра.
4. Найти цикловой индекс группы вращения ребер октаэдра.
5. Найти цикловой индекс группы вращения граней октаэдра.
6. Найти цикловой индекс группы вращения витража.
7. Найти цикловой индекс группы вращения пластины.

1.4

Частично упорядоченные множества

Основные понятия. В параграфе, посвященном бинарным отношениям, уже вводилось понятие частично упорядоченного множества, и рассматривался пример (N, 6). Напомним, что частично упорядоченным множество называется
пара
(P, 6) ,
где P — некоторое множество, а 6 — бинарное отношение частичного порядка, то есть бинарное отношение, удовлетворяющее аксиомам рефлексивности, транзитивности и антисимметричности:
1. для любого x ∈ P выполняется xρ x;
2. для любых x, y, z ∈ P выполняется xρ y & yρ z ⇒ xρ z;
3. для любых x, y ∈ P выполняется xρ y & yρ x ⇒ x = y.
Если вдобавок выполняется еще и ∀ x, y ∈ P ⇒ x 6 y ∨ y 6 x, то пара (P, 6) называется вполне упорядоченным множеством. Если же это не верно, то элементы, для которых x y & y x, будем называть несравнимыми и обозначать
x ⊃⊂ y. Введем также уточняющие знаки: если x 6 y, x 6= y, то x < y. Введем также очень важное в дальнейшем понятие
интервала: это множество
[x, y] = {z ∈ P | x 6 z 6 y} .
В случае [x, y] = {x, y} и x 6= y, будем говорить о непосредственном предшествовании x l y. В терминах диаграммы Хассе
это означает, что между x и y есть дуга.
Важным примером частичного порядка является множество всех подмножеств булева куба Bn , упорядоченных по
включению (Bn , ⊆). Он изоморфен множеству всех (2n ) подмножеств конечного n-элементного множества, упорядоченных по включению, а также множеству всех наборов из нулей и единиц длины n, упорядоченных лексикографически
при 1 > 0.
Определение 1.4.1. Частичным порядком, двойственным к частичному порядку (P, 6) называется частичный
порядок (P, 61 ), где x 61 y ⇔ y 6 x. В дальнейшем, определяя что-то для частичного порядка (P, 6) по двойственности, будем подразумевать, что определяется то же самое, но для частичного порядка (P, 61 ).

43

1.4. ЧАСТИЧНО УПОРЯДОЧЕННЫЕ МНОЖЕСТВА

Определение 1.4.2. Элемент частично упорядоченного множества (P, 6), называется минимальным, если @ y ∈ P :
y < x. Иными словами, ∀ y ∈ P ⇒ x < y ∨ x ⊃⊂ y. По двойственности определяется понятие максимального элемента.
Заметим, что минимального элемента может и не быть, а в случае существования минимальных элементов, их может
быть несколько.
`
`
`
I
@
6
6
@
I
@
@
@
@
@
@
`
@`
@`
(1.71)
Так, например, на рисунке (1.71) все элементы нижнего слоя являются минимальными.
Определение 1.4.3. Элемент z частично упорядоченного множества (P, 6), называется наименьшим (нулем), если
∀ x ∈ P : z < x. По двойственности определяется понятие наибольшего элемента (единицы).
Заметим, что наименьший элемент (если он есть) является минимальным. Также, если минимальный элемент существует, то он единственен. На диаграмме Хассе (1.71) нет наименьшего элемента.
Определение 1.4.4. Подмножество Q ⊆ P частично упорядоченного множества (P, 6) называется цепью, если любые
два элемента из Q сравнимы.
Определение 1.4.5. Подмножество Q ⊆ P частично упорядоченного множества (P, 6) называется антицепью, если
любые два элемента из Q не сравнимы.
Сформулируем теперь условие на частично упорядоченные множества, с которыми мы в дальнейшем будем работать.
Цепное условие Жордана-Дедекинда. Каждый интервал конечен и длины максимальной неуплотняемой цепи между любыми двумя элементами одна и та же.
Это условие определяет так называемые ранжированные частично упорядоченные множества. Сразу оговоримся, что существуют множества, на которых ввести функцию ранга невозможно — неранжированные, такие, как
пентагон:
I`
J
]
J
`
J
6
J`

`
I@
@
@`
0
Пусть частично упорядоченное множество удовлетворяет условию Жордана-Дедекинда и имеет наименьший элемент
0. Тогда можно по индукции определить функцию ранга:
1. rank (0) = 0;
2. a l b =⇒ rank (a) + 1 = rank (b).
На содержательном уровне, такое множество должно иметь слои.
2 `
2 `
2 `
`
@ @
6
I
6
I
6

6
@ @
`
@
`
@
`
1
1
1
1 `
I
@

I
@
@
@
@
`
@1 `
1
2

1

`



Так, например, частично упорядоченное множество натуральных чисел по делимости ранжируемо: для любого числа
s

n = pα1 1 · · · pαs s функция ранга равна rank n = ∑ αi . Заметим при этом, что мощность интервала [1, n] = m m|n равна
s

i=1



∏ (1 + αi ), а интервал [m, n] изоморфен интервалу 1, mn . Если множество ранжируемо, то любой его слой является
i=1
антицепью.
Определение 1.4.6. Длина цепи от нуля до единицы (если оба элемента существуют) называется длиной множества.
Определение 1.4.7. Наибольшая длина антицепи называется шириной множества.

44

ГЛАВА 1. КОМБИНАТОРИКА

Уже изучавшееся в параграфе 1.2 частично упорядоченное множество (неупорядоченных) разбиений конечного
множества, упорядоченное по подразбиениям, носит название Беллиана, а диаграммы Хассе, соответствующие этим
частичным порядкам называются диаграммами Юнга. Соответственно диаграммы Хассе, соответствующие частично
упорядоченным по подразбиениям множествам упорядоченных разбиений, называются графами Феррера.
Введем ряд операций над частичными порядками. Пусть имеются два частично упорядоченных множества (P, 6P ) и
(Q, 6Q ) , P ∩ Q = ∅.
Определение 1.4.8. Суммой (объединением) частичных порядков P и Q называется частично упорядоченное
множество P ∪ Q, 6 такое, что
1. a, b ∈ P =⇒ a 6 b ⇔ a 6P b;
2. a, b ∈ Q =⇒ a 6 b ⇔ a 6Q b;
3. a ∈ P, b ∈ Q =⇒ a ⊃⊂ b.
Определение 1.4.9. Декартовым произведением частичных порядков P и Q называется частично упорядоченное
множество (P × Q, 6) такое, что
a1 , a2 ∈ P, b1 , b2 ∈ Q =⇒ (a1 , a2 ) 6 (b1 , b2 ) ⇔ a1 6P a2 , b1 6Q b2 .
Примером декартова произведения может случить произведение цепей C2 и C3 .
` (2, 3)
`
C3 3
C2 ×C3
@
` (2, 2) @` (1, 3)
C2
@
@
2`
2`
` (2, 1) @` (1, 2) @` (0, 3)
@
@
` (2, 0) @` (1, 1) @` (0, 2)
1`
1`
@
@
@` (1, 0) @` (0, 1)
@
0`
@` (0, 0)
0`
В частном случае C1 = B, а Bn — n-мерный булев куб — можно трактовать как частично упорядоченное множество
n-ой декартовой степени цепи C1 .
e 6 βe и расРассмотрим n-мерный
единичный куб Bn , на
задан описанный выше частичный порядок. Если α


h котором
i
e , βe = k, то интервал α
e , βe является гранью этого куба размерности k. Ее можно обозначать
стояние Хэмминга ρ α
e и βe совпадают hсохраним,
следующим образом: те n − k разрядов, в которых наборы α
а оставшиеся — те, в которых
i
e
e
e , β = (α1 , . . . , −, . . . ), при этом первая
e стоят нули, а в наборе β стоят единицы, заменим прочерками: α
в наборе α
компонента с прочерком называется направлением грани. В качестве еще одного примера рассмотрим частично упорядоченное множество Γ, состоящее из трех элементов.
Γ
`
0

−`
@
@`
1

;

`
0

(−, −)
`
−`
!2
(−, 0) `
(−, 1) `
(0,
` −) (1,
` −)
@
=
HH H

H
@`
H H

1
`(0, 1)` HH
` HH
`
(0, 0)
(1, 0)
(1, 1)

Таким образом, легко видеть, что Γ2 представляет собой частично упорядоченное множество граней двумерного куба по
включению. По аналогии можно заявить, что Γn является частичным порядком также по включению граней n-мерного
единичного куба.
Определение 1.4.10. Отображение ϕ : P → Q называется монотонным (изотонным), если
∀ a, b ∈ P : a 6P b =⇒ ϕ (a) 6Q ϕ (b) .
Примерами монотонных отображения являются монотонные функции алгебры логики.
Определение 1.4.11. Пусть S — множество всех монотонных отображений P → Q (иногда пишут S = QP ). Тогда кардинальной степенью частично упорядоченных множеств P и Q называется частично упорядоченное множество
(S, 6) такое, что
∀ϕ1 , ϕ2 ∈ S =⇒ ϕ1 6 ϕ2 ⇔ ∀ a ∈ P : ϕ1 (a) 6Q ϕ2 (a) .

45

1.4. ЧАСТИЧНО УПОРЯДОЧЕННЫЕ МНОЖЕСТВА

В качестве примера построим кардинальную степень двух цепей: C2C2 . Чтобы представить все монотонные функции,
отображающие C2 в C2 , перейдем к их представлению векторами длины 3: (a, b, c) : a 6 b 6 c, a, b, c ∈ {0, 1, 2}. Частичный
порядок этих векторов представлен на диаграмме Хассе:
`

(2, 2, 2)

(1, 1, 2)

(1, 1, 1)

(0, 1, 1)

` (1, 2, 2)
@
`
@`(0, 2, 2)
H
H
H
`
H
`(0, 1, 2)



`
`(0, 0, 2)
@
@` (0, 0, 1)
`

(0, 0, 0)

Этот частичный порядок изоморфен множеству векторов из нулей и единиц длины 5, упорядоченных по перестановке
единиц справа налево. В дальнейшем при изучении решеток станет ясен комбинаторный смысл этой аналогии.
Определение 1.4.12. Пусть C1 , . . . ,Cn суть цепи частично упорядоченного множества (P, 6). Будем говорить, что они
образуют покрытие
этого частично упорядоченного множества, если Ci 6= ∅, i = 1, n, для любых 1 6 i < j 6 n ⇒
Sn
Ci ∩C j = ∅,
C
= P.
i
i=1
Очевидно, что для любого частичного порядка всегда существует покрытие: достаточно рассмотреть тривиальное
— каждый элемент объявить цепью. Справедливо утверждение о том, что число цепей в покрытии не может быть меньше ширины множества. Действительно, ширина множества равна наибольшей длине антицепи, но все элементы в ней
несравнимы, следовательно, никакие два не могут находится в одной цепи покрытия. Таким образом, каждый элемент
наибольшей антицепи должен содержаться в своей отдельной цепи покрытия. Справедливо и обратное неравенство.
Теорема 1.10 (Дилуорс). Пусть (P, 6) — конечное частично упорядоченное множество. Тогда его ширина
равна минимальному числу цепей, его покрывающих.
 Док-во. Проведем индукцию по числу элементов в P. Базис индукции (случай |P| = 1) очевиден. Пусть теорема
справедлива при |P| 6 k, то есть частично упорядоченное множество, содержащее не более k элементов можно покрыть цепями, число которых равно ширине P. Докажем случай |P| = k + 1. Возьмем произвольный элемент a ∈ P и
рассмотрим другой носитель P∗ = P \ {a}. Возможно два случая:
1. Ширина частично упорядоченного множества (P∗ , 6) меньше ширины исходного множества, то есть не превосходит k. Тогда по индуктивному предположению существует покрытие (P∗ , 6) не более, чем k цепями, добавив к
которым цепь, состоящую из единственного элемента a, получим покрытие (P, 6) не более, чем k + 1 цепями, что
и требовалось доказать.
2. Ширина частично упорядоченного множества (P∗ , 6) равна ширине (P, 6). В этом случае разобьем P∗ относительно a на три части:
U = {b ∈ P | a < b} ,

L = {b ∈ P | b < a} ,

C1 C2 C3

Ci

U

Ui

P∗ N

Ni

L

Li

N = {b ∈ P | a ⊃⊂ b} .

Cn−1 Cn

a

По транзитивности каждый элемент из L предшествует любому элементу из U. В дальнейшем n — ширина частично упорядоченного множества P∗ . По индуктивному предположению существуют n цепей C1 , . . . ,Cn , покрывающих
P∗ . Разобьем каждую цепь также на три части: Ci = Ui ∪ Ni ∪ Li , где Ui = U ∩Ci , Ni = N ∩Ci , Li = L ∩Ci , ∀ i = 1, n.
Возможно два подслучая:
(a) ∃ i ∈ [1, n] ∩ N : Ni = ∅. В этом случае уплотним цепь Ci элементом a, при этом получим покрытие n цепями
множества (P, 6). Таким образом, построено покрытие цепями, число которых равно ширине множества, что
и утверждалось в теореме.

46

ГЛАВА 1. КОМБИНАТОРИКА
(b) ∀ i = 1, n Ni 6= ∅. Прежде чем перейти к рассмотрению следующих двух подслучаев заметим, что любая цепь
покрытия целиком лежит либо в U ∪ N, либо в L ∪ N (докажите).
i. Если найдется номер j такой, что частично упорядоченное множество (P∗ \U j , 6) имеет ширину, меньшую n, то искомым покрытием является покрытие (P∗ \U j , 6), объединенное с цепью U j ∪ {a}. Аналогичен случай, когда найдется номер ` такой, что частично упорядоченное множество (P∗ \ L` , 6) имеет
ширину, меньшую n. Таким образом, и в этом случае искомое покрытие существует.
ii. Не ограничивая общности рассуждений, будем считать, что все цепи лежат в U ∩ N. Предположим,
при удалении любого Ui , i = 1, n ширина множества сохраняется. В это случае для любого i множество (U ∪ N) \ Ui имеет ширину n, а его максимальной антицепью является цепь Ai длины n, причем на
каждой из цепей C j присутствует один элемент каждой антицепи Ai , ∀ i = 1, n. Важно, что один из элементов каждойSантицепи находится на Ni : Ai ∩ Ni 6= ∅, ∀ i = 1, n. Рассмотрим объединение всех таких
антицепей A = ni=1 Ai . В цепях Ui ∪ Ni выбираем наименьший элемент из A ∩ (Ui ∪ Ni ) — ai ∈ Ni . Утверждается, что A∗ = {a1 , . . . , an } — антицепь. Доказательство от противного: пусть ∃ b, c ∈ A∗ , b < c. Если
b ∈ As , то возьмем d ∈ As — элемент, лежащий на той же цепи, что и c но выше (так как c наименьший
из элементов As , лежащих на той же цепи). Тогда по транзитивности c < d ⇒ b < d, что противоречит
тому, что As антицепь. Таким образом, в P∗ антицепью является A∗ , а в P — A∗ ∪ {a}, что противоречит
предположению о том, что ширина P равна ширине P∗ и равна n.

Теорема доказана.



Цепи Анселя. Рассмотрим единичный n-мерный куб Bn с традиционным частичным порядком. Обозначим Bnk =

e ∈ Bn : kα
e k = k} — k-ый слой для k = 0, n. Очевидно, для любого k слой Bnk является антицепью длины Bnk = nk .
{α

n
Покажем, что последовательность Bnk = ak k=0 монотонно убывает. Действительно,
n 
ak+1
n−k
k+1
= n =
ak
k+1
k
монотонно убывает. Покажем, что в случае четного n последовательность {ak }nk=0 является унимодальной, а в случае
нечетного — два серединных элемента последовательности являются максимальными. Действительно, если n = 2m, то
n−k
n−k
> 1, k > m ⇒
<1
k<m⇒
k+1
k+1
   
  

 
n
n
n
n
n
<
< ··· <
>
> ··· >
.
0
1
m
m+1
n
Если же n = 2m + 1, то
n−k
n−k
n−k
k<m⇒
> 1, k = m ⇒
= 1, k > m ⇒
<1
k+1
k+1
k+1
   

   
 

 
n
n
n
n
n
n
n
<
< ··· <
<
=
>
> ··· >
.
0
1
m−1
m
m+1
m+2
n

В любом случае можно утверждать, что ширина Bn не меньше, чем b nn c . Покажем, что в действительности справед2

ливо равенство: ширина Bn в точности равна b nn c . Для этого проведем следующую цепочку рассуждений: в n-мерном
2
единичном кубе существует ровно n! максимальных цепей из e
0вe
1. Это вытекает из того, что число путей из нуля в
единицу равно числу способов упорядоченной расстановки n единиц по n позициям (замена каждого нуля единицей
добавляет ребро к уже существующей цепи, а всего ребер — n). Аналогично, число максимальных цепей из e
0вe
1,
e : kα
e k = k равно k! (n − k)!. Используя эти факты, рассмотрим произвольную
проходящих через заданную вершину α
e1 , . . . , α
es }, причем kα
ei k = ki , i = 1, s. Всего различных цепей, проходящих через A
антицепь A = {α
k1 ! (n − k1 )! + k2 ! (n − k2 )! + · · · + ks ! (n − ks )! 6 n!
Отсюда имеем

s

∑

1

n  6 1, в то же время

i=1 ki

s

∑

1

n >

i=1 ki



n



=⇒
s
6
,
n
n
2
b n2 c
s

e` не лежит в среднем (в случае четного n) или в двух средних (в случае нечетного n) слоях,
причем, если хотя бы одно α

то неравенство будет строгим. Таким образом, помимо того, что показано равенство ширины n-мерного куба b nn c ,
2
еще и указан общий вид максимальных антицепей. В случае четного n максимальная антицепь всего одна — n2 -ый
слой. Случай нечетного n = 2m + 1 требует особого рассмотрения. Очевидно, что если хотя бы один элемент антицепи
лежит вне двух средних слоев, то данная антицепь не будет максимальной. Предположим, что максимальная антицепь

47

1.4. ЧАСТИЧНО УПОРЯДОЧЕННЫЕ МНОЖЕСТВА


n 
принадлежит одновременно обоим средним слоям: A = X ∪Y, X ⊂ Bnm+1 , Y ⊂ Bnm , причем X,Y 6= ∅. Так как mn = m+1
,
двудольный граф, долями которого являются Bnm+1 и Bnm , а ребрами — все ребра, соединяющие эти же слои в Bn , будет
однородным (каждой вершине инцидентно одинаковое число ребер). Для множества X рассмотрим его тень:
n
o
e ∈ Bnm ∃ βe ∈ X : α
e < βe .
P (X) = α
Очевидно, что число ребер, соединяющих множество X со своей тенью не превосходит числа ребер, соединяющих P (X)
с верхней долей:
|X| · (m + 1) 6 |P (X)| · (m + 1) =⇒ |X| 6 |P (X)| ,
причем равенство достигается только в том случае, когда X совпадает со всем слоем, иными словами, в случае X Bnm+1
верно строгое неравенство |X| < |P (X)|. Но Y = Bnm \ P (X) и |Y | < Bnm+1 \ X , следовательно, A не является максимальной антицепью, так как |A| < |Bnm |. Таким образом,по доказанному
в случае нечетного n единичный куб Bn содержит
n
n
всего две максимальные антицепи: соответственно 2 -ый и 2 -ый слои.
Единичный n-мерный куб является ранжированным частично упорядоченным множеством. Как оказалось, ширина
Bn совпадает с мощностью наибольшего слоя. Такие ранжированные частично упорядоченные множества называются
шпернеровыми. Рассмотрим еще один пример шпернерова множества.
Ранее было обозначено через Γn частично упорядоченное по включению множество граней n-мерного единичного
куба. Также было показано, что всего граней 3n . Проведем ту же цепочку рассуждений, что и в случае Bn . Единицей в
этом частичном порядке является тривиальная грань Bn , а вот нуля здесь нет: минимальными являются 2n элементов,
являющихся также тривиальными гранями, состоящими из одной вершины каждая. Всего в Γn существует 2n n! максимальных антицепей (спускаясь по частичному порядку, на k-ом шаге выбираем одну из (n − k + 1) ранее невыбранных
координат и одним из двух способов заменяем ее либо на 0, либо на 1). Всего
k-мерных граней nk 2n−k , так как их число
n
равно количеству способов выбора k степеней свободы из n возможных ( k способов), в каждом из которых возможны
все допустимые значения фиксированных n − k координат (2n−k вариантов). Всего цепей, проходящих через выбранную
грань размерности k равно 2k k! (n − k)!, так как их количество равно числу способов упорядоченного открывания n − k
фиксированных координат ((n − k)! способов), после каждого из которых возможны все 2k k! цепей до минимальных
элементов.

Покажем унимодальность последовательности чисел {bk }nk=0 k-мерных граней: bk = nk 2n−k . Действительно,
n  n−k−1
k+1 2
n n−k
k 2

bk+1
=
bk

=

1 n−k
·
2 k+1

монотонно убывает. Пусть n > 3. Тогда
n−1
bk+1
⇒
< 1.
3
bk
n
n
Отсюда три случая: если n ≡ 2 (mod 3), то наибольший
 n слоев два: слой 3 -мерных и 3 -мерных граней; если же
n 6≡ 2 (mod 3), то наибольший
  слой один: множество 3 -мерный граней. В дальнейшем нам понадобится лишь тот
факт, что в любом случае 3n -ый слой является максимальным.

n
Найдем ширину множества Γn . Очевидно, она не меньше, чем ширина наибольшего слоя, то есть b nn c · 2n−b 3 c .
3
e1 , . . . , α
es }, причем размерность грани
Покажем точное равенство. Для этого рассмотрим произвольную антицепь A = {α
ei равна ki для i = 1, s. Количество максимальных цепей, проходящих через элементы A, не превосходит общего числа
α
максимальных цепей в Γn :
k<

n−1
bk+1
⇒
> 1,
3
bk

k=

n−1
bk+1
⇒
= 1,
3
bk

k>

2k1 k1 ! (n − k1 )! + 2k2 k2 ! (n − k2 )! + · · · + 2ks ks ! (n − ks )! 6 n!2n .
Отсюда имеем
s

∑

1
n  n−ki 6 1, в то же время
ki 2

s

∑

1
n  n−ki >
ki 2

s




n
n


2n−b 3 c .
=⇒ s 6
n

n  n−b 3n c
3
b n3 c 2
 
 
Отсюда
видно, что если хотя бы один элемент антицепи лежит вне 3n -ого слоя в случае n 6≡ 2 (mod 3) (вне n3 -ого и
n
3 -ого слоев в случае n ≡ 2 (mod 3)), то антицепь не будет максимальной, так как будет выполняться соответствую 2n
щее строгое неравенство. Итак, Γn является также шпернеровым множеством и его ширина равна b nn c 2d 3 e .
3
Рассмотрим частично упорядоченное множество Bn . Булевой функцией, заданной на нем называется любое отображение Bn → B1 . Монотонной булевой функцией, заданной на Bn называется любая булева функция f , удовлетворяющая
импликации
 
e 6 βe =⇒ f (α
e ) 6 f βe .
α
i=1

i=1

48

ГЛАВА 1. КОМБИНАТОРИКА

Нас будет интересовать вопрос о числе таких отображений как о функции, зависящей от n. В дальнейшем условимся
обозначать ее через ψ (n). В случае n = 0 все функции монотонны (так как они суть константы 0 и 1): ψ (0) = 2. При
n = 1 немонотонной является лишь отрицание, так что ψ (n) = 3. В дальнейшем n > 2. Для начал получим
тривиальную

n

нижнюю оценку на число монотонных функций для n > 2. Для этого рассмотрим в Bn два слоя: n2 -ый
и
 n  2 + 1 -ый.
Определим семейство монотонных функций Φ = Φ1 ∪ Φ2 следующим
образом: на всех слоях выше 2 + 1 -го опреn
делим все функции
равными
единице,
а
на
всех
слоях
ниже
-го
определим
2
 
 
 их равными нулю. Все функции из Φ1
равны нулю на n2 -ом слое и определены произвольным образом на n2 + 1 -ом — всего таких столько же, сколько

( nn )
существует способов определить функцию на b n cn +1 наборах, то есть 2 b 2 c+1 . Все функции из Φ1 наоборот: равны
2
 

 
единице на n2 + 1 -ом слое и определены произвольным образом на 2n -ом — всего таких столько же, сколько су
( nn )
ществует способов определить функцию на b nn c наборах, то есть 2 b 2 c . Очевидно, что пересечение Φ1 ∩ Φ2 содержит
2 
 

лишь одну функцию: равную нулю вплоть до 2n -го слоя, и равную единице, начиная с n2 + 1 -ого слоя. Учитывая
то, что все остальные функции в Φ1 и Φ2 различны, получена нижняя оценка на число булевых монотонных функций:
( nn )
( nn )
ψ (n) > 2 b 2 c + 2 b 2 c+1 − 1.
Следующая, интересующая нас задача — это расшифровка монотонной булевой функции. Известно, что некоторая
функция f : Bn → B является монотонной. Требуется ее расшифровать, то есть определить ее значения на всех вершинах Bn . При этом разрешается задавать вопросы вида: чему равна функция на данном наборе. Нас будет интересовать
наименьшее число вопросов как функция от n. Договоримся в дальнейшем обозначать ее ϕ (n). Для получения нижней
оценки на эту функцию воспользуемся семейством функций Φ, построенным
приполучении нижней оценки на число

монотонных булевых функций: если задано вопросов меньше, чем b nn c + b n cn +1 , то заведомо найдется вершина на
2
2
одном из выделенных средних слоев, на котором значение функции не спрашивалось. В этом случае двумя монотонными функциями, неразличимыми таким тестом будут функции из Φ, различные лишь на вершине, на которой значение не
спрашивалось. Таким образом,
 


n
n
.
ϕ (n) >  n  +  n 
2
2 +1

Теорема 1.11 (Ансель). Bn может быть покрыт b nn c максимальными цепями со следующими свойствами:
2
n

n 
1. число цепей длины n − 2p + 1 для p = 0, 2 равно np − p−1
,
2. в наименьшей вершине цепи длины n − 2p + 1 как в наборе из нулей единиц содержится в точности p
единиц и n − p нулей, а в наибольшей — n − p единиц и p нулей,
3. для любых наборов α1 l α2 l α3 на цепи длины n − 2p + 1
α1 = ( . . . 0 . . . 0 . . . )
α2 = ( . . . 0 . . . 1 . . . )
α3 = ( . . . 1 . . . 1 . . . )
их относительное дополнение до квадрата α:
α = ( ... 1 ... 0 ... )
лежит на цепи длины n − 2p − 1.
Замечание. Из пункта 1 видно, что все цепи имеют длину одной и той же четности, причем в случае нечетного n все
цепи имеют четную длину, а в случае четного n — нечетную.
 Док-во. Проведем индукцию по n. Для n = 0 теорема, очевидно верна.
à
Покрытие состоит всего из одной цепи, для которой пункты 1, 2 и 3 тривиальны. Для n = 1 утверждения также выполняются:
a` 1

a` 0

49

1.4. ЧАСТИЧНО УПОРЯДОЧЕННЫЕ МНОЖЕСТВА

Покрытие содержит единственную цепь, для которой проверка условий 1, 2, 3 также не вызывает затруднений. Такие
тривиальные цепи, образующие покрытия B0 и B1 называются цепями Анселя. Более интересны случаи n = 2 и n = 3,
на которых можно наглядно продемонстрировать индуктивный переход.
Пусть n = 2. Куб B2 получается соединением всех вершин одномерного куба B110 с одноименными вершинами одномерного куба B211 , при этом все вершины B210 получают метки, начинающиеся нулем, а все вершины, принадлежавшие
B211 получают метки, начинающиеся единицей. Рассмотрим в B210 и в B211 уже построенные на предыдущем шаге их
покрытия цепями Анселя.
B2
B211
B2
B211
à 10
à 10
@
@
@
@
à 01
@
à 01
@
11 à
11 à
@
@
@
@
@
@
00 à
00 à
B210

B210

Разрываем цепь в B211 и соединяем ее бывший максимальный элемент с максимальным элементом цепи покрытия B210 .
В случае n = 3 алгоритм действий аналогичный. Куб B3 получается соединением всех вершин двумерного куба B210
с одноименными вершинами одномерного куба B311 , при этом все вершины B310 получают метки, начинающиеся нулем,
а все вершины, принадлежавшие B311 получают метки, начинающиеся единицей. Рассмотрим в B310 и в B311 уже построенные на предыдущем шаге их покрытия цепями Анселя.
B3

B3

31
1

B
à 111
@
@
a` 101 110
@a`

`a 011
@
@
a` 001 010
@a`

a`

B311
à 111
@
@
a` 101 110
@a`

a` 011
@
@
a` 001 010
@a`

-

100

a`

100

à

à

000

000

B310

B310

Снова отрываем от каждой цепи в B311 максимальный элемент и делаем его максимальным соответствующей цепи B310 .
Теперь мы можем формализовать индуктивный переход. Пусть существует способ покрывать Bn цепями Анселя,
при котором выполняются условия 1, 2 и 3. Тогда искомое покрытие для Bn+1 строится следующим образом: от каждой
цепи в Bn+111 отрывается максимальный элемент и присоединяется к соответствующей цепи в Bn+110 . При этом длины
всех цепей в Bn+111 увеличиваются на единицу, а длины всех цепей в Bn+110 уменьшаются на единицу (цепи длины 1 в
Bn+110 исчезают).
Bn+1
`a

Bn10

a`

a`

`a

a`

`a

a`

a`

Bn+111
a`

a`

a`

a`

a`

a`

Проверим, удовлетворяет ли такое покрытие условиям теоремы:

n 
1. Цепи длины (n + 1) − 2p + 1 получаются из цепей длины n − 2p + 1, лежащих в грани Bn10 (всего их np − p−1
)


n
n
удлинением на единицу и из цепей длины n − 2 (p − 1) + 1, лежащих в грани Bn11 (всего их p−1
− p−2
) укороче

n 
n+1 
нием на единицу. Итого, цепей такой длины ровно np − p−2
= n+1
p − p−1 .
2. Возможны два тривиальных подслучая:
(a) цепь получена удлинением соответствующей из Bn10 . Тогда число нулей в наименьшей вершине увеличилось
на единицу (из-за появившегося первого разряда), число единиц в ней сохранилось, а число единиц в наибольшей вершине увеличилось на единицу (тоже из-за первого разряда), в то время как число нулей в ней
сохранилось. Таким образом, условие выполняется.

50

ГЛАВА 1. КОМБИНАТОРИКА
(b) Цепь получена укорочением соответствующей из Bn11 . Тогда число нулей в минимальной вершине цепи сохранилось, число единиц в ней же увеличилось из-за появившегося первого разряда, а число единиц в максимальной вершине осталось прежним (так как одна единица добавилась первым разрядом, но бывшая
максимальная вершина удалена, поэтому новая лежит уровнем ниже, следовательно, в младших разрядах
содержит на одну единицу меньше), в то время как число нулей в максимальной вершине увеличилось на
единицу (из-за спуска ее на один уровень вниз). Таким образом, и в этом случае условие сохраняется.
3. Берем три вершины с одной цепи, идущие подряд. Возможны два случая.
(a) Они взяты с укороченной цепи. Тогда, поскольку при индуктивном построении они были взяты с цепи Bn11
длины на единицу больше, их дополнение до квадрата лежит (по индуктивному предположению) также в Bn11
на цепи длины на 2 меньше (по индуктивному предположению соответствующая цепь, содержавшая нужное
дополнение до квадрата, имела длину на 2 больше до отщепления максимальных элементов с каждой цепи,
но после отщепления, как легко видеть, баланс длин сохранился).
(b) Они взяты с удлиненной цепи. Возможны два подслучая.
i. Все три вершины лежат в Bn10 . В этом случае по индуктивному предположению их дополнение до квадрата также находится в Bn10 , причем оно лежит на цепи длины на 2 меньше (по индуктивному предположению соответствующая цепь, содержавшая нужное дополнение до квадрата, имела длину на 2 меньше
до добавления максимальных элементов к каждой цепи из Bn11 , но после их добавления, как легко видеть, баланс длин сохранился).
ii. Большая из этих трех вершин лежит в Bn10 . Тогда дополнением до квадрата, как легко видеть, будет
служить максимальная вершина соответствующей укороченной цепи.
Bn+1
`ca

Bn10

`ac

ca`

`a

a`

`a

a`

`ac

Bn+111
a`

a`

`a

a`

a`

`a

Поскольку при индуктивном построении сначала обе цепи были одной длины, а затем первая из них
стала на одну вершину длиннее, а вторая — на одну вершину короче, то условие и в этом случае выполняется.
Теорема доказана.



Используя теорему Анселя можно получить верхнюю оценку на число монотонных булевых функций ψ (n). Действительно, покроем Bn цепями Анселя. Рассмотрим все цепи Анселя наименьшей длины (это либо 1, либо 2). Определим на них не более, чем тремя способами монотонную функцию. Затем, возьмем на больших цепях (длины n − 2p + 1)
три наименьшие вершины. Зная значения на всех цепях длины, не более, чем n − 2 (p + 1) + 1 по монотонности дополним их до квадрата и определим на них снова не более, чем тремя способами монотонную функцию. При этом, на всех
вершинах, кроме двух функция определится однозначно, а на оставшихся останется как раз ровно три варианта. Таким
образом, суммируя полученные результаты относительно ψ (n), можно утверждать, что
( nn )
( nn )
( nn )
2 b 2 c + 2 b 2 c+1 − 1 6 ψ (n) 6 3 b 2 c .
Также можно показать, что ранее полученная нижняя оценка на сложность расшифровки монотонной булевой
функции ϕ (n) совпадает с верхней оценкой. Действительно, в случае нечетного n сначала узнаем значения на цепях
длины 2 (при этом зададим не более, чем по два вопроса на каждую цепь). Затем, используя снова продолжения до
квадрата, узнаем значения на цепях большей длины (при этом зададим снова не более чем по два вопроса для каждой
цепи). Итак, для нечетного случая

 
 

n
n
n
ϕ (n) 6 2 ·  n  =  n  +  n 
.
2
2
2 +1
В четном случае узнаем сначала значения функции на цепях длины 1, задав по одному вопросу для каждой цепи. Затем,
для цепей большей длины узнаем значения не более, чем на двух вершинах, используя продолжения до квадрата. Таким
образом, и в этом случае ϕ (n) не превосходит своей нижней оценки:
  


   
   

n
n
n
n
n
n
n
ϕ (n) 6 1 ·
−
+
2
·
=
+
=
+
.
n
n
n
n
n
n
n
2
2 −1
2 −1
2
2 −1
2
2 +1

51

1.4. ЧАСТИЧНО УПОРЯДОЧЕННЫЕ МНОЖЕСТВА
Итак, окончательно можно утверждать, что


 

n
n




+ n
.
ϕ (n) =
n
2
2 +1
Алгебры инцидентности. Частичный порядок (P, 6) будем называть локально конечным, если любой интервал
конечен. Пусть в дальнейшем F — некоторое бесконечное поле.
Определение 1.4.13. Алгеброй инцидентности частично упорядоченного множества (P, 6) называется множество

A (P) = f : P2 → F x y ⇒ f (x, y) = 0 .
Алгебра инцидентности замкнута относительно операции сложения:
( f + g) (x, y) = f (x, y) + g (x, y) ,
операции умножения на число r ∈ F:
(r · f ) (x, y) = r · f (x, y) ,
а также операции свертки
( f ? g) (x, y) =

∑

f (x, z) · g (z, y) .

x6z6y

Нейтральным элементом по сложению является функция, тождественно равная нулю и очевидным образом принадлежащая алгебре инцидентности. Свертка ассоциативна: f ? (g ? h) = ( f ? g) ? h. Действительно,

( f ? (g ? h)) (x, y) =

∑

f (x, z) · (g ? h) (z, y) =

x6z6y

=

∑

x6z6y

∑ ∑

∑

f (x, z)

∑

x6w6y

g (z, w) · h (w, y)

z6w6y

f (x, z) · g (z, w) · h (w, y) =

x6z6y z6w6y

=

!

∑ ∑

f (x, z) · g (z, w) · h (w, y)

x6w6y x6z6y

∑

!
f (x, z) · g (z, w) · h (w, y) =

x6z6w

∑

( f ? g) (x, w) · h (w, y) = (( f ? g) ? h) (x, y) .

x6w6y

В то же время операция некоммутативна. Действительно, пусть
x l y, f (x, x) = f (x, y) = 0, f (y, y) = e, g (x, y) = a, где a ∈ F, e 6= 0.
Тогда
( f ? g) (x, y) = f (x, x) · g (x, y) + f (x, y) · g (y, y) = 0,
(g ? f ) (x, y) = g (x, x) · f (x, y) + g (x, y) · f (y, y) = a2 6= 0.
Последнее равенство вытекает из того, что в поле нет делителей нуля.
Из определения свертки легко видеть, что она дистрибутивна относительно сложения:
( f + g) ? h = f ? h + g ? h,
f ? (g + h) = f ? g + f ? h.
Нейтральной функцией по свертке будет дельта-функция: ∀ f ∈ A (P) ⇒ f ? δ = δ ? f = f , где
(
1, x = y,
δ (x, y) =
0, иначе.
Иногда можно говорить об обратных элементах по свертке fΛ−1 и fΠ−1 (соответственно левом и правом обратных элементах), если fΛ−1 ? f = δ и f ? fΠ−1 = δ . Не всякий элемент алгебры инцидентности имеет обратный, однако если он все
же существует, то левый обратный совпадает с правым обратным элементом:


fΛ−1 = fΛ−1 ? δ = fΛ−1 ? f ? fΠ−1 = fΛ−1 ? f ? fΠ−1 = δ ? fΠ−1 = fΠ−1 .
Теорема 1.12. Элемент f ∈ A (P) обратим тогда и только тогда, когда для любого x ∈ P выполняется f (x, x) 6=
0.

52

ГЛАВА 1. КОМБИНАТОРИКА

 Док-во. Необходимость в данном случае очевидна: если f ∈ A (P) обратим, то
f −1 (x, x) · f (x, x) = 1
по определению операции свертки и дельта-функции. Поскольку в поле нет делителей нуля, для любого x ∈ P выполняется f (x, x) 6= 0.
Покажем достаточность. Для этого определим для функции f обратную явным образом. Если x y, очевидно, опре1
делим f −1 (x, y) = 0. Поскольку для любого x выполняется f −1 (x, x)· f (x, x) = 1 и f (x, x) 6= 0, определим f −1 (x, x) = f (x,x)
.
Пусть теперь x < y и для любого z ∈ [x, y) обратная функция f −1 (x, z) уже определена. Тогда по определению свертки

∑

f −1 (x, z) · f (z, y) = δ (x, y) = 0 =⇒ f −1 (x, y) = −

x6z6y

1
∑ f −1 (x, z) · f (z, y) .
f (y, y) x6z<y

Попутно доказано, что обратный элемент, если он существует, единственен.
Теорема доказана.



Перечислим теперь наиболее важные функции алгебра инцидентности.
(
1, x = y,
1. δ (x, y) =
0, иначе.
(
1, x 6 y,
2. ζ (x, y) =
— дзета-функция.
0, иначе
(
1, x = y, x l y,
3. λ (x, y) =
— лямбда-функция.
0, иначе
(
1, x < y,
4. η (x, y) = ζ (x, y) − δ (x, y) =
— эта-фунция.
0, иначе
(
1, x l y,
5. κ (x, y) = λ (x, y) − δ (x, y) =
— каппа-функция.
0, иначе
6. µ (x, y) = ζ −1 (x, y) — функция Мебиуса.
7. ` (x, y) — длина максимальной (x, y)-цепи.
Введем понятие монотонной нумерации частичного порядка. Нумерацией частично упорядоченного множества
(P, 6) называется отображение n : P → N. Нумерация называется монотонной, если из p1 6 p2 следует n (p1 ) 6 n (p2 ).
Алгоритм монотонной нумерации произвольного конечного частичного порядка чрезвычайно прост: на первом шаге
выбираем произвольный минимальный элемент и нумеруем его единицей. Затем, на каждом последующем шаге выбираем элемент, ниже которого лежат только помеченные элементы, и нумеруем его следующим натуральным числом.
Очевидно, выполняется x < y ⇒ n (x) < n (y). Рассмотрим это на примере. Пусть P = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}, а отношение частичного порядка задается диаграммой Хассе, представленной на рисунке.
7a`
A

10a`
@
4 a`
A
 @a` 9
A 
Aa`
A6
a`
 A
a`
3@ 
8
A
@a`
Aa`
2@
5
@a`
1
Вершины частичного порядка пронумерованы, как легко проверить, монотонно. Важнейшим свойством монотонной
нумерации является то, что матрицы введенных нами ранее функций имеют верхний треугольный вид. Так например,

53

1.4. ЧАСТИЧНО УПОРЯДОЧЕННЫЕ МНОЖЕСТВА

матрица дзета-функции выглядит так (номера строк соответствуют номерам x, а номера столбцов — номерам y в монотонной нумерации):


1 1 1 1 1 1 1 1 1 1
0 1 1 1 0 1 1 0 0 1


0 0 1 1 0 0 1 0 0 0


0 0 0 1 0 0 1 0 0 0


0 0 0 0 1 1 1 1 1 1


ζ =

0 0 0 0 0 1 1 0 0 1
0 0 0 0 0 0 1 0 0 0


0 0 0 0 0 0 0 1 1 1


0 0 0 0 0 0 0 0 1 1
0 0 0 0 0 0 0 0 0 1
Также можно найти матрицу функции Мебиуса, которая также будет иметь верхний треугольный вид:


1 −1 0
0 −1 1
0
0
0
0
0 1 −1 0
0 −1 1
0
0
0


0 0
1 −1 0
0
0
0
0
0


0 0
0
1
0
0 −1 0
0
0


0 0
0
0
1 −1 0 −1 0
1


µ =
0
0
0
1 −1 0
0 −1
0 0

0 0
0
0
0
0
1
0
0
0


0 0
0
0
0
0
0
1 −1 0 


0 0
0
0
0
0
0
0
1 −1
0 0
0
0
0
0
0
0
0
1
Пусть частично упорядоченное множество (P, 6) локально конечно и имеет наименьший элемент. Пусть F : P → F
— некоторая функция, определенная на этом частичном порядке. Предположим, что вместо F известны значения
суммирующей функции:
SF (x) = ∑ F (y) .
y6x

Задача заключается в расшифровке исходной функции по известным значениям суммирующей функции. Задача решается следующим образом: введем новую функцию
(
F (z) , x = 0, y = z
f (x, y) =
0,
иначе.
Выполним свертку этой функции и дзета-функции:
SF (x, y) =

∑

f (x, z) · ζ (z, y) = ( f ? ζ ) (x, y) .

x6z6y

Очевидно, что SF (0, x) = SF (x). Поскольку дзета-функция обратима, и обратной к ней является функция Мебиуса,
можно выполнить следующую операцию, приводящую к обращению Мебиуса: f (x, y) = (SF ? µ) (x, y). Отсюда получаем основную формулу, определяющую значения F через значения суммирующей функции:
F (x) = f (0, x) =

∑ SF (0, y) · µ (y, x) = ∑ SF (y) · µ (y, x) .

y6x

y6x

Рассмотрим конечный алфавит {a1 , . . . , ar } , r > 2. Построим все rn слов над этим алфавитом длины n и разобьем
из на классы эквивалентности. Прежде всего определим понятие периода: слово (b1 , . . . , bn ) имеет период d|n, если для
любого i выполняется bi = bi+d (i + d (mod n)) и для любого d 0 < d это неверно. Классом эквивалентности является
множество слов, получающихся одно из другого циклическим сдвигом.
Рассмотрим пример: пусть r = 2, n = 4. Всего существует 16 слов длины 4 над двухбуквенным алфавитом (пусть это
{0, 1}). Два из них имеют период 1: это (0000) и (1111), два слова имеют период 2: это (0101) и (1010), остальные же
слова имеют период 3. Всего 6 классов эквивалентности:
(0000)
(1111)
(0101) , (1010)
(0001) , (1000) , (0100) , (0010)
(0011) , (1001) , (1100) , (0110)
(0111) , (1011) , (1101) , (1110)

54

ГЛАВА 1. КОМБИНАТОРИКА

Обозначим через M (d) число классов эквивалентности слов периода d. Так, для r = 2, n = 4 M (1) = 2, M (2) =
1, M (4) = 3. Нас будет интересовать вопрос, чему же равно M (n). В данном случае легко построить суммирующую
функцию, после чего можно выполнить обращение Мебиуса:
n
n
∑ d · M (d) = rn =⇒ M (n) · n = ∑ rd · µ (d, n) = ∑ rd · µ d = ∑ r d · µ (d) .
d|n
d|n
d|n
d|n
Отсюда получаем окончательную формулу
M (n) =

n
1
r d µ (d) .
n∑
d|n

Это число замечательно тем, что оно равно числу неприводимых нормированных многочленов степени n над Fp [x], если
только r = p — простое. Так, например, при r = 2
M (4) =


1 4
2 · 1 + 22 · (−1) + 21 · 0 = 3.
4

Решетки. Пусть (P, 6) — некоторое частично упорядоченное множество и X ⊆ P.
Определение 1.4.14. Верхней гранью множества X называется элемент (если он существует) a ∈ P такой, что
∀x ∈ X ⇒ x 6 a. По двойственности определяется нижняя грань множества X. Точной верхней гранью множества
X называется наименьшая из верхних граней supX (если такая существует). По двойственности определяется точная
нижняя грань inf X множества X.
Определение 1.4.15. Частично упорядоченное множество (P, 6) называется полной решеткой, если у любого множества X ⊆ P существуют sup X и inf X. Если у каждого X ⊆ P существует sup X, то (P, 6) называется верхней полурешеткой, если же у каждого X ⊆ P существует inf X, то (P, 6) называется нижней полурешеткой.
Определение 1.4.16. Частично упорядоченное множество (P, 6) называется решеткой, если у любых x, y ∈ P сущеdef

def

ствуют sup {x, y} = x ∨ y и inf {x, y} = x ∧ y.
Замечание. Если (P, 6) — решетка, то для любых x1 , . . . , xn ∈ P существуют
sup {x1 , . . . , xn } = x1 ∨ · · · ∨ xn

и

inf {x1 , . . . , xn } = x1 ∧ · · · ∧ xn .

Примером неполной решетки может выступать частично упорядоченное множество натуральных чисел по делимости (N, |). Легко видеть, что в нем множество X = N не имеет верхних граней вообще, следовательно, не имеет и точной
верхней грани.
Введенные выше обозначения точной верхней и точной нижней граней пар элементов решетки можно рассматривать как операцию над элементами исходного частичного порядка. Легко доказать, что выполняется простой закон
ассоциативности, например, для точной верхней грани:
(x ∨ y) ∨ z = x ∨ (y ∨ z) .
Действительно, пусть x ∨ y = a и b = a ∨ z. Предположим, что x ∨ (y ∨ z) = b1 < b. Но тогда x 6 b1 , y ∨ z 6 b1 ⇒ y 6 b1 ,
причем b1 является верхней гранью как для x, так и для y. Тогда a 6 b1 , но b 6 a, откуда получаем противоречие с
предположением b 6 b1 .
Решеткой является множество

M (d1 , . . . , dn ) = (x1 , . . . , xn ) 0 6 xi 6 di , xi , di ∈ Z, i = 1, n ,
причем (x1 , . . . , xn ) 6 (y1 , . . . , yn ) ⇔ xi 6 yi ∀ i = 1, n. Множество, состоящее из линейных подпространств пространства
R3 (начало координат, три координатных оси, три координатных плоскости и все R3 ) также представляет собой решетку, причем изоморфную B3 . Частично упорядоченное по включению множество всех подгрупп (включая тривиальные
— пустую и саму группу) некоторой конечной группы G является также решеткой. При этом точной верхней гранью
множества является наименьшая группа, содержащая все группы это множества, а точной нижней гранью — пересечение всех групп множества. Замкнутые классы функций k-значной логики (k > 2) также образуют решетку. По аналогии
с группой точной верхней гранью множества классов выступает наименьший класс, всех их содержащий, а точной
нижней гранью множества классов является их пересечение. При k = 2 решетка замкнутых классов в Pk называется
решеткой Поста.
Очевидным образом выполняются следующие пять свойств:
1. x ∧ x = x, x ∨ x = x — идемпотентность,
2. x ∧ y = y ∧ x, x ∨ y = y ∨ x — коммутативность,

55

1.4. ЧАСТИЧНО УПОРЯДОЧЕННЫЕ МНОЖЕСТВА
3. (x ∧ y) ∧ z = x ∧ (y ∧ z) , (x ∨ y) ∨ z = x ∨ (y ∨ z) — ассоциативность,
4. x ∧ (x ∨ y) = x ∨ (x ∧ y) = x — поглощение,
5. x ≤ y ⇐⇒ x = x ∧ y и y = x ∨ y — совместимость,
6. свойство дистрибутивности, которое, вообще говоря, выполняется не всегда:
(a) x ∧ (y ∨ z) = (x ∧ y) ∨ (x ∧ z) и
(b) x ∨ (y ∧ z) = (x ∨ y) ∧ (x ∨ z).

Таким образом, можно перейти к рассмотрению алгебры (P, ∨, ∧), соотносящейся с частичным порядком (P, 6) согласно
свойству 5.
Определение 1.4.17. Подрешеткой решетки (P, ∨, ∧) называется решетка (Q, ∨, wedge), где Q ⊆ P замкнутая относительно операций взятия точной верхней и точной нижней граней в исходной решетке (P, ∨, ∧).
Чтобы подчеркнуть важность последнего требования приведем пример решетки U, носитель которой является подмножеством решетки B3 , однако, U не является подрешеткой B3 согласно введенному определению.
v `c
@
@
@
x c`
y c`
z c`
@
@
@
@
@`
`
@`
inf {x, y} @
@
@c`
w
B3

U

v `c
@

x `c
y c`
@
@
@c`
w

@
@
z c`

Действительно, x, y ∈ U, но inf {x, y} ∈
/ U.
Примером множества, не являющегося решеткой служит частично упорядоченное множество, заданное диаграммой
Хассе: элементы x, y не имеют верхней грани вообще, а значит и точной верхней грани.
x `
@

y

`
@
@

@
@
`
@`

`
@
@`

Определение 1.4.18. Если для любых трех элементов x, y, z решетки выполняются условия 6a и 6b, то решетка называется дистрибутивной.
Примерами дистрибутивных решеток являются Bn , упорядоченный стандартным образом и (N, |). Примерами
недистрибутивных решеток являются пентагон и решетка U, рассмотренная в качестве контрпримера подрешетки.
v ∨` w
@

x ∨` z
A
y c`
A

x `c
@ 
@
`
y∧z

A
z A`c



u `c
@

@
@
v c`
w@c`
@
@
@`
u∧v = u∧w

Действительно, в пентагоне:
x ∨ (y ∧ z) = x 6= y = (x ∨ y) ∧ (x ∨ z) ,
в решетке U:
u ∧ (v ∨ w) = u 6= 0 = (u ∧ v) ∨ (u ∧ w) .
Справедлив некий аналог теоремы Понтрягина-Куратовского: решетка является дистрибутивной тогда и только тогда,
когда она не содержит в качестве подрешеток пентагона и U. Используя это утверждение, можно показать, например, что частично упорядоченное по подразбиениям множество разбиений конечного множества является решеткой,
которая не дистрибутивна, если только исходное множество содержит не менее трех элементов.

56

ГЛАВА 1. КОМБИНАТОРИКА

Любая решетка с конечным носителем является полной. Элемент p решетки L называется неприводимым, если
выполняется импликация
p = x ∨ y =⇒ p = x или p = y.
Исключим по определению из множества неприводимых элементов наименьший (несмотря на то, что вышеприведенная
импликация для него выполняется). На языке диаграмм Хассе из вершины, соответствующей неприводимому элементу,
выходит вниз не более одного ребра: в противном случае он являлся бы точной верхней гранью двух непосредственно
предшествующих ему элементов. Согласно определению любой элемент частично упорядоченного множества является
либо неприводимым, либо приводимым, поэтому для произвольного элемента a частично упорядоченного множества
допустимо представление его в виде точной верхней грани неприводимых элементов a = p1 ∨ p2 ∨ · · · ∨ ps . Если для
любого i = 1, s ⇒ a 6= p1 ∨ p2 ∨ · · · ∨ pi−1 ∨ pi+1 ∨ · · · ∨ ps , то такое разложение называется несократимым. В этом случае
очевидно, что множество неприводимых элементов {pi }si=1 образует антицепь. Разложением для нуля будем считать
сам нуль: 0 = 0.
Лемма 1.4.1. Пусть p — неприводимый элемент дистрибутивной решетки L и
p6

n
_

ai .

i=1

Тогда найдется такое 1 6 i 6 n, что p 6 ai .
 Док-во. Из условия ясно, что для p справедливо представление
!
p = p∧

n
_

ai

i=1

=

n
_

(p ∧ ai ) .

i=1

Поскольку все p ∧ ai 6 p, должно найтись такое i, что выполнится в точности равенство p ∧ ai = p. В этом случае по
определению точной нижней грани и выполнится p 6 ai .
Лемма доказана.

Лемма 1.4.2 (Биркгоф). Несократимое разложение на неприводимые элементы для любого элемента a ∈ L
(L — дистрибутивная решетка) однозначно с точностью до порядка неприводимых элементов, участвующих в разложении.
 Док-во. Пусть найдутся два несократимых разложения некоторого элемента a ∈ L на неприводимые элементы:
a = p1 ∨ p2 ∨ · · · ∨ ps = q1 ∨ q2 ∨ · · · ∨ qr .
Из вида разложений следует, что
∀ i = 1, s ⇒ pi 6 a =

r
_

qi =⇒ ∃ j : pi 6 q j ,

аналогично ∃ k : q j 6 pk =⇒ pi 6 q j 6 pk .

i=1

Учитывая то, что элементы несократимого разложения на неприводимые элементы лежат на антицепи, получим pi =
q j = pk . Проведя эти рассуждения сначала для всех pi , а затем для всех q j , убедимся, что оба разложения состоят из
одних и тех же неприводимых элементов и могут различаться лишь их порядком.
Лемма доказана.

Монотонная булева функция на частично упорядоченном множестве может быть задана следующим образом: выделяется произвольная максимальная по включению антицепь, выше которой функция определяется единицей, а на
ней и ниже — нулем. По двойственности можно определить антимонотонную функцию. Это определение понадобится
нам в дальнейшем при кодировании дистрибутивных решеток. Предварим это следующим примером. Пусть частично
упорядоченное множество задается диаграммой Хассе.
f
`c
e `
@

@
c `c
d c`
@
@
b c`
`
a

f
c`
@
c` c
@c` d
@
@c`
b

1.4. ЧАСТИЧНО УПОРЯДОЧЕННЫЕ МНОЖЕСТВА

57

Выделим из этого множества подмножество всех неприводимые элементов — в данном случае это {b, c, d, f }. Неприводимые элементы находятся между собой в отношении частичного порядка, определяющемся в свою очередь своей диаграммой Хассе, представленной справа. Новый частичный порядок, образованный неприводимыми элементами можно упорядоченным образом покрыть цепями. Сделать это можно разными способами: например, пользуясь теоремой
Дилуорса, покрыть числом цепей, равным ширине множества (в этом случае число цепей минимально), а можно тривиально: каждый неприводимый элемент объявить самостоятельной цепью (в этом случае число цепей максимально).
Пусть уже имеется упорядоченное покрытие цепями C1 , . . . ,Cn длин `1 , . . . , `n соответственно. Пронумеруем элементы
Ci по порядку числами от 1 до `i для i = 1, n. Теперь каждому элементу исходной дистрибутивной решетки поставим в
соответствие набор чисел (k1 , . . . , kn ), где ki для i = 1, n — номер неприводимого элемента с i-ой цепи, участвующего в
несократимом разложении элемента на неприводимые элементы (ki 6 `i ). В случае, если ни один элемент с цепи Ci не
участвует в несократимом разложении на неприводимые элементы данного элемента частично упорядоченного множества, положим ki = 0. Таким образом, для данного покрытия цепями происходит вложение дистрибутивной решетки в
n-мерный параллелепипед с целочисленными координатами:
P → ([0, `1 ] ∩ Z) × ([0, `2 ] ∩ Z) × · · · × ([0, `i ] ∩ Z) × · · · × ([0, `n ] ∩ Z) .
Рассмотрим тривиальное покрытие множества неприводимых элементов, объявив каждый элемент самостоятельной цепью. В этом случае установится соответствие между всеми элементами исходного частично упорядоченного множества и наборами из нулей и единиц длины 4:
a −→ (0, 0, 0, 0)
b −→ (1, 0, 0, 0)
c −→ (1, 1, 0, 0)
d −→ (1, 0, 1, 0)
e −→ (1, 1, 1, 0)
f −→ (1, 1, 1, 1)
Это соответствие проинтерпретируем как вложение исходной дистрибутивной решетки в четырехмерный единичный
куб B4 :
c` f
@



`  ` ` @
`c

@
 e
@

@

 d

` 
` @
` ` @
c` @

c` c
@ 
@

@



@`
@` @
`
c`
@
 b

@
c` 
a
Рассмотрим другое упорядоченное покрытие цепями, число которых равно ширине решетки. Пусть C1 =
(b, c, f ) , C2 = (d). В этом случае устанавливается соответствие между элементами решетки и наборами длины 2 с целочисленными координатами, первая из которых меняется в диапазоне от 0 до 3, а вторая — от 0 до 1:
a −→ (0, 0)
b −→ (1, 0)
c −→ (2, 0)
d −→ (1, 1)
e −→ (2, 1)
f −→ (3, 1)
Это соответствие проинтерпретируем как вложение дистрибутивной решетки в двумерный параллелепипед с целочисленными координатами [0, 3] × [0, 1]:
f c`
@
e c`
@`
@
d c`
@c`
c
@
`
@c`
b
@
@c`
a

58

ГЛАВА 1. КОМБИНАТОРИКА

Следующий интересующий нас вопрос — это кодирование дистрибутивных решеток. В задачах часто бывает удобно
работать не с самой дистрибутивной решеткой, а с некоторой ее кодировкой, обладающей наименьшей избыточностью
и, в то же время, однозначной. Ниже строится один из наиболее популярных способов кодировать дистрибутивные
решетки.
Пусть (P, 6) — дистрибутивная решетка. Выделим из нее множество всех неприводимых элементов Q и определим
новое частично упорядоченное множество (Q, 6), где отношение частичного порядка то же, что и в исходной решетке. Каждому a ∈ P однозначным образом ставится в соответствие подмножество из Q, являющееся его разложением.
Отметим, что это подмножество обязательно является антицепью. Нулю поставим в соответствие пустую антицепь.
Каждой такой антицепи S поставим в соответствие ее замыкание вниз S− = {a ∈ Q | ∃ a0 ∈ S : a 6 a0 }. Введем на Q антимонотонную булеву функцию f :
(
1, x ∈ S− ,
f (q) =
0, иначе.
При этом сама антицепь S окажется для f множеством верхних единиц. Множество S− называется идеалом. В связи
с тем, что все вышевведенные соответствия оказываются изоморфизмами, можно утверждать, что дистрибутивная
решетка изоморфна множеству идеалов своих неприводимых элементов. Покроем Q упорядоченным набором
цепей C1 , . . . ,Cn . Это можно сделать множеством способов, при этом количество цепей меняется от ширины Q до мощности Q. Относительно антимонотонной булевой функции f каждая цепь разбивается на два куска: нижний кусок погружен во множество единиц, а верхний — во множество нулей (какие-то из кусков вполне могут оказаться пустыми).
В цепи Ci выберем наибольший элемент, погруженный в единицу — xi (снова считаем, что все элементы цепи пронумерованы от единицы до длины цепи; если такового не оказалось, полагаем номер верхней единицы нулем). В этом случае
кодировкой решетки назовем набор x1 , . . . , xi , . . . , xn .
Если покрывать решетку цепями длины единица, то будет получено ее вложение в соответствующий единичный
n-мерный куб. Если брать покрытие меньшим числом цепей, то размерность параллелепипеда падает, однако растет
число возможных значений координат.

Рассмотрим в качестве примера B52 , 6 .
f c`
` (10100)
@
c` e
@
` (10010)

` 

c`
HH d (10001)
H
c` b
cHc` (01001)
@
@
a c` (00101)

(P, 6)

(01100)

(01010)

(00110)

(11000)

(Q, 6)
f
c`
@

@c` d
e `cH
HH
b c`
Hc` c
@
@c`
a

`

(00011)

Неприводимыми в этой решетке являются элементы a, b, c, d, e, f , их частичный порядок указан на соответствующей
диаграмме Хассе. Несократимые разложения элементов P на неприводимые элементы выглядят следующим образом:
(00011) = ∅,
(00101) = a,
(00110) = b,
(01001) = c,
(01010) = b ∨ c,
(10001) = d,
(01100) = e,
(10010) = b ∨ d,
(10100) = e ∨ d,
(11000) = f .
В первый раз покроем Q цепями длины 1. Ниже указаны полученные кодировки.
(00011) −→ (0, 0, 0, 0, 0, 0) ,
(00101) −→ (1, 0, 0, 0, 0, 0) ,
(00110) −→ (1, 1, 0, 0, 0, 0) ,
(01001) −→ (1, 0, 1, 0, 0, 0) ,

1.4. ЧАСТИЧНО УПОРЯДОЧЕННЫЕ МНОЖЕСТВА

59

(01010) −→ (1, 1, 1, 0, 0, 0) ,
(10001) −→ (1, 0, 1, 1, 0, 0) ,
(01100) −→ (1, 1, 1, 0, 1, 0) ,
(10010) −→ (1, 1, 1, 1, 0, 0) ,
(10100) −→ (1, 1, 1, 1, 1, 0) ,
(11000) −→ (1, 1, 1, 1, 1, 1) .

Проинтерпретируем полученный результат как вложение B52 в шестимерный единичный куб (чтобы не загромождать и
без того сложный рисунок мы опускаем кодировки элементов, предполагая, что вершины куба расположены по ярусам,
при этом на i-ом ярусе снизу (отсчет начинается с нуля) расположены вершины с i единицами, упорядоченные согласно
индуктивному построению).
` X
cX
XXX
B
 @

XXX
@

 B @
XXX

XXX
 B

@
XXX
B


` 
` 
X
c` X@
BX
` X
`X
X
X
X
X

`

X
X
XXX  
XX
X
XXX
XX
X
@
@
B

@
B

B
@
B@
@
B



X
X
X
B@ @

@ XXX



X
XX
X
XXXXX
X


X
X
B
B @

B


 B@@
X
X
X
X
X
X
XX
XX
XX 
XX
@BX@
@
B 
 

B

B
 
B 


X
X
X
X
X
X
X
X
X
X



 B @ @ X
XX
X
X
XX
@XB X
@
@
XX
XX
X
X
X
BBX
``
BB

B





X
X
BX
` X
`X
` XX
@
` 
BcX
` 
BcX
`@
` @
`@
` XX
` X@X
`XX
`
X
XX
XX
X
X
X

`





X
X
X
X
X
XX
X
X
X
X
X
X
X
XX
X
X
X
X
X
X
XX
X
B

@
B
@
@

@

B

@
B
@

@
B
@
@
BB@@
B@

B
B









X
X
X
X
X
X
X
X
X
X
B@ @

 @ X
B@
@
X
@
@
@ B
BXX
X









X
X
X
X
X
X
X
X
X
X
X
X
XX
X









X
X
X
X
X
X
X
X
X
X
B
B

B


B

B

X
X
X
XX
X
X
X
XBX
X
X
X
XX
XX
XXB 
@
@B @ @ BB
@
@
@
X
@
@
B XBXX







X
X
XX
X
X
X
X


B

B @
B 

B









X
X
X
X
X
X
X
X
X
X
X
X
X
X
X
X
X
X
X
BX
X

X


  
XX
XX
X
XX
X
X
X
@
@
@
@
@ B
@
@
@
B 
BX
XX
XX
X
X
X
XX
X
X
XX
X
X
X
BB
BBX
BBX
X



 BBc` @@@

X
X
X
X
X` X
B
@
`X
B` X
`X
@
@
@
X
` BX
Bc
@
` @
` XX
` XX
` X
` X
` 
B
` @
`X
`@
` X
BX



` @


` XB
` X
X
X
X
X
X
XXX
X








B`
X
X
X
X
X
X
X@
XX
XX
X
X
X
X
XXX
B XX
@
X
X
X
X
X
XX
XX
X
X
B

@
@

@
B

B
@
@
@

B
@

B

BB@@
B

B

B







X
X
X
X
X
@
@ X
@
B@
@

@
@ @ BXX


B XX XXB@
B



XX
X
X
X
X
XX
X
X
X
X
X
X
X
X




X




XX
X
X
X
X
X
BX
@
B X

 B
X
X
X
X
X
X
X
X
X
B
X
X
X
X
X
X
X
X
@
@
@
B

@
@
@
@


B

B
B @ @ 
BBB 






XX
XX
XX
XX
XX
X
X
XX
X
B@
@
BX
B@B




X
X
X
X
X
X
XX
X
X
X
X
X
BX
X@
@

X

BX






X
XX
X
X
X
X
X
@X
@
@ B
@
BXX
B 
X
X
X
X
X
X@
X
X
X
X
X
X
X
X
X
B
B

B

X
BB`







X
X
X
X
X
XX
X
X
X
c`XXX
@
@
@
B
B
`

X
B
@
B

B

`
`
`
@

`
@
@
`X
 X@
` @X
` @X
`XX
B` X
Bc
B
X
`
B

`

`


X
X
X
X
X
X
X





X
X
X
X
X
X
BXX@@ B B   @ 
X XX
XX 
@
@@ X
BB XX
BB  

@
B  B
  @

XX
B@ @
XX
XX
XX
X
X
XX


XX
X
X
X
X
X
X
XX XX
X XXB @ @ @
XX   

@ B 
@ B 
BB
B 
XXXXX
XX
X
X
X
X
X
@
@
@
@ B  


B 

BX
X
XX
X
XXX
X
X
X
X
X
X@




B


XXB
X
X@
` X@
@Bc

` @
`
B
` X
` @
XX
X
XB
X
X
B`
XXX
@

@ BB


XXX

XX
@ B 

XXX
XXX@ B  
XX
@Bc
`

Рассмотрим другое упорядоченное покрытие цепями: на этот раз, опираясь на теорему Дилуорса, покроем решетку числом цепей, равным ее ширине. Пусть C1 = (a, b, e, f ) , C2 = (c, d). В этом случае вершины получат следующие
кодировки:

(00011) −→ (0, 0) ,
(00101) −→ (1, 0) ,
(00110) −→ (2, 0) ,
(01001) −→ (1, 1) ,
(01010) −→ (2, 1) ,
(10001) −→ (1, 2) ,
(01100) −→ (3, 1) ,
(10010) −→ (2, 2) ,
(10100) −→ (3, 2) ,
(11000) −→ (4, 2) .

Такое отображение также имеет геометрическую интерпретацию: оно соответствует вложению указанной решетки в

60

ГЛАВА 1. КОМБИНАТОРИКА

двумерный параллелепипед с целочисленными координатами, лежащими в пределах [0, 4] × [0, 2].
c` (4, 2)
@
c` (3, 2) @` (4, 1)
@
@
c` (2, 2) @c` (3, 1) @`
@
@
c` (1, 2) @c` (2, 1) @` (3, 0)
@
@
` (0, 2) @c` (1, 1) @c` (2, 0)
@
@
@` (0, 1) @c` (1, 0)
@
@c` (0, 0)

(4, 0)

Обычно двумерный параллелепипед такого вида называется прямоугольной решеткой и обозначается L (4, 2)
Примеры.
1. Доказать равенство ∑ η k (x, y) = (2δ − ζ )−1 (x, y).
k>0

 Решение. Используя известные свойства сумм, легко преобразовать левую часть к правой:

∑ η k (x, y) = ∑ (ζ − δ )k (x, y) = (δ − (ζ − δ ))−1 (x, y) = (2δ − ζ )−1 (x, y) .

k>0

k>0


2. На частичном порядке, представленном на диаграмме Хассе, ввести монотонную нумерацию, в ней найти матрицы дзета-функции и функции Мебиуса, а также определить функцию F , если в скобках указаны значения
суммирующей функции.
8(9) a`
`a 9(3) `a 10(10)
@
@
3(4) a`
@`a 6(7) `a 7(4)
@
@
2(3) a`
`a 4(1)@`a 5(2)
@
@
@a`
1(1)
 Решение. Непосредственно по определению выписывается матрица дзета-функции:


1 1 1 1 1 1 1 1 1 1
0 1 1 0 0 1 0 1 0 0


0 0 1 0 0 0 0 1 0 0


0 0 0 1 0 1 0 1 1 1


0 0 0 0 1 1 1 1 1 1


ζ =

0 0 0 0 0 1 0 1 1 1
0 0 0 0 0 0 1 0 0 1


0 0 0 0 0 0 0 1 0 0


0 0 0 0 0 0 0 0 1 0
0 0 0 0 0 0 0 0 0 1
Из определяющего функцию Мебиуса свойства, подлежащего доказательству в пункте 2a упражнения 2, находим
матрицу функции Мебиуса:


1 −1 0 −1 −1 2
0
0
0
0
0 1 −1 0
0 −1 0
1
0
0


0 0
1
0
0
0
0 −1 0
0


0 0
0
1
0 −1 0
0
0
0


0 0
0
0
1 −1 −1 0
0
1

µ =
0 0
0
0
0
1
0 −1 −1 −1


0 0
0
0
0
0
1
0
0 −1


0 0
0
0
0
0
0
1
0
0


0 0
0
0
0
0
0
0
1
0
0 0
0
0
0
0
0
0
0
1

61

1.4. ЧАСТИЧНО УПОРЯДОЧЕННЫЕ МНОЖЕСТВА
Вектор суммирующей функции равен (в данной монотонной нумерации)
SF = 1

3

4

1

2

7

4

9

3


10

Отсюда, используя обращение Мебиуса
F (x) =

∑ SF (y) µ (y, x) ,

y6x

или, что то же самое, вектор функции F (x) равен произведению вектор-строки на матрицу
F = SF · µ.
Выполнив необходимые вычисления, получаем, что вектор функции F (x) равен

F = 1 2 1 0 1 3 2 1 −4 1 .

Упражнения.
1. Доказать, что для любой функции алгебры инцидентности справедливо соотношение
f k (x, y) =

∑

f (x, z1 ) · f (z1 , z2 ) · · · f (zk , y) .

x6z1 6z2 6···6zk 6y

2. Доказать следующие равенства:
(a)

∑ µ (x, z) = ∑ µ (z, y) = δ (x, y),

x6z6y

(b) ∑

x6z6y

κ k (x, y) = (2δ

− λ )−1 (x, y).

k>0

3. Обосновать следующие утверждения:
(a) η k (x, y) = ] {(x, y) -цепи длины ровно k},
(b) κ k (x, y) = ] {максимальные (x, y) -цепи длины ровно k},
(c) ζ k (x, y) = ] {(x, y) -цепи длины, не превосходящей k},
(d) λ k (x, y) = ] {максимальные (x, y) -цепи длины, не превосходящей k}.
4. Найти функцию Мебиуса для единичного n-мерного куба.
5. Доказать, что в частично упорядоченном по делимости множестве натуральных чисел функцией Мебиуса является


n = 1,
1,
s
µ (n) = (−1) , n = p1 · · · ps — свободно от квадратов,


0,
иначе.

Использовано следующее обозначение: µ (m, n) = µ 1, mn ; µ (1, n) = µ (n).
6. Доказать, что свойства 6a и 6b эквивалентны и для определения дистрибутивности достаточно любого одного из
них.

62

ГЛАВА 2. КОНЕЧНОЗНАЧНЫЕ ЛОГИКИ

Глава 2

Конечнозначные логики
2.1

Функции конечнозначной логики

Определения и примеры. Множество U = {u1 , u2 , . . . , u` , . . .} назовем алфавитом переменных. Элементы этого
множества называются соответственно переменными. При этом считается, что переменные с различными индексами
различны (то есть могут принимать различные значения независимо друг от друга).
Определяется множество Ek = {0, 1, . . . , k − 1} и рассматриваются функции вида f : Ekn → Ek . Функция от n различных переменных обозначается f (ui1 , . . . , uin ), при этом считается, что j 6= s ⇒ ui j 6= uis . Такие функции называются
функциями k-значной логики. В дальнейшем используются следующие метаобозначения: f (x, y, . . . , z) — при этом
считается, что различным буквам соответствуют различные переменные, f (x1 , . . . , xn ) — при этом аналогично считается, что буквам с различными индексами соответствуют различные переменные и f (x̃n ), что является альтернативным
обозначением второго обозначения.
Множество всех функций k-значной логики обозначается Pk . Множество всех функций k- значной логики, завиn
hni
hni
сящих от n переменных обозначается Pk . Очевидно, Pk = kk . В дальнейшем левая часть предыдущего равенства
будет записываться в несколько ином виде: |Pk |hni . Доказывается это равенство при помощи табличного задания
функции k-значной логики:
 x1
0



0
kn
.
 ..


k−1

...
...
...
...
...

xn−1
0
0
...
k−1

xn
0
1
...
k−1

f (x1 , . . . , xn−1 , xn )
← любое значение
← любое значение
...
← любое значение

Упорядочив лексикографически в левой части таблицы все наборы длины n из Ek , легко видеть, что всего их kn . Далее,
каждому из наборов ставится в соответствие произвольное значение также из Ek . Это, в свою очередь можно сделать
n
kk различными способами.
Изучение функций k-значной логики существенно затрудняется тем, что с возрастанием числа переменных их количество растет заметно быстрее, чем, скажем, число функций алгебры логики. Так, например, число функций трехзначной логики двух переменных равно 39 , что больше, чем 19000, в то время, как число функций алгебры логики того
же числа переменных равно 16. Возникает вопрос о задании функции k-значной логики. Векторное задание, которое
очень удобно для функции алгебры логики, представляется неприемлемым, так как длина вектора быстро растет. Для
функций одного переменного наиболее часто используется представление в виде подстановки:


0 1 ... k −1
S (x) =
.
a0 a1 . . . ak−1
Напомним, что элементы нижней строчки в подстановке могут повторяться. Если же все элементы нижней строчки
различны, то подстановка превращается в перестановку. Для функций двух переменных используется задание в виде
двумерной таблицы:
HHy
1
...
k−1
x H 0
..
0
.
..
1
.
..
.
· · · · · · f (i, j)
k−1
Следующие функции называются элементарными функциями k-значной логики:
• Константы 0, 1, . . . , k − 1 не имеют существенных переменных. Формально константу 0 можно задать в виде
подстановки


0 1 ... k −1
0 (x) =
.
0 0 ...
0

63

2.1. ФУНКЦИИ КОНЕЧНОЗНАЧНОЙ ЛОГИКИ

• Функции, существенно зависящие от одной переменной: Обобщение отрицания алгебры логики — отрицание
Поста


0 1 ... k −2 k −1
x=
= x + 1 (mod k).
1 2 ... k −1
0
Оно обладает простыми свойствами: x = x + 2 (mod k), и вообще для любого натурального l отрицание Поста,
примененное l раз к x, дает x + l (mod k). Обратим внимание, что сложение двух различных переменных таким
образом не определяется, так как мы определили лишь сложение с константой.
• Другим обобщением отрицания в P2 является отрицание Лукасевича (в некоторых источниках — Лукашевича). Оно определяется как


0
1
2
... k −1
∼x=
= (k − 1) − x.
k −1 k −2 k −3 ...
0
Для отрицания Лукасевича справедливо правило снятия двойного отрицания, как и у отрицания в P2 : ∼ (∼ x) = x


0
1
2
... k −1
• Функция −x =
, обладающая тем свойством, что если ее добавить к x, то по0 k −1 k −2 ...
1

лучится константа 0.Векторное задание этой функции
имеет вид −x = 0 k − 1 . . . 1 . С другой стороны:

x = 0 1 ... k −1 ,∼ x = k −1 k −2 ... 1 ,

(∼ x) = 0 k − 1 . . . 1 ,
то есть x = −(∼ x).
• Семейство функций, являющихся также обобщениями отрицания
(
k − 1 x = i,
Ji (x) =
0 6 i 6 k−1
0
x 6= i,
и

(
1 x = i,
ji (x) =
0 x=
6 i,

0 6 i 6 k − 1.

• Разностью переменной x и константы i назовем функцию x − i = x + (k − i), иначе говоря, (k − i) раз примененное
отрицание Поста.
• Обобщение двухместной дизъюнкции — максимум: max (x, y). Эта функция, очевидно, коммутативна, а также
ассоциативна: max (x, max (y, z)) = max (max (x, y) , z), что позволяется ввести по индукции n-местный максимум:
max (x1 , . . . , xn−1 , xn ) = max (max (x1 , . . . , xn−1 ) , xn ).
• Обобщение двухместной конъюнкции: min (x, y). Минимум обладает такими же свойствами, что и максимум. В
частности, определяется min (x1 , . . . , xn ). Для минимума и максимума справедливы обобщения правил де Моргана:
∼ max (∼ x, ∼ y) = min (x, y) , ∼ min (∼ x, ∼ y) = max (x, y) .

(2.1)

• Сложение по модулю k: x + y (mod k). Эта операция коммутативна и ассоциативна. Можно ввести разность: x +
y+y+...+y = x−y
|
{z
}
k−1

• Еще одним обобщением конъюнкции может служить произведение по модулю k: x · y (mod k).
• Усеченная разность
(
x − y x > y,
x−̇y =
0
x < y.
Таблица усеченной разности при k = 3 имеет следующий вид:
y
H
x H
0
1
2

0
0
1
2

1
0
0
1

2
0
0
0

Очевидно, что из усеченной разности легко получить минимум: min (x, y) = x−̇ (x−̇y). Действительно, если x < y,
то выражение в скобке равно нулю и вся формула реализует функцию x. Если же x > y, то выражение в скобке
реализует x − y, что заведомо меньше x, то есть вся формула реализует x − (x − y) ≡ y.

64

ГЛАВА 2. КОНЕЧНОЗНАЧНЫЕ ЛОГИКИ
• Импликация x ⊃ y =∼ (x−̇y), которую можно записать также
(
k − 1 − x + y x > y,
x⊃y=
k−1
x < y.

Реализация функций формулами. Понятия формулы и ее глубины, а также функции, сопоставляющейся формуле
над множеством функций определяются аналогично P2 .
Определение 2.1.1. Пусть A — некоторое множество функций из Pk .
1. Для любой функции f ∈ A справедливо: f является формулой глубины 1 над A .
2. Если F1 , . . . , Fn — формулы над A или символы переменных из U и f (e
xn ) ∈ A , причем наибольшая глубина формулы среди F1 , . . . , Fn равна k, то f (F1 , . . . , Fn ) — также формула над A , глубина которой равна k + 1.
3. Те и только те объекты называются формулами над A , которые могут быть определены согласно пунктам 1 и 2
данного определения.
Дадим определение реализации функций формулой.
Определение 2.1.2. Пусть A — некоторое множество функций из Pk .
1. Если функция f ∈ A , то формуле f сопоставляется функция f ∈ A , иными словами, формула f реализует функцию f : f → f ∈ A .
2. Если F1 → f1 , . . . , Fn → fn и f ∈ A , то формуле f (F1 , . . . , Fn ) сопоставляется функция f ( f1 , . . . , fn ), иными словами,
f ( f1 , . . . , fn ) реализуется формулой f (F1 , . . . , Fn ).
3. Функции сопоставляются всем формулам, описанным в пунктах 1 и 2, и только им.
Первая и вторая формы.

Система функций
{0, 1, . . . , k − 1, J0 (x) , . . . , Jk−1 (x) , min (x, y) , max (x, y)}

называется системой Россера-Туркетта.
Теорема 2.1. Система Россера-Туркетта полна в Pk .
 Док-во. Обозначим систему Россера-Туркетта символом A . Так как 0 ∈ A , будем рассматривать функции f (e
xn ) 6≡
0. В этом случае справедливо представление
f (e
xn ) =

max

(α1 ,...,αn )∈Ekn
f (α1 ,...,αn )6=0

(min (Jα1 (x1 ) , . . . , Jαn (xn ) , f (α1 , . . . , αn ))) .

(2.2)

e n ∈ Ekn все минимумы обратятся в ноль, за исключением одного, который и приДействительно, на любом наборе α
мет значение, равное значению функции на этом наборе. Максимум из нулей и одного значения функции равен этому
самому значению.

Реализация функции над системой Россера-Туркетта называется первой формой этой функции. Так, например,
первая форма усеченной разности при k = 3 имеет следующий вид:
max (min (J1 (x) , J0 (y) , 1) , min (J2 (x) , J0 (y) , 2) , min (J2 (x) , J1 (y) , 1))
Отметим, что система функций
{0, 1, . . . , k − 1, J0 (x) , . . . , Jk−1 (x) , x + y, min (x, y)}
также полна в Pk . Это следует из того, что доказательство теоремы 2.1 не изменится, если заменить в 2.2 максимум на
сумму по модулю k:
f (e
xn ) =
∑ min (Jα1 (x1 ) , . . . , Jαn (xn ) , f (α1 , . . . , αn )) (mod k).
(α1 ,...,αn )∈Ekn
f (α1 ,...,αn )6=0

В этом случае суммироваться будут все нули и одно значение функции, что, очевидно, то же самое.
Рассмотрим теперь систему
{0, 1, . . . , k − 1, j0 (x) , . . . , jk−1 (x) , x + y, x · y}
и докажем ее полноту:

(2.3)

65

2.1. ФУНКЦИИ КОНЕЧНОЗНАЧНОЙ ЛОГИКИ
Теорема 2.2. Система 2.3 полна в Pk .

 Док-во. Обозначим систему 2.3 символом B. Так как 0 ∈ B, будем рассматривать функции f (e
xn ) 6≡ 0. В этом случае
справедливо представление
f (e
xn ) =

∑

(α1 ,...,αn )∈Ekn
f (α1 ,...,αn )6=0

f (α1 , . . . , αn ) · jα1 (x1 ) · · · jαn (xn )

(mod k).

(2.4)

Действительно, на любом наборе (α1 , . . . , αn ), если ∃i : xi 6= αi , то все слагаемое обратится в ноль. Если же все xi = αi ,
что встретится не более одного раза, то все слагаемое станет равным значению функции. Таким образом, правая часть
суммы 2.4 на фиксированном наборе равна просто значению функции на этом же наборе.

Представление 2.4 функции k-значной логики принято называть ее второй формой. Так, при k = 3 вторая форма
усеченной разности имеет вид:
j1 (x) · j0 (y) + 2 · j2 (x) · j0 (y) + j2 (x) · j1 (y) .
Операция замыкания, свойства замыкания, замкнутые классы. Пусть A — некоторое множество функций из Pk .
Множество [A ] всех функций, реализуемых формулами над A , называется замыканием множества A . Для операции
замыкания очевидны следующие тривиальные тождества:
1. экстенсивность: A ⊆ [A ],
2. монотонность (изотонность): A ⊆ B ⇒ [A ] ⊆ [B] и
3. идемпотентность: [A ] = [[A ]].
Если множество A совпадает со своим замыканием: (A = [A ]), то A называется замкнутым классом.
Пусть A , B ⊆ Pk . Тогда если B = [B] , A ⊆ B и [A ] = B, то говорят, что система функций A — полная в системе
B. Аналогично, если A — минимальная (по удалению) полная система в B, то A называется базисом.
Очевидно, что замкнутые классы существуют. Тривиальными примерами замкнутых классов являются все Pk и пустое множество: [Pk ] = Pk , [∅] = ∅. Рассмотрим теперь некоторые нетривиальные замкнутые классы.
Определение 2.1.3. Пусть ∅ E Ek . f (e
xn ) ∈ Pk сохраняет множество E , если выполнена следующая импликация: α1 , . . . , αn ∈ E ⇒ f (α1 , . . . , αn ) ∈ E . Классом функций, сохраняющих множество E называется T (E ).
Лемма 2.1.1. Для любого множества E ⊆ Ek класс T (E ) замкнут.
 Док-во. Поскольку тождественная функция сохраняет любое множество, для доказательства замкнутости достаточно доказать, что суперпозиция функций, сохраняющих E , также сохраняет E . Пусть функции
f1 (x1 , . . . , xn ) , . . . , fm (x1 , . . . , xn ) ∈ T (E ) (без ограничения общности будем считать, что они зависят от одних и тех
e = (α1 , . . . , αn ) ∈ E значения функций
же переменных). Пусть также f (x1 , . . . , xm ) ∈ T (E ). Для любого набора α
f1 (α1 , . . . , αn ) = β1 ∈ E , . . . , fm (α1 , . . . , αn ) = βm ∈ E . Но тогда и f (β1 , . . . , βm ) ∈ E .

Описанное семейство замкнутых классов обладает следующими свойствами.
Утверждение 2.1.1. T (E ) = Pk , T (E ) = Pk , а также ∅
с Pk .

E

Ek ⇒ T (E ) — непустое множество, не совпадающее

 Док-во. Первое свойство очевидно, второе принимается по договоренности, а третье следует из того, что, например,
отрицание Поста не сохраняет никакое непустое собственное подмножество Ek .

Функции максимума и минимума, очевидно, сохраняют любое E ⊆ Ek .
Утверждение 2.1.2. Всего в Pk существует 2k − 2 классов, сохраняющих непустые собственные множества,
причем все они попарно различны и ни один из них не содержится в другом.
 Док-во. Действительно, пусть E1 6= E2 . Возможны 2 варианта:
1. Существуют такие a и b, что a ∈ E1 \E2 и b ∈ E2 \E1 , то есть E1 * E2 и E2 * E1 . В этом случае, очевидно, для функций
констант выполняется a ∈
/ T (E2 ) , b ∈
/ T (E ), то есть эти классы не совпадают, и ни один из них не содержится во
втором.
2. E2 E1 , то есть существует такое a, что a ∈ E1 \ E2 . В этом случае классы T (E1 ) и T (E2 ) различны, потому что
константа a содержится в первом из них и не содержится во втором. Покажем, что во втором классе существует
функция, не содержащаяся в первом. Поскольку E2 не пусто, существует c ∈ E2 . Также,(
поскольку E1 6= Ek , сущеc если x ∈ E2 ,
ствует точка d ∈ Ek \ E1 . Класс T (E2 ), очевидно, содержит функцию такого вида: f (x) =
d в противном случае.
Функция f (x) по построению содержится в классе T (E2 ), но, очевидно, не содержится в классе T (E1 ), так как
f (a) = d ∈
/ E2 .

66

ГЛАВА 2. КОНЕЧНОЗНАЧНЫЕ ЛОГИКИ

Осталось только подсчитать число этих классов. Так как все они различны, то их число равно числу непустых собственных подмножеств Ek , то есть 2k − 2.

Определение 2.1.4. Множество функций A называется предполным классом в Pk , если оно само является замкнутым и неполным в Pk классом, но для любой функции f , не содержащейся в A выполняется [A ∪ { f }] = Pk .
Утверждение 2.1.3. Для любого непустого подмножества E ( Ek класс T (E ) является предполным в Pk .
 Док-во. Пусть E — любое собственное непустое подмножество Ek . Для произвольной функции f ∈
/ T (E ) рассмотe ∈ E n : f (α
e ) = f (α1 , α2 , . . . , αn ) = b ∈
рим замыкание [T (E ) ∪ { f }]. Для f справедливо f ∈
/ T (E ) ⇒ ∃α
/ E . С другой
стороны, очевидно, классу T (E ) принадлежит такая функция (для a ∈ E ):
(
a
z∈E,
g (x, y, z) =
Vk (x, y) z ∈
/ E.
e )), реализует функцию Вебба.
Таким образом, суперпозиция функций из объединения g (x, y, f (α



Утверждение 2.1.3 показывает, что все замкнутые классы, сохраняющие непустые собственные подмножества Ek ,
являются предполными. Если вспомнить P2 , то там существовало ровно пять предполных классов: два класса сохраняющих константы, классы линейных, самодвойственных и монотонных функций и их структура условно выглядела
так:
`P
```2`
b
"
" %% ee b
b
"
`" %
`
` e ` b`
T0 T1 L
S
M
Аналогичная ситуация наблюдается и в Pk :
P
` ` ` ` k` ` `

QQ
  AA@
@ Q

` 
`

`
`
A
` @` 
Q`


k
2 −2
,

(2.5)

где выделены как раз те 2k − 2 предполных классов.
n
n
n
Число функций, зависящих от n переменных в классе T (E ) при |E | = m для 1 6 m < n, очевидно, равно mm kk −m .
n
Действительно, всего наборов длины n, составленных из символов E , — m . Им могут соответствовать лишь значения из m-элементного множества. Остальным же kn − mn наборам могут соответствовать любое из k значений. Таким
образом получено, что
n
n
n
|T (E )|hni = mm kk −m .
Рассмотрим теперь другое семейство замкнутых классов:
Определение 2.1.5. Пусть D1 , D2 , . . . , Ds — попарно непересекающиеся непустые множества (блоки), в объединении
дающие все Ek . В этом случае представление Ek = D1 ∪ D2 ∪ . . . ∪ Ds называется разбиением Ek .
Случаи s = 1 и s = k порождают тривиальные разбиения Ek и {0} ∪ {1} ∪ . . . ∪ {k − 1} соответственно. Все остальные разбиения называются нетривиальными. По заданному разбиению D можно на множествах Ek и Ekn ввести отношение эквивалентности следующим образом: ∀a, b ∈ Ek : a ∼ b (mod D) (a и b эквивалентны по разбиению D) тогда и
e ∼ βe (mod D) ⇔ ∀i = 1, n ⇒ αi ∼ βi (mod D), если
только тогда, когда они в этом разбиении попадают в один блок; α
e | = βe = n.
|α
Определение 2.1.6. Функция f (e
xn ) от n переменных сохраняет разбиение D, если
 
e ∼ βe (mod D) ⇒ f (α
e ) ∼ f βe
α
(mod D).
Классом функций, сохраняющих разбиение D называется множество всех функций, сохраняющих заданное разбиение D.
Также, как и в случае сохранения множества, выделяются вырожденные случаи. Тривиальными называются разбиение в виде одного блока U (Pk ) и разбиение в виде k блоков
U ({0} ∪ {1} ∪ . . . ∪ {k − 1}) .

67

2.1. ФУНКЦИИ КОНЕЧНОЗНАЧНОЙ ЛОГИКИ

Все функции сохраняют тривиальные разбиения, иными словами, классы всех функций, сохраняющих тривиальные
разбиения, являются полными в Pk , поэтому имеет смысл рассматривать эти классы только при k > 3. Любая тождественная функция сохраняет любое разбиение. Отрицание Поста не сохраняет никакое нетривиальное разбиение. Из
этого следует, что для любого разбиения класс сохраняющих его функций не пуст. Справедливо более сильное утверждение, а именно, что ∅ U (D) Pk для любого нетривиального разбиения D. Действительно, если есть хотя бы два
блока, один из которых содержит хотя бы два элемента a и b, а второй содержит хотя бы один элемент c, то достаточно
в качестве примера функции, не сохраняющей данное разбиение, рассмотреть отображение a в a, b в c, а на остальных
элементах — произвольно.
Лемма 2.1.2. Для любого разбиения класс функций, его сохраняющих, замкнут.
 Док-во. Поскольку тождественная функция сохраняет любое разбиение, для доказательства замкнутости достаточно доказать, что суперпозиция сохраняющих разбиение функций также сохраняет разбиение. Рассмотрим произxn ) , f (e
xm ) ∈ U (D). Докажем, что F (e
xn ) = f ( f1 (e
xn ) , . . . , fm (e
xn )) ∈ U (D). Расвольное разбиение D и пусть f1 (e
xn ) , . . . , fm (e
e
e = (α1 , . . . , αi , . . . , αn ) и β = (β1 , . . . , βi , . . . , βn ).
смотрим для этого любые два эквивалентные по разбиению
D набора α
 
n
e
e ) ∼ f j β (mod D) ∀ j = 1, m, или, что то же самое,
Из f j (e
x ) ∈ U (D) ∀ j = 1, m следует, что f j (α
    
 
 
e ) , f2 (α
e ) , . . . , fi (α
e ) , . . . , fm (α
e )) ∼ f1 βe , f2 βe , . . . , fi βe , . . . , fm βe
( f1 (α
e ) , . . . , fm (α
e )) ∼ f
Из того, что f (e
xm ) ∈ U (D), следует, что f ( f1 (α
 
e ) ∼ F βe (mod D).
F (α

(mod D).

  
 
f1 βe , . . . , fm βe
(mod D), или, по-другому,


Два введенных выше замкнутых класса можно рассматривать как частные случаи класса функций, сохраняющих
предикат.
Определение 2.1.7. s-местным предикатом называется функция k-значной логики P (y1 , . . . , ys ), принимающая
e предикат принимает значение, равное единице, то этот набор
только значения 0 или 1. Если на некотором наборе α
e ∈ P. Упорядоченная s-ка наборов удовлетворяет предикату P, если она удовлетворяет
удовлетворяет предикату: α
ему покомпонентно:

e1 = α11 , . . . , αn1 
α

e2 = α12 , . . . , αn2
α
∈ P ⇔ ∀ j = 1, n ⇒ α 1j , α 2j , . . . , α sj ∈ P
···
es = (α1s , . . . , αns )
α
Рассматриваются только случаи s > 1. Предикаты, являющиеся тождественным нулем или тождественной единицей,
называются тривиальными. В этом случае предикат существенно зависит от нуля переменных. В случае s = 1 предикат называется характеристической функцией. В случае s = 2 — разбиением.
Определение 2.1.8. Функция f (e
xn ) сохраняет предикат P, если для любой упорядоченной s-ки наборов длины n
e
e
e1 ) , . . . , f (α
es )) также удовлетворяет предикату P. Классом функций, сохраняю(α1 , . . . , αs ) упорядоченная s-ка ( f (α
щих предикат P, называется множество W (P) всех функций, сохраняющих предикат P.
Так как любой набор удовлетворяет предикату P ≡ 1, W (P) = Pk . Также, предикат, тождественно равный нулю, сохраняет любая функция. Очевидно, что класс, сохраняющий нетривиальный предикат не пуст и не совпадает со всем
Pk , за некоторыми исключениями. Действительно, для любого нетривиального s-местного предиката существует упорядоченная s-ка, ему не удовлетворяющая. Тогда функцию, не сохраняющую предикат, определяем по следующему
правилу: для некоторой упорядоченной s-ки различных наборов, удовлетворяющей предикату, ставим в соответствие
упорядоченную s-ку, не удовлетворяющую предикату. Здесь существенно наличие s различных наборов, удовлетворяющих предикату. В противном случае, если предикат имеет следующий вид:
(
1 xi1 = xi2 = · · · = xil 0 6 l 6 s,
P (x1 , . . . , xs ) =
,
0 иначе,
то любая функция его сохраняет. Действительно, в этом случае из s наборов l должны быть равными. Но и значения
любой функции на них будут равны. А поскольку на оставшихся s − l наборах функция может принимать произвольные
значения, любая функция такой предикат сохранит. С другой стороны, если потребовать, чтобы некоторые наборы были не просто равны друг другу, а еще и совпадали с вполне определенным фиксированным набором, то класс функций,
сохраняющих такой предикат снова будет неполным.
Лемма 2.1.3. Для любого предиката класс сохраняющих его функций замкнут.

68

ГЛАВА 2. КОНЕЧНОЗНАЧНЫЕ ЛОГИКИ

 Док-во. Так как тождественная функция сохраняет любой предикат, для доказательства замкнутости этого класса
достаточно доказать, что суперпозиция сохраняющих предикат функций также сохраняет предикат. Для этого рассмотрим функции
f1 (e
xn ) , f2 (e
xn ) , . . . , fm (e
xn ) , f (z1 , . . . , zm ) ∈ W (P)
для некоторого предиката s-местного предиката P и докажем, что суперпозиция
F (e
xn ) = f ( f1 (e
xn ) , . . . , fm (e
xn )) ∈ W (P) .
e1 , α
e2 , . . . , α
e j, . . . , α
es ) , сохраняющих предикат. Для каждого наПредложим этой суперпозиции любой набор наборов (α
бора вычислим все fl .

e1 )) F (α
e1 , )
e1 = α11 , α21 , . . . , αi1 , . . . , αn1  ( f1 (α
e1 ) , f2 (α
e1 ) , . . . , fi (α
e1 ) , . . . , fm (α
α
2
2
2
2
e
e
e
e
e
e2 , )
α2 = α1 , α2 , . . . , αi , . . . , αn
( f1 (α2 ) , f2 (α2 ) , . . . , fi (α2 ) , . . . , fm (α2 )) F (α
..
..
..
.
.
.


j
j
j
j
e j = α1 , α2 , . . . , αi , . . . , αn
e j ) , f2 (α
e j ) , . . . , fi (α
e j ) , . . . , fm (α
e j )) F (α
e j, )
α
( f1 (α
..
..
..
.
.
.
es ) , f2 (α
es ) , . . . , fi (α
es ) , . . . , fm (α
es )) F (α
es , )
es = (α1s , α2s , . . . , αis , . . . , αns ) ( f1 (α
α
Упорядоченная s-ка наборов, составленных из значений функций, очевидно, удовлетворяет предикату. Следовательно,
и s-ка, составленная из значений суперпозиции также удовлетворяет предикату.

Предикаты могут описывать различные свойства функций.(Можно легко, определив соответствующий предикат,
1 x1 6 x2 ,
предложить замкнутый класс монотонных функций: P (x1 , x2 ) =
Функцией, двойственной к f (x1 , . . . , xn ),
0 x1 > x2 .
называется функций f ∗ (x1 , . . . , xn ) =∼ f (∼ x1 , . . . , ∼ xn ). Функция f называется самодвойственной, если f = f ∗ . Также
( можно описать замкнутый класс самодвойственных функций, определив соответствующий предикат: P (x1 , x2 ) =
1 x1 =∼ x2 ,
Несмотря на то, что предикаты являются достаточно мощным средством описания замкнутых классов,
0 x1 6=∼ x2 .
позже будет показано, что используя предикаты, нельзя описать все замкнутые классы.
Другими примерами замкнутых классов являются, например, класс линейных функций, класс функций, представи(1)
мых полиномами Pol, класс функций, существенно зависящих не более, чем от одной переменной Pk . Эти классы не
являются полными системами при любых значения k, за исключением второго, который является полной системой при
любом простом k. Замыкание множества всех функций, зависящих от двух переменных, в свою очередь совпадает со
всем Pk .
В заключение пункта приведем еще один пример замкнутого класса T (E , s) , s = 1, k. Фиксируются произвольные
E , A0 , A1 , A2 , . . . , An ⊆ Ek , |Ai | = s, i = 0, n, E 6= Ek . Функция n переменных f (x1 , . . . , xn ) ∈ T (E , s) тогда и только тогда,
когда f (E ∪ A1 , E ∪ A2 , . . . , E ∪ An ) ∈ E ∪ A0 . Этот класс также является неполным в нетривиальных случаях.
Полные системы, примеры полных систем. Пусть A — некоторое множество функций из Pk . Если [A ] = Pk , то
говорят, что A образует полную систему. Минимальная (по удалению функций) полная система называется базисом.
Полноту произвольной системы B будем доказывать сведением к заведомо полным системам, используя следующую
схему:

[A ] = Pk
⇒ [B] = Pk .
A ⊆ [B]
Следующие системы являются полными в Pk при любом значении k:
1. система Россера-Туркетта (теорема 2.1);
2. {0, . . . , k − 1, j0 , . . . , jk−1 , +, ·} (теорема 2.2);
3. система Поста (теорема 2.3);
4. {x, min (x, y)} (упражнение 1a);
5. Vk (x, y) (следствие 2.1.1);
6. {1, k − 1, x−̇y}.

69

2.1. ФУНКЦИИ КОНЕЧНОЗНАЧНОЙ ЛОГИКИ

 Док-во. Сведем эту систему к системе Поста. Минимум получается тривиально: min (x, y) = x−̇ (x−̇y). Получим теперь все одноместные функции, в том числе и отрицание Поста. Реализуем для этого сначала все константы
(k − 1 и 1 уже есть):
k − 2 = (k − 1) −̇1, . . . , 3−̇1 = 2, 1−̇1 = 0.
Получим теперь все ji :
j0 (x) = 1−̇x; j1 (x) = ((2−̇x) −̇ j0 (x)) −̇ j0 (x) ; ji (x) = j0 (x−̇i) −̇ j0 (x−̇ (i − 1)) , i = 1, k − 1.
Имея все ji можно получить систему функций
(
s
x = i,
gi,s (x) =
k − 1 x 6= i.
следующим образом:
gi,s (x) = (· · · ((k − 1) −̇ ji (x))−̇ · · · )−̇ ji (x).
|
{z
}
k−s−1 раз

Отсюда произвольную одноместную функцию строим по правилу

f (x) = min g0, f (0) (x) , . . . , gl, f (l) (x) , . . . , gk−1, f (k−1) (x) .
Таким образом можно построить и отрицание Поста, следовательно, система полна.



7. { j0 (x) , x + y} при k > 3. Заметим, что при k = 2 эта же система не полна, так как она целиком содержится в классе
линейных функций ( j0 (x) = x, x + y = x ⊕ y).
 Док-во. Действительно, x + x + · · · + x = 0 (mod k), далее j0 (0) = 1; x+1 = x, откуда получаются все константы
|
{z
}
k раз

и все ji (x). Отсюда можно получить систему функций fl,s = jl (x) + · · · + jl (x). Таким образом, можно получить
|
{z
}
s раз

произвольную одноместную функцию:
k−1

f (x) =

∑ fi, f (i) (x) ,

i=0

в том числе и ∼ x, x. Получим теперь все двухместные функции. Для этого построим сначала вспомогательную
систему функций:
(
1 x = y = 0,
j0,0 (x, y) = j2 ( j0 (x) + j0 (y)) =
(2.6)
0 иначе;
(
1 x = l, y = m,
jl,m (x, y) = j0,0 (x + (k − l), y + (k − m)) =
0 в противном случае.
Теперь мы готовы построить все функции двух переменных. Действительно,
(
s x = l, y = m,
fl,m,s (x, y) = jl,m (x, y) + · · · + jl,m (x, y) =
|
{z
}
0 иначе.
s раз

Тогда любая двухместная функция может быть представлена в виде
k−1 k−1

f (x, y) =

∑∑

fl,m, f (l, m) (x, y) ,

l=0 m=0

в частности, функция Вебба. Следовательно, система 7 полна.



Отметим, что условие k > 3 существенно используется на шаге 2.6, где необходимо наличие в Pk функции j0 (x),
что, очевидно, выполняется тогда и только тогда, когда k > 3.

70

ГЛАВА 2. КОНЕЧНОЗНАЧНЫЕ ЛОГИКИ

Теорема о полноте системы Поста.

Системой Поста называется система функций
{x, max (x, y)} .

Теорема 2.3. Система Поста полна в Pk .
 Док-во. Сведем систему Поста к системе Россера-Туркетта. Для начала получим константы. Имея отрицание Поста, можно получить функцию x + i для любого i. Тогда справедливо равенство
max (x, x + 1, x + 2, . . . , x + k − 1) = k − 1.
Если есть одна константа и циклический сдвиг с шагом 1 (в нашем случае — отрицание Поста), то можно получить все
константы: k − 1 = 0, 0 = 1, . . . , k − 3 = k − 2. Получим все Ji :


0
1
... k −2 k −1
max (x + 1, . . . , x + k − 1) =
= Jk−1 (x) .
k −1 k −2 ... k −1 k −2
Аналогично, имея циклический сдвиг с шагом 1 и Jk−1 , можно получить уже все Ji по следующему правилу: Jk−2 (x) =
Jk−1 (x) , . . . , J0 (x) = J1 (x).
Таким образом, получены все константы, все Ji , а максимум входит в систему Поста. Осталось получить минимум. Заметим, что в силу 2.1 достаточно реализовать над системой Поста отрицание Лукасевича. Реализуем систему
функций, над которой реализуются все функции одного переменного, в частности, и отрицание Лукасевича. Построим
систему функций
(
s x = r,
fr,x (x) =
.
0 x 6= r.
Действительно,
max (J0 (x) , k − 2) + 2 = j0 (x)
max (J0 (x) , k − 3) + 3
···
max (J0 (x) , k − s − 1) + s + 1
···
max (J0 (x) , 0)

= f0,1 (x)
= f0,2 (x)
= f0,s (x)
= f0,k−1 (x)

Далее, для любого s
fk−1,s (x) = f0,s (x)
···
f1,s (x) = f2,s (x)
Таким образом, для любых 0 6 r, s 6 k − 1 построены fr,s (x) С помощью полученной системы, очевидно, можно построить любую одноместную функцию f (x):

f (x) = max f0, f (0) (x) , f1, f (1) (x) , . . . , fl, f (l) (x) , . . . , fk−1, f (k−1) (x) ,
в том числе и отрицание Лукасевича:

∼ x = max f0,k−1 (x) , f1,k−2 (x) , . . . , fl,k−l−1 (x) , . . . , fk−1,0 (x) .
Тогда, согласно 2.1, min (x, y) =∼ max (∼ x, ∼ y), что завершает доказательство.



Заметим, что эта система функций является полной при любом значении k. Дело в том, что некоторые системы
полны лишь при определенных значениях k, например, при k > 3 или при только при простых k.
Функция Вебба. Функцией Вебба называется функция
max (x, y) = max (x, y) + 1.
Эта функция является аналогом шефферовой функции в P2 : ее замыкание совпадает со всем Pk :
Следствие 2.1.1 (из теоремы 2.3). Система {Vk (x, y)} полна в Pk .
 Док-во. Сведем эту систему к системе Поста. Отождествим переменные: Vk (x, x) = x + 1 = x. Затем применим k − 1
раз полученное отрицание Поста к самой функции Вебба: Vk (x, y) − 1 = max (x, y).

Следствие 2.1.2 (из следствия 2.1.1). Из любой полной системы в Pk можно выделить полную конечную подсистему.
 Док-во. Действительно, если система A полна, то функция Вебба реализуется формулой над A : Vk (x, y) =
F ( fi1 , . . . , fir ) , fi j ∈ A ∀ j = 1, r. Но тогда система функций { fi1 , . . . , fir } также полна.


71

2.1. ФУНКЦИИ КОНЕЧНОЗНАЧНОЙ ЛОГИКИ
Примеры.
1. Используя метод сведения к заведомо полным системам, доказать полноту в Pk следующих систем:

(a) J0 (x) , J1 (x) , . . . , Jk−1 (x) , x2 , x−̇y .

 Решение. Отождествлением переменных в усеченной разности получаем константу 0: x−̇x = 0. Далее,
подставляя на место переменной функции J0 (x) эту константу, получаем константу k − 1. Подставляя k − 1 в
x2 , получаем константу 1. Таким образом, в исходной системе содержится заведомо полная система 6.

(b) {k − 1, x−̇y, x + y}.
 Решение. Суммируя k −1 раз константу k −1, получаем константу 1: k − 1 + · · · + k − 1 = 1. Таким образом,
|
{z
}
k−1

в исходной системе содержится заведомо полная система 6.



(c) {∼ x, x + 2, x−̇y}.
 Решение. Отождествлением переменных в усеченной разности получаем константу 0. Отрицание Лукасевича нуля равно константе k − 1. Затем, (k − 1) + 2 = 1. Таким образом, в исходной системе содержится
заведомо полная система 6.


(d) −x, 1 − x2 , x−̇y .
 Решение. x−̇x = 0, 1 − 02 = 1, −1 = k − 1. Таким образом, в исходной системе содержится заведомо полная система 6.

(e) {x + y, (∼ x) −̇2y}.
 Решение. Заметим, что при k = 2 система не полна: x + y = x ⊕ y, (∼ x) −̇2y = x = x ⊕ 1 — содержатся в
классе линейных функций. При k > 3 верно следующее: x + x + · · · + x = 0, (∼ 0) −̇2 · 0 = k − 1, x−̇2 (k − 1) =
{z
}
|
k

x−̇ (k − 2) = jk−1 (x) , jk−1 (x + (k − 1)) = j0 (x). Таким образом, исходная система сведена к системе 7, которая
полна при k > 3.

2. Подобрав подходящий класс типа T (E ) или U (D), доказать, что система A не полна в Pk .

(a) A = ∼ s, min (x, y) , x · y2 .
 Решение. Утверждается, что для E = {0, k − 1} система A ⊆ T (E ). Действительно, ∼ 0 = k − 1, ∼
(k − 1) = 0, функция минимум сохраняет любое множество, 0 · 02 = 0 · (k − 1)2 = (k − 1) · 02 = 0, (k − 1) ·
(k − 1)2 = k − 1. Следовательно, при k > 3 система не полна. При k = 2, очевидно, система полна, так как
первые две функции превращаются в отрицание и конъюнкцию и образуют базис в P2 .

n
o
(b) A = 1, 2, x−̇ j2 (x), max (x, y) .
 Решение. Утверждается, что для E = {1, 2} система A ⊆ T (E ). Действительно, константы сохраняют
это множество, максимум сохраняет любое множество, а 1−̇ j2 (1) = 2−̇ j2 (2) = 2. Следовательно, при k > 3
система полна. При k = 2 рассматривать систему не имеет смысла, так как она содержит константу 2.

(c) A = {2, j0 (x) , x + j0 (x) + J1 (x) + Jk−1 (x) , min (x, y)}.
 Решение. Утверждается, что для D = {0, 1} {2, . . . , k − 1} система A ⊆ U (D). Действительно, константа
2 сохраняет любое разбиение, функция минимума сохраняет любое монотонное разбиение, а D монотонно,
то есть все элементы одного блока находятся в одном и том же отношении порядка со всеми элементами
другого. И, наконец, обозначив f (x) = x + j0 (x) + J1 (x) + Jk−1 (x), имеем 1 = f (0) ∼ f (1) = 0 (mod D) f (a) ∼
f (b) (mod D) ∀a, b ∈ {2, . . . , k − 1} : f (a) , f (b) ∈ {2, . . . , k − 2}. Следовательно, при k > 3 система не полна.
При k = 2 рассматривать систему не имеет смысла, так как она содержит константу 2.

(d) A = {J2 (x) , x + j0 (x) , x + j0 (x) + J1 (x) , max (x, y)}.
 Решение. Утверждается, что для E = {0, 1} система A ⊆ T (E ). Действительно, J2 (0) = J2 (1) = 0, 0 +
j0 (0) = 1, 1 + j0 (1) = 1, 0 + j0 (0) + J1 (0) = 1 + j0 (1) + J1 (1) = 1, а функция максимума сохраняет любое
множество. Следовательно, при k > 3 система не полна. При k = 2 рассматривать систему не имеет смысла,
так как она содержит функцию J2 (x).


72

ГЛАВА 2. КОНЕЧНОЗНАЧНЫЕ ЛОГИКИ
(e) A = {k − 1, J0 (x) , x−̇y, x · y · z}.
 Решение. Утверждается, что для E = {0, k − 1} система A ⊆ T (E ). Действительно, константа сохраняет любое множество, содержащее ее как элемент, J0 (0) = k − 1, J0 (k − 1) = 0, 0−̇0 = 0−̇ (k − 1) =
(k − 1) −̇ (k − 1) = 0, (k − 1) −̇0 = k − 1, 0 · 0 · 0 = 0 · 0 · (k − 1) = 0 · (k − 1) · 0 = 0 · (k − 1) · (k − 1) = (k − 1) · 0 · 0 =
(k − 1) · 0 · (k − 1) = (k − 1) · (k − 1) · 0 = 0, (k − 1) · (k − 1) · (k − 1) = k − 1. Следовательно, при k > 3 система не
полна. При k = 2 легко видеть, что система полна, так как первая функция — константа 1 — не сохраняет
ноль и не является самодвойственной, вторая функция превращается в отрицание, которое не монотонно и
не сохраняет единицу, а четвертая функция не линейная.


(f) A = 2x3 , 2x + y, x2 y, xJ0 (y) , x2 + (∼ y) .
 Решение. Утверждается, что для E = {0} система A ⊆ T (E ). Действительно, 2·03 = 0, 2·0+0 = 0, 02 ·0 =
2
0, 0 · J0 (0) = 0, 0 + (∼ 0) = 0. Следовательно, при k > 2 система не полна.

(g) A = {x · y, max (x, y) − z + 1}.
 Решение. Утверждается, что для E = {1} система A ⊆ T (E ). Действительно, 1 · 1 = 1, max (1, 1) − 1 + 1 =
1. Следовательно, при k > 2 система не полна.

 2
(h) A = −x , max (x, y) + z .
 Решение. Утверждается, что для E = {k − 1} система A ⊆ T (E ). Действительно,
− (k − 1)2 = k − 1, max (k − 1, k − 1) + k − 1 = k − 1.
Следовательно, при k > 2 система не полна.
n
o
(i) A = 1, −x · y, x2 −̇y .



 Решение. Утверждается, что для E = {1, k − 1} система A ⊆ T (E ). Действительно, константа единица
сохраняет это множество, −1·1 = − (k − 1)·(k − 1) = k −1, −1·(k − 1) = − (k − 1)·1 = 1, 12 −̇1 = 12 −̇ (k − 1) =
(k − 1)2 −̇1 = (k − 1)2 −̇ (k − 1) = 1. Следовательно, при k > 2 система не полна.



(j) A = {2, max (x, y) , x−̇y}.
 Решение. Утверждается, что для E = {0, 2} система A ⊆ T (E ). Действительно, константа 2 сохраняет
это множество, функция максимума сохраняет любое множество, а 0−̇0 = 0−̇2 = 2−̇2 = 0, 2−̇0 = 2. Следовательно, при k > 3 система не полна. При k = 2 рассматривать систему не имеет смысла, так как она
содержит константу 2.

(k) A = {k − 2, ∼ jk−2 (x) , max (x, y) , x + y}.
 Решение. Утверждается, что для E = {k − 2} система A ⊆ T (E ). Действительно, константа k − 2 сохраняет это множество, функция максимума сохраняет любое множество, а ∼ jk−2 (k − 2) = k − 2, k − 2 + k − 2 =
k − 2. Следовательно, при k > 2 система не полна.

(l) A = { j2 (x) , x + j0 (x) + J1 (x) , x · y, x−̇y}.
 Решение. Утверждается, что для E = {0, 1} система A ⊆ T (E ). Действительно, j2 (0) = j2 (1) = 0, 0 +
j0 (0) + J1 (0) = 1, 1 + j0 (1) + J1 (1) = 0, 0 · 0 = 0 · 1 = 1 · 0 = 0, 1 · 1 = 1, 0−̇0 = 0−̇1 = 1−̇1 = 0, 1−̇0 = 1.
Следовательно, для k > 3 система не полна. При k = 2 рассматривать систему не имеет смысла, так как она
содержит функцию j2 (x).

(m) A = {1, J0 (x) , x + jk−1 (x) , min (x, y) , max (x, y)}.
 Решение. Утверждается, что для D = {0} {1, . . . , k − 1} система A ⊆ U (D). Действительно, константа сохраняет любое разбиение, функции минимума и максимума сохраняют любое монотонное разбиение, а D в
данном случае — монотонное, функция J0 (x) сохраняет D очевидным образом: при x 6= 0 все значения J0
равны 0, то есть попадают в один блок, а блок, состоящий из одного элемента сохраняет любая функция.
Обозначив третью функцию через f (x), имеем f (a) ∈ {1, . . . , k − 1} ∀a ∈ {1, . . . , k − 1}. Следовательно, для
k > 3 система не полна. При k = 2 система, очевидно, полна, так как вторая функция превратится в отрицание, а четвертая в конъюнкцию.


73

2.1. ФУНКЦИИ КОНЕЧНОЗНАЧНОЙ ЛОГИКИ
(n) A = {1, 2, . . . , k − 1, x + j0 (x) , j2 (x) + 1, max (x, y)}

 Решение. Утверждается, что для D = {0, 1} {2} {3, . . . , k − 1} система A ⊆ U (D). Действительно, константы сохраняют любое разбиение, функция максимума сохраняет данное разбиение в силу его монотонности, функция x + j0 (x) переставляет элементы в первом блоке, а остальные оставляет неподвижными,
функция j2 (x) + 1 отображает элементы первого блока в единицу, второй блок оставляет неподвижным, а
элементы третьего блока отображает в единицу. Следовательно, при k > 3 система не полна. При k = 2 рассматривать систему не имеет смысла, так как она содержит функцию j2 (x) + 1.

n
o
(o) A = 1, ∼ x, x−̇y, min (x, y)
 Решение. Утверждается, что для E = {1, k − 2} система A ⊆ T (E ). Действительно, константа, отрицание
Лукасевича и минимум тривиально сохраняют это множество. Также 1−̇1 = 1−̇ (k − 2) = (k − 2) −̇ (k − 2) =
1, (k − 2) −̇1 = k − 2. Следовательно, при k > 3 система не полна. При k = 2 система, тривиально, полна,
потому что отрицание Лукасевича, тривиально, перейдет в простое отрицание, а минимум — в конъюнкцию.

(p) A = {∼ x, J0 (x) , J1 (x) , . . . , Jk−1 (x) , min (x, y) + ( j0 (x) + j0 (y)) · (x + y)}
 Решение. Утверждается, что для D = {0, k − 1} {1, . . . , k − 2} система A ⊆ U (D). Действительно, образы
отрицания Лукасевича и всех Ji совпадает с первым блоком. Обозначим последнюю функцию через f (x, y).
Если и x, и y принимают значение из второго блока, то и f (x, y) примет значение также из второго блока (второе слагаемое обнулится, а минимум не выводит за пределы одного блока). Далее, f (0, 0) = 0, f (0, k − 1) =
f (k − 1, 0) = f (k − 1, k − 1) = k − 1, то есть первый блок переходит посредством f (x, y) в первый блок. Пусть
теперь a из второго блока. Легко видеть, что f (0, a) = f (k − 1, a) = a, а также, f (x, y) = f (y, x), откуда следует, что наборы со значениями из разных блоков отображаются все во второй блок. Следовательно, при
k > 3 система не полна. При k = 2 система полна, так как отрицание Лукасевича перейдет в простое отрицание, которое не сохраняет константы и не монотонно, а последняя функция станет равна xy ⊕ x ⊕ y, при этом
являясь нелинейной и несамодвойственной.

3. Пусть E — непустое подмножество из Ek , отличное от всего Ek , и D = {E , Ek \ E }. Подсчитать число функций в
Pk , зависящих от переменных x1 , x2 , . . . , xn (n > 0) и содержащихся в множестве:
(a) T (E ) \U (D);
(b) U (D) \ T (E );
(c) T (E ) ∪U (D).
e n назовем вектор из нулей и единиц (δ1 , . . . , δn ), где
 Решение. Для начала найдем |U (D)|hni . Типом набора α
e n и βen назовем
δi = 0 ⇔ αi ∈ E . Все множество наборов разобьем на классы эквивалентности: два набора α
e n k назовем число единиц в его типе δen .
эквивалентными, если они имеют одинаковый тип. Весом набора kα
Всего классов эквивалентности — 2n . В одном классе эквивалентности с весом l содержится (k − m)l mn−l различных наборов. Каждому такому набору внутри одного класса эквивалентности функцией, сохраняющей разбиение, ставится в соответствие либо одно из m значений из E , либо одно из k − m значений из Ek \ E , причем эти
возможности несовместны. Итак, число функций, сохраняющих разбиение внутри класса эквивалентности веса l
n−l

l

n−l

l

равно mm (k−m) +(k − m)m (k−m) . Поскольку классы эквивалентности не пересекаются, всего разных функций,
зависящих от одних и тех же n переменных, сохраняющих данное разбиение —

∏

e
t ∈Bn



n
n 
e
e
t (t )
t
n−t
n−t
mn−ket k (k−m)kt k
mn−ket k (k−m)kt k
m
+ (k − m)
= ∏ mm (k−m) + (k − m)m (k−m)
.
t=0

Теперь легко сказать, сколько функций содержится в пересечении: если в наборе все переменные из E , то им
ставятся в соответствие значения только из E , то есть при t = 0 второе слагаемое пропадает:
n
n 
t (t )
t
n−t
n
n−t
|T (E ) ∩U (D)|hni = mm · ∏ mm (k−m) + (k − m)m (k−m)
.
t=1

n

Для того, чтобы ответить на поставленные вопросы осталось вспомнить, что |T (E )|hni = mm kk
зом,

n −mn

. Таким обра-

74

ГЛАВА 2. КОНЕЧНОЗНАЧНЫЕ ЛОГИКИ
(a)
|T (E ) \U (D)|hni = |T (E )|hni − |T (E ) ∩U (D)|hni
n
n 
t (t )
t
n−t
n−t
n
n
n
n
= mm · kk −m − mm · ∏ mm (k−m) + (k − m)m (k−m)
t=1

mn

=m

· k

kn −mn

n

−∏ m


mn−t (k−m)t

mn−t (k−m)t

+ (k − m)

(n)
t

!
,

t=1

(b)
|U (D) \ T (E )|hni = |U (D)|hni − |T (E ) ∩U (D)|hni
n
n 
t (t )
t
n−t
n−t
= ∏ mm (k−m) + (k − m)m (k−m)
t=0

n
n 
t (t )
t
n−t
n−t
n
− mm · ∏ mm (k−m) + (k − m)m (k−m)
t=1

n
n 
t (t )
t
n−t
n
n−t
,
= (k − m)m · ∏ mm (k−m) + (k − m)m (k−m)
t=1

(c)
|T (E ) ∪U (D)|hni = |T (E )|hni + |U (D)|hni − |T (E ) ∩U (D)|hni
n
n 
t (t )
t
n−t
n
n
n
n−t
= mm kk −m + ∏ mm (k−m) + (k − m)m (k−m)
t=0

mn

−m

 n−t
n
t (t )
t
n−t
· ∏ mm (k−m) + (k − m)m (k−m)
n

t=1

n

= mm kk

n −mn

n
n 
t (t )
t
n
n−t
n−t
.
+ (k − m)m · ∏ mm (k−m) + (k − m)m (k−m)
t=1


4. Исследовать на полноту в Pk следующие системы:
(a) {k − 1, x + 2, max (x, y)}.
 Решение. Возможны два случая:
i. k > 3 — нечетное. Тогда x + 2 + · · · + 2 = x + 1 = x, и исходная система содержит систему Поста, которая
| {z }
k+1
2

раз

является полной в Pk .
ii. k > 4 — четное. В этом случае утверждается, что для E = {1, 3, . . . , k − 1} исходная система содержится
в T (E ), то есть сохраняет нечетное множество и является неполной.
Рассматривать систему при k = 2 не имеет смысла, так как она содержит функцию x + 2.
n
o
(b) 1, x, x−̇y .



 Решение. Утверждается, что для E = {1, 2} исходная система содержится в T (E ). Действительно, константы сохраняют это множество, и 1−̇1 = 1−̇2 = 2−̇2 = 1, 2−̇1 = 2. Следовательно, для k > 3 система не
полна. Рассматривать систему при k = 2 не имеет смысла, так как она содержит константу 2.

(c) {k − 2, x + y, min (x, y)}.
 Решение. Возможны два случая:
i. k > 2 — четное. В этом случае, подобно 4(a)ii, система сохраняет четное множество.
ii. k > 3 — нечетное. Тогда x + (k − 2) + · · · + (k − 2) = x, и исходная система содержит систему Поста, ко|
{z
}
k−1
2

торая является полной в Pk .

раз

75

2.1. ФУНКЦИИ КОНЕЧНОЗНАЧНОЙ ЛОГИКИ


(d)


 
1, k − 1, x−̇ 2k , min (x, y) .

   k 
 Решение. Утверждается, что для D = 0, . . . , 2k
2 + 1, . . . , k − 1 исходная система содержится в
U (D). Действительно, константы сохраняют любое разбиение, минимум сохраняет любое монотонное разбиение, а D — монотонное. Далее, третья функция отображает первый блок в 0, а второй блок в первый.
Следовательно, при k > 3 система не полна. При k = 2 система также не полна, так как целиком содержится
в классе монотонных функций (в случае k = 2 она превратится в {0, 1, x · y}).


5. Выделить базис из полной в Pk системы A :
(a) A = {k − 1, j0 (x) , j1 (x) , . . . , jk−1 (x) , x · y, x−̇y}.
 Решение. Рассмотрим подсистему B = {k − 1, x−̇y, jk−1 (x)} ⊂ A . Она является полной, так как
jk−1 (k − 1) ≡ 1 и система сводится к полной системе 6. Докажем, что если убрать из нее любую функцию,
(1)
она перестанет быть полной. Действительно, A \ {k − 1} ⊆ T ({0}) , A \ {x−̇y} ⊆ Pk , C = A \ { jk−1 (x)} ⊆
T ({0, k − 1}). Последнее равенство, однако, не доказывает неполноту в случае k = 2. При k = 2 A \ { jk−1 (x)}
является и полной системой, и базисом, так как k − 1 = 1 — не сохраняет 0 и не самодвойственная, а вторая
— x−̇y = xy ⊕ x — нелинейная, не сохраняет единицу и не монотонная. Следовательно, при k > 3 базисом
является система B, а при k = 2 — система C .


(b) A = x − 2, J0 (x) , max (x, y) , x−̇y2 , x2 · y .

 Решение. Рассмотрим подсистему B = J0 (x) , x−̇y2 . Покажем, что она полная. Действительно,
(. . . (J0 (x) −̇J02 (x))−̇ · · · −̇J02 (x))−̇ J02 (x) ≡ 0, J0 (0) = k − 1, x−̇ (k − 1)2 ≡ x−̇1, (k − 1) −̇1 = k − 2, (k − 2) −̇1 =
|
{z
}
k−1 раз

k − 3, . . . , 2−̇1 = 1. Таким образом получены
все константы и функции вида x−̇m для любого m = 1, k − 1.
(
k − 1 x 6 m,
Используя тот факт, что J0 (x−̇m) =
получим теперь все Jm для 0 6 m 6 k − 1:
0
x > m,
Jm (x) = (. . . (J0 (x−̇m) −̇J02 (x−̇ (m − 1)))−̇ · · · −̇J02 (x−̇ (m − 1)) −̇ J02 (x−̇ (m − 1)) .
|
{z
}
k−1 раз

Далее заметим, что
x−̇y ≡ (. . . (x−̇J12 (y))−̇J22 (y))−̇J22 (y))−̇ · · · ) −̇Ji2 (y))−̇Ji2 (y))−̇ · · · )−̇ Ji2 (y))
|
{z
}
i раз

2
2
−̇ · · · ) −̇Jk−1
(y))−̇ · · · )−̇ Jk−1
(y)
|
{z
}
k−1 раз

Действительно, при y = i только квадраты соответствующих Ji будут равны единицам, остальные же будут
нулями. Следовательно, из x при y = i будет усеченно вычитаться как раз i. Таким образом, система A сведена к системе 6: получены усеченная разность и константы 0 и k − 1. Базисность этой системы при условии
полноты очевидна: первая функция существенно зависит только от одной переменной, а вторая сохраняет,
например, ноль.


(c) A = 2, j0 (x, ) , x + y2 , x2 −̇y, x · y · z

 Решение. Рассмотрим подсистему B = j0 (x) , x + y2 . Докажем ее полноту. Заметим, что j0 ( j0 (x)) +
j02 (x) ≡ 1, x + 12 = x. Имея отрицание Поста и j0 можно получить все ji для 0 6 i 6 k − 1. Далее, используя
тот же прием, что и в примере 5b, получим x + y = x + j12 (y) + j22 (y) + j22 (y) + · · · + ji2 (y) + · · · + ji2 (y) + · · · +
|
{z
}
i раз

2
j2 (y) + · · · + jk−1
(y). Таким образом, система B сводится к системе 7, которая полна при k > 3. При k = 2
|k−1
{z
}
k−1 раз

система B теряет смысл, так как содержит константу 2. Базисность B очевидна: как и в 5b одна из функций
существенно зависит только от одной переменной, а вторая — сохраняет ноль.


76

ГЛАВА 2. КОНЕЧНОЗНАЧНЫЕ ЛОГИКИ

Упражнения.
1. Используя метод сведения к заведомо полным системам, доказать полноту в Pk следующих систем:
(a) {x, min (x, y)};
(b) {min (x, y) − 1};

(c) J0 (x) , x + y, x · y2 ;

(d) 1, x2 + y, x2 −̇y ;

(e) J0 (x) , x + y, x · y2 ;
(f) {k − 2, xẏ + 1, (∼ x) −̇y};

(g) k − 1, x2 − y, x2 −̇y ;
(h) {1, 2 · x + y, x−̇y};

(i) 1, x2 − y, min (x, y) ;

(j) 1, x + y + 2, x2 −̇y ;
(k) {x · j0 (y) , min (x, y)}.
2. Подобрав подходящий класс типа T (E ) или U (D), доказать, что система
A = {1 − x, j0 (x) , j1 (x) , . . . , jk−1 (x) , x · y, x−̇y, min (x, y)}
не полна в Pk .
3. Как известно (см. теорему 2.2), система
A = {0, 1, . . . , k − 1, j0 (x) , j1 (x) , . . . , jk−1 (x) , x + y, x · y}
полна в Pk .
(a) Доказать, что из системы A можно выделить полную в Pk подсистему, состоящую из двух функций.
(b) Показать, что любая подсистема системы A , состоящая из одной функции, не полна в Pk .
4. Система Россера-Туркетта
A1 = {0, 1, . . . , k − 1, J0 (x) , J1 (x) , . . . , Jk−1 (x) , min (x, y) , max (x, y)} ,
как известно, полна в Pk (см. теорему 2.1).
(a) Проверить, что, удаляя из A1 любую константу, отличную от 0 и k − 1, получаем подсистему, содержащуюся
в некотором классе типа T (E ), где ∅ 6= E 6= Ek (и, значит, неполную в Pk ).
(b) Выделить из системы A1 полную в Pk подсистему, состоящую из 2k − 2 функций.
5. Для заданных k исследовать на полноту следующие подсистемы системы Россера-Туркетта:
(a) k = 3, {1, J0 (x) , J2 (x) , min (x, y) , max (x, y)};
(b) k = 3, {1, 2, J2 (x) , min (x, y) , max (x, y)};
(c) k = 4, {1, 2, J0 (x) , J1 (x) , min (x, y) , max (x, y)};
(d) k = 4, {1, 2, J0 (x) , J3 (x) , min (x, y) , max (x, y)}.
6.

(a) Для k = 3, 4 и 5 подсчитать число различных замкнутых классов в Pk , являющихся классами сохранения
разбиений.
(b) Пусть D = {E1 , . . . , Es } — разбиение множества Ek . Подсчитать число функций в Pk , содержащихся в классе
U (D) и зависящих от переменных x1 , x2 , . . . , xn (n > 0).

7. Исследовать на полноту в Pk следующие системы:
(a) {0, 1, x−̇ (∼ y)};

(b) 2, 2x + y, x2 −̇y ;
(c) {1, 2, max (x, y)};
(d) {2−̇x, x · y, max (x, y)};
(e) {k − 2, 2x + y, x−̇y};

77

2.2. ТЕОРЕМЫ О ФУНКЦИОНАЛЬНОЙ ПОЛНОТЕ
(f) {∼ x, −x · y, min (x, y)};
(g) {2, x + y, x−̇y};
(h) {∼ x, 2 j0 (x) , J1 (x) , x−̇y};
(i) {1, ∼ x, J0 (x) + J1 (x) , max (x.y)};
(j) {0, 1, ∼ x, 2 − j0 (x) − 2 j1 (x) , min (x, y)};
(k) {k − 2, ∼ x, x−̇y};

2.2 Теоремы о функциональной полноте
Теорема об алгоритмической разрешимости проблемы распознавания полноты в k-значной логике. Рассмотрим конечную систему функций A = { f1 , . . . , fm }, зависящих от одних и тех же n переменных x1 , . . . , xn . Обозначим
gnm (x1 , . . . , xn ) = xm — селекторную функцию для 1 6 m 6 n. Используем две из них: g21 (x1 , x2 ) = x1 , g22 (x1 , x2 ) = x2 .
Теорема 2.4. Существует алгоритм, распознающий в Pk при k > 2 полноту любой конечной системы.
 Док-во. Построим последовательность вложенных друг в друга множеств
N 0 = ∅ : N0

N1

N2

···

Nr

Nr+1

···

Nr∗ = Nr∗ +1 = · · ·

по следующим индуктивным правилам: N1 — множество всех
 2 функций двух переменных, реализуемых формулами виg
да f (H1 (x1 , x2 ) , H2 (x1 , x2 ) , . . . , Hn (x1 , x2 )), где Hi (x1 , x2 ) = 12 . Заметим, что |N1 | 6 m · 2n (поскольку всего функций
g2
в A — m, все зависят от n переменных, на месте каждой из которых стоит одна из двух функций). Пусть уже построены все классы, до r-го включительно, и |Nr | = sr . Тогда класс Nr+1 — это множество всех
двух пере функций
g21
менных, реализуемых формулами вида f (H1 (x1 , x2 ) , H2 (x1 , x2 ) , . . . , Hn (x1 , x2 )), где Hi (x1 , x2 ) =  g22 . Очевидно, что
hi ∈ Nr
|Nr+1 | 6 m · (sr + 2)n . Это следует из того, что любая функция из Nr+1 реализуется формулой над Nr+1 . Все функции
2
2
из Nr зависят от двух переменных. Поскольку всего функций от двух переменных kk , не более, чем за kk + 2 шагов
возникнет ситуация, Nr∗ = Nr∗ +1 = · · ·. Как только построен последний уникальный класс, мы проверяем наличие в
нем функции Вебба. Если она в нем есть, то мы свели систему к функции Вебба, следовательно, система полна. Если
же функция Вебба не содержится в последнем уникальном классе, то система не полна в силу следующих рассуждений. Выделяем из замыкания исходной системы функций A функции, зависящие только от x1 , x2 — множество [A ]x1 ,x2 .
Очевидно, [A ]x1 ,x2 = Nr∗ . В то же время, если бы A была бы полна, то она содержала бы функцию Вебба Vk (x1 , x2 ).
Следовательно, в этом случае система не полна.

Теорема Кузнецова о функциональной полноте. В этом пункте мы покажем существование системы 2.5 в Pk для
любого k. Рассмотрим N — некоторое множество функций k-значной логики, зависящих от переменных y1 , . . . , ym . Для
удобства будем считать, что сами переменные в это множество включены: yi = gm
i (y1 , . . . , ym ) ∈ N.
Определение. Функция k-значной логики f (x1 , . . . , xn ) сохраняет N, если для любых h1 , . . . , hn ∈ N суперпозиция
f (h1 , . . . , hn ) ∈ N. Множество функций M ссохраняет N, если все функции, сохраняющие N, заключены в M.
Пример . Пусть m = 1, N : f (∼ y) =∼ f (y). Множество N содержит, например, тождественную функцию, само отрицание Лукасевича. Множество функций, сохраняющих данное N, является множеством всех самодвойственных функций:
M :∼ g (∼ x1 , . . . , ∼ xn ) = g (x1 , . . . , xn ). Действительно, для любых h1 (y) , . . . , hn (y) ∈ N ⇒ F (y) = f (h1 (y) , . . . , hn (y)) =
f (∼ h1 (∼ y) , . . . , ∼ hn (∼ y)) ∈ N, то есть F (∼ y) =∼ F (y) ⇔∼ f (∼ x1 , . . . , ∼ xn ) = f (x1 , . . . , xn ). Заметим, что сами функции f (y) входят в M.
Лемма 2.2.1. Пусть N — множество функций, зависящих от переменных y1 , . . . , ym , содержащее тождественные функции gm
i , а M — множество функций, сохраняющих N. Тогда M замкнуто.
 Док-во. Так как тождественные функции сохраняют N, достаточно доказать, что суперпозиция сохраняющих N
функций также сохраняет N. Пусть f (z1 , . . . , zl ) , fi (x1 , . . . , xn ) ∈ M, i = 1, l, то есть для любых h1 , . . . , hn ∈ N выполняется fi (h1 , . . . , hn ) ∈ N. Рассмотрим суперпозицию F (x1 , . . . , xn ) = f ( f1 , . . . , fl ). Для любых h1 , . . . , hn ∈ N ⇒ Hi =
fi (h1 , . . . , hn ) ∈ N для всех i = 1, l. Но тогда и F (h1 , . . . , hn ) = f (H1 , . . . , Hl ) ∈ N.

Лемма 2.2.2. Пусть N — множество функций, зависящих от переменных y1 , . . . , ym , содержащее тождественные функции gm
i и [N]y1 ,...,ym = N. Тогда для M, сохраняющего N, выполнено My1 ,...,ym = N.

78

ГЛАВА 2. КОНЕЧНОЗНАЧНЫЕ ЛОГИКИ

 Док-во. Рассмотрим любую функцию f (y1 , . . . , ym ) ∈ N. Для любых h1 , . . . , hn ∈ N по условию теоремы
f (h1 , . . . , hm ) ∈ [N]y1 ,...,ym = N ⇒ f ∈ M, и при этом она зависит от y1 , . . . , ym , то есть f ∈ My1 ,...,ym . Таким образом,
N ⊆ My1 ,...,ym .
m
Обратно: для любой функции f ∈ My1 ,...,ym ⇒ f (y1 , . . . , ym ) = f (gm
1 , . . . , gm ) ∈ N в силу замкнутости N по переменным
y1 , . . . , ym . Следовательно, My1 ,...,ym ⊆ N.
Из доказанного немедленно вытекает, что N = My1 ,...,ym .

Теорема 2.5 (А.В. Кузнецов). Для любого k > 2 существует система, называемая критериальной, M1 , . . . , Ms
замкнутых классов, попарно не содержащих друг друга, таких, что любой класс функций A ⊆ Pk полон тогда и только тогда, когда A целиком не лежит ни в одном из классов M1 , . . . , Ms .
 Док-во. Построим эти классы. Рассмотрим множество всех функций Pkx1 ,x2 , зависящих от переменных x1 и x2 —
2

k2

всего их kk . Это множество имеет 2k подмножеств, из которых мы выбираем все подмножества Ni , i = 1, s0 , удовлетворяющие следующим трем условиям:
1. Ni не пусто и не совпадает с Pkx1 ,x2 для любого i = 1, s0 ,
2. Ni содержит тождественные функции g21 (x1 , x2 ) и g22 (x1 , x2 ) для любого i = 1, s0 и
3. Ni замкнуты по переменным x1 , x2 для любого i = 1, s0 .
Для каждого Ni строится замкнутый класс M0i функций, сохраняющих Ni . Всего M0i — конечное число. Упорядочим их
по включению. Как легко проверить, это будет являться частичным порядком. В построенном частично упорядоченном
множестве возьмем систему максимальных элементов M1 , . . . , Ms (s < s0 ), заметив, что Mi 6= Pk ∀i = 1, s. Последнее
вытекает из того, что если бы какой-то из них совпадал со всем Pk , то он в силу замкнутости содержал бы функцию
Вебба переменных x1 , x2 . Но тогда в силу замкнутости соответствующего Nl по лемме 2.2.2, Nl также совпадало бы со
всем Pk , что противоречит построению. Далее, любой класс M0i содержится в одном из классов этой системы. Очевидно,
что если A ⊆ Mi , то A не полна: [A ] ⊆ Mi Pk .
пусть A не лежит ни в одном из классов Mi , i = 1, s. Тогда рассмотрим систему M =
 Обратно,

A ∪ g21 (x1 , x2 ) , g22 (x1 , x2 ) ⊇ A . Очевидно, что A и M полны или не полны одновременно. Предположим, что M
неполная. Тогда в Mx1 ,x2 не содержится Vk (x1 , x2 ). По лемме 2.2.2 существует такое j, что Mx1 ,x2 = N j . Но тогда
M ⊆ M0j ⊆ Mk , где M0j — класс функций, сохраняющих N j , что противоречит тому, что A не лежит ни в одном из
классов Mi .

Можно тривиально оценить снизу число функций критериальной системы числом функций, сохраняющих множества: s > 2k − 2.

2.3

Существенные функции

Определение. Функция k-значной логики f называется существенной, если она существенно зависит не менее, чем
от двух переменных.
Леммы о существенных функциях.
Лемма 2.3.1 (о трех наборах). Пусть функция f (x1 , . . . , xn ) — существенная (x1 — ее существенная переменная) и принимает l > 3 различных значений. Тогда существует три набора вида
(α, α2 , . . . , αn ) ,
(β , α2 , . . . , αn ) ,
(α, γ2 , . . . , γn ) ,
на которых функция принимает три различных значения.
 Док-во. По предположению теоремы x1 — существенная переменная функции f . Это означает, что существуют
такие константы α1 , . . . , αn , что f (x1 , α1 , . . . , αn ) 6≡ const. Рассмотрим цепочку
(1, α2 , . .` . , αn )
2 ,` . . . , αn )
`P
` P (k − 1, α
P
P
P




P




PP`
PP`
PP
` 

` 
(0, α2 , . . . , αn )
`
(α, γ2 , . . . , γn )
Возможны два случая:

79

2.3. СУЩЕСТВЕННЫЕ ФУНКЦИИ

1. На этой цепочке функция принимает не все l значений. Тогда существует набор (α, γ2 , . . . , γn ), на котором функция
принимает оставшееся значение. Берем также проекцию этого набора на цепь (α, γ2 , . . . , γn ) и какой-то другой
набор с цепи (β , α2 , . . . , αn ). На полученных трех наборах функция принимает три разных значения.
2. На цепи принимаются все значения. Но у f есть по крайней мере еще одна существенная переменная, то есть
существуют такие α, γ2 , . . . , γn , что f (α, α2 , . . . , αn ) и f (α, γ2 , . . . , γn ) различны. Кроме этих двух значений берем
еще одно с цепи.

Лемма 2.3.2 (Основная). Пусть f — существенная функция, принимающая l > 3 различных значений, и x1
— ее существенная переменная. Тогда существуют множества Qi ⊆ Ek , i = 1, n : |Qi | 6 l − 1 такие, что на
Q1 × Q2 × · · · × Qn функция f принимает все свои l значений.
 Док-во. Дополним три набора из леммы 2.3.1 l − 3-мя наборами так, чтобы получилось l наборов, на которых функция принимает все свои значения:
(α ,
α2 , . . . ,
αn )
(β ,
α2 , . . . ,
αn )
(α ,
γ2 ,
...,
γn )
α14 ,
α24 , . . . ,
αn4
. . . . . . . . . . . . . . . . . . . .
α1l−3 , α2l−3 , . . . , αnl−3
Q1
Q2
...
Qn
Множество первых разрядов обозначим Q1 , его мощность благодаря равенству первых разрядов первого и третьего
наборов не превосходит l − 1; множество i-ых разрядов обозначим Qi для i = 2, n, его мощность благодаря равенству
i-ых разрядов для i = 2, n также не превзойдет l − 1. По построению наборов, на их декартовом произведении функция
примет все свои значения.

Лемма 2.3.3 (о квадрате). Пусть f — существенная функция, принимающая l > 3 различных значений, и x1
— ее существенная переменная. Тогда существует четверка наборов, называемая квадратом, вида

α1 , . . . , αi−1 , α, αi+1 , . . . , α j−1 , γ, α j+1 , . . . , αn 
α1 , . . . , αi−1 , α, αi+1 , . . . , α j−1 , δ , α j+1 , . . . , αn
,
α1 , . . . , αi−1 , β , αi+1 , . . . , α j−1 , γ, α j+1 , . . . , αn 
α1 , . . . , αi−1 , β , αi+1 , . . . , α j−1 , δ , α j+1 , . . . , αn
на вершинах которого функция либо принимает не менее трех различных значений, либо принимает два
значения, но одно из них только на одной вершине. Иными словами, одна из вершин квадрата является
уникальной.
 Док-во. Согласно лемме 2.3.1 найдутся три набора указанного вида такие, что функция на них принимает три различных значения a, b и c. Два набора находятся в одной гиперплоскости, а третий — в другой, но является проекцией
первого. Рассмотрим первый квадрат, две вершины которого равны соответственно a и b. Если среди оставшихся двух
вершин есть одна, значение на которой отлично от значений на первых двух или значения на них равны, то лемма доказана.
x = β (β , α2 , . . .` , αn ) `
(β` , γ2 , . . . , γn ) 
!
!
!

a!
` ! \!
` ! \!
` ! \` 

a(b)

a(b)

b(a)
b(a)
`
`
!
!
!`

x=α


` ! \!
` ! \!
` !
b!
\` c


1
(α, γ2 , .
. . , γn ) 
 (α, α2 , . . . , αn )




В противном случае, если на одной вершине значение равно a, а на другой — b, то перейдем к рассмотрению следующего
квадрата. Для него повторим все эти рассуждения. Если мы таким образом дойдем до последнего квадрата, что будет
означать, что во всех предыдущих квадратах на одних двух вершинах принимается значение a, а на других двух — b, то
утверждение леммы выполнится потому, что в последнем квадрате будет три различных значения.


80

ГЛАВА 2. КОНЕЧНОЗНАЧНЫЕ ЛОГИКИ

Теоремы о существенных функциях.
Теорема 2.6 (С.В. Яблонский). Система функций, содержащая все одноместные функции, принимающие
не более k − 1 различных значений (CSk ) полна тогда и только тогда, когда она содержит существенную
функцию, принимающую все k значений.
 Док-во. Необходимость доказывается от противного. Возможны два варианта.
1. Система вообще не содержит существенных функций. В этом случае она, очевидно, не полна, так как содержится
(1)
в классе Pk .
2. Система содержит существенную функцию, но она принимает (не ограничивая общности) k − 1 значение. Но тогда подстановкой на места переменных этой функции других функций системы нельзя получить существенную
функцию двух переменных, принимающую все k значений, например, x + y.
Таким образом, в этом случае система не полна.
Достаточность. Пусть система содержит CSk и существенную функцию, принимающую все k значений. В этом случае, очевидно, все константы принадлежат системе. Докажем достаточность системы по индукции.
Базис индукции. Построим все функции, принимающие не более двух значений. Для функции f справедлива лемма 2.3.3, то есть существует квадрат,
 на одной из вершин которого принимается уникальное значение a:
f α1 , . . . , αi−1 , x, αi+1 , . . . , α j−1 , y, α j+1 , . . . , αn равно a при x = α и y = β . Рассмотрим функции, существенно зависящие от одной переменной, и принимающие не более k − 1 значения, заведомо содержащиеся в исходной системе
(
(
(
α x = 0,
β y = 0,
0 z = a,
t1 (x) =
t2 (y) =
t (z) =
β x 6= 0,
α y 6= 0,
1 z 6= a.
и возьмем третью от f , на местах переменных x и y у которой стоят первые две:
t f α1 , . . . , αi−1 ,t1 (x) , αi+1 , . . . , α j−1 ,t2 (y) , α j+1 , . . . , αn



= ∨0,1 (x, y) .

Эту функцию назовем дизъюнкцией x и y. По аналогии построим конъюнкцию:
&0,1 (x, y) = j0 (∨0,1 ( j0 (x) , j0 (y))) .
Для функции произвольной f (e
xn ) 6≡ const, принимающей только значения 0 и 1, построим формулу, ее реализующую:
f (e
xn ) =

_

jα1 (x1 ) · jα2 (x2 ) · · · jαn (xn ) .

(α1 ,...,αn )
f (α1 ,...,αn )=1

Теперь можно реализовать и любую функцию,
принимающую любые два значения: если f (e
xn ) принимает два значения
(
σ1 x = 0,
∈ CSk , можно реализовать f формулой
σ1 и σ2 , то, используя функцию h (x) =
σ2 x 6= 0


h



_
(α1 ,...,αn )
f (α1 ,...,αn )=1


jα1 (x1 ) · jα2 (x2 ) · · · jαn (xn )
.

Предположение индукции. Пусть реализованы все f ∈ Pk , принимающие не более l − 1 различных значений.
Индуктивный переход. Реализуем произвольную функцию g (e
ym ), принимающую l различных значений τ1 , . . . , τl .
Разделим два случая.
1. l − 1 6 k − 2. Реализуем существенную функцию, принимающую l 6 k − 1 различных значений. По основной лемме
найдутся наборы




 (α, α2 , . . . , αn ) βe1 δ1




3
(β , α2 , . . . , αn ) βe2 δ2





(α, γ2 , . . . , γn ) βe3 δ3
l
,

 e

β4 δ4

 β14 , β24 , . . . , βn4



.................
l −3




. . . . . . . . . . . βel δl

81

2.3. СУЩЕСТВЕННЫЕ ФУНКЦИИ

на которых функция f принимает l различных значений. Далее si (e
ym ) — функции, принимающие l − 1 значение.
y1 , . . . , ym
...
...
...
...

s1 (e
ym ) s2 (e
ym ) . . . sn (e
ym )
βe1
βe2
..
.
e
βl

g
τ1
τ2
..
.
τl

f (s1 , . . . , sn )
δ1
δ2
..
.

n ( f (e
s))
τ1
τ2
..
.

δl

τl

e
Таким образом, во всех столбцах, составленных из i-х разрядов
не более, чем l − 1 зна наборов βi , находится

δ1 δ2 . . . δl
чение. Применим к различным значениям δi функцию n (x) =
, принадлежащую классу CSk ,
τ1 τ2 . . . τl
следовательно, находящуюся в исходной системе.
2. l = k. В этом случае последнего шага не нужно:
y1 , . . . , ym
...
...
...
...

g
0
1
..
.
k−1

s1 (e
ym ) s2 (e
ym ) . . . sn (e
ym )
e
β1
βe2
..
.
e
βl

f (s1 , . . . , sn )
0
1
.
..
.
k−1

Действительно, если все значения различны, и принадлежат множеству {0, 1, . . . , k − 1}, то каждое из них принимается ровно по одному разу, и все наборы βei можно упорядочить так, чтобы получить желаемый порядок в
последнем столбце.

В качестве следствия теоремы 2.6 можно привести более слабый критерий полноты:
Теорема 2.7 (И. Слупецкий). Система функций, содержащая все одноместные функции) полна тогда и
только тогда, когда она содержит существенную функцию, принимающую все k значений.
Обозначим через hi, j (x) перестановку значений i и j. Очевидно, h0,1 (x) = x + j0 (x) + J1 (x). Легко проверить справедливость следующего утверждения:
(1)

Теорема 2.8 (С. Пикар). Следующие системы полны в Pk :
1. {x, h0,1 (x) , x + j0 (x)},

2. h0,1 (x) , h0,2 (x) , . . . , h0,k−1 (x) , x + j0 (x) .
Теорема 2.9 (критерий шефферовости). Функция f является шефферовой тогда и только тогда, когда из
нее можно получить все функции от одной переменной, принимающие не более k − 1 значения (класс CSk ).
 Док-во. Необходимость в данном случае очевидна. Покажем достаточность. Поскольку все константы принадлежат CSk , функция принимает все k значений. Докажем, что она существенная от противного: пусть она не является
существенной. Возможны два случая:
1. у f вообще нет существенных переменных, следовательно, она константа, что невозможно;
2. у f ровно одна существенная переменная, следовательно, она является перестановкой, то есть f ∈ Sk ⇒ [ f ] ⊆ Sk
и из нее нельзя получить константы.
Таким образом, f существенная и по теореме 2.6 система { f } полна.



Примеры. Используя критерий Слупецкого, доказать полноту в Pk нижеприводимых систем:

1. k − 1, x − y + 2, x2 −̇y
 Решение. Очевидно, что x − y + 2 — существенная функция, принимающая все k значений. Далее,
(k − 1)2 −̇ (k − 1) = 0, (k − 1)2 −̇0 = 1, x − 1 + 2 = x + 1 = x, 0 + 1 = 1, 12 − x = j0 (x). Также есть все константы
и все ji , x − (y + 2) + 2 = x − y, x − y − · · · − y = x + y ⇒ j1 (x) + · · · + j1 (x) = J1 (x) , h0,1 (x) = x + j0 (x) + J1 (x), так| {z }
|
{z
}
k−1

k−1

же имеется x + j0 (x). Следовательно, исходная система содержит систему Софи Пикар 1 и является полной по
теореме 2.7.


82

ГЛАВА 2. КОНЕЧНОЗНАЧНЫЕ ЛОГИКИ
2. {(1−̇x) · y + x · (1−̇y)}
 Решение. Обозначим f (x, y) = (1−̇x) · y + x · (1−̇y).
f (x, x) = j0 (x) , f (x, j0 (x)) = x, j0 ( f ( j0 (x) , x)) = 0,
f (0, x) = x + j0 (x) , f ( j1 (x) , x) = h0,1 (x) ,
получена система Софи Пикар 1. В то же время функция существенно зависит от обеих переменных и принимает
все k значений, следовательно, является шефферовой по теореме 2.7.

3.



j2 (x) , x + y2 , x · y + 1

 Решение. Функция x · y + 1 — существенная и принимает все k значений. Далее, j2 ( j2 (x)) = 0, 0 · 0 + 1 =
1, x + 12 = x, откуда можно получить все ji (x), x + j02 (x) = x + j0 (x) , x + j12 (x) + · · · + j12 (x) + j0 (x) = h0,1 (x). Сле|
{z
}
k−1

довательно, исходная система содержит систему Софи Пикар 1 и является полной по теореме 2.7.



4. {x−̇y, (∼ x) − y}
 Решение. Усеченная разность является существенной функцией, принимающей все k значений. Далее, x−̇x ≡
0, (∼ 0) − 0 = k − 1, (k − 1) − y =∼ y, (∼ (∼ x)) − y = x − y, x − y − · · · − y = x + y, (. . . (x−̇ 1)−̇ · · · )−̇1 = jk−1 (x) , 0 −
| {z }
| {z }
k−1

k−2

(k − 1) = 1, x + 1 = x, следовательно есть все ji (x), а, следовательно, есть и x + j0 (x), и h0,1 (x) = x + j0 (x) +
j1 (x) + · · · + j1 (x). Следовательно, исходная система содержит систему Софи Пикар 1 и является полной по тео|
{z
}
k−1

реме 2.7.
5.





j1 (x) , x − y, x2 − y

 Решение. Функция x − y является существенной и принимает все k значений. Далее, x − x ≡ 1, 12 − 1 =
0, x − 0 = x, следовательно, получены все константы, суммы вида x + i и ji (x), x − y − · · · − y = x + y, h0,1 (x) =
| {z }
k−1

x + j0 (x) + j1 (x) + · · · + j1 (x). Следовательно, исходная система содержит систему Софи Пикар 1 и является пол|
{z
}
k−1

ной по теореме 2.7.



6. {x, j0 (x) , x · y}
 Решение. Произведение является существенной функцией, принимающей все k значений. x · j0 (x) ≡ 0, следовательно, есть все константы и все ji (x). Далее рассмотрим функцию
f (x) = (1 + (x − 1) j1 (x)) (1 + (x − 1) j2 (x)) · · · (1 + (x − 1) jk−1 (x))
и заметим, что она равна как раз x + j0 (x). Осталось увидеть, что h0,1 (x) = f (x) · j0 ( j1 (x)). Следовательно, исходная система содержит систему Софи Пикар 1 и является полной по теореме 2.7.

Упражнения. Используя критерий Слупецкого, доказать полноту в Pk нижеприводимых систем:
1. {x − 1, (x + j0 (x)) · (1−̇y) + (1−̇x) · (y − j1 (x))};
2. {x · j0 (x − y) + (x − j1 (x)) · j0 (y) + y · j0 (x)};
3. { j0 (x − y) + x · j0 (y) + (x − j1 (x)) · j1 (y)};
4. {x · j0 (y) + j0 (x) · (y + j0 (y) − j1 (y)) + j1 (x) · (y − j0 (y))};
5. {y · j0 (x) + j1 (x) · (y + j0 (y)) + j1 (y) · ( j2 (x) − j1 (x))}.

2.4. ОСОБЕННОСТИ МНОГОЗНАЧНЫХ ЛОГИК

2.4

83

Особенности многозначных логик

Представление функции k-значной логики полиномами. Рассматриваются функции k-значной логики при k > 3
и исследуется вопрос об их представимости полиномами. Известно, что если f (e
xn ) 6≡ 0, то ее можно представить во
второй форме:
f (e
xn ) =
∑ f (α1 , . . . , αn ) · jα1 (x1 ) · jα2 (x2 ) · · · jαn (xn ) .
(α1 ,...,αn )
f (α1 ,...,αn )6=0

Из этого следует, что если все ji представить полиномами, то f (e
xn ) также представится полиномом. Очевидно, справедливо и обратное, то есть ∀ f ∈ Pol ⇔ ∀ ji (x) ∈ Pol, а поскольку ji (x) = j0 (x − i), то задача представимости полиномом
любой функции сводится к задаче представимости j0 . Полином функции одного переменного f (x) = a0 + a1 x + · · · +
ak−1 xk−1 можно пытаться найти методом неопределенных коэффициентов:

a0
= f (0) ,


 a +a +a +···+a

= f (1) ,

0
1
2
k−1

 ...........................................
a0 + a1 s + a2 s2 + · · · + ak−1 sk−1
= f (s) ,




.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.....



a0 + a1 (k − 1) + a2 (k − 1)2 + · · · + ak−1 (k − 1)k−1 = f (k − 1) .
Это — линейная система k уравнений с k неизвестными, матрица которой является матрицей Вандермонда:


1
12
...
1k−1
 2
22
...
2k−1 


. . . . . . . . . . . . . . . . . . . . . .
k − 1 (k − 1)2 . . . (k − 1)k−1
Определитель этой матрицы равен

∏

(i − j) (mod k) и отличен от нуля при простых k. Получим j0 (x) при про-

06 j<i6k−1

стых k.
Теорема 2.10 (П. Ферма, малая). Пусть p — простое. Тогда для любого a такого, что 1 6 a 6 p − 1 выполняется a p−1 ≡ 1 (mod p).
 Док-во. Все равенства в дальнейшем подразумеваются по модулю p. Пусть a удовлетворяет условию теоремы.
Рассмотрим набор чисел вида a · 1, a · 2, . . . , a · (p − 1). Очевидно, они все различны и не равны нулю. В то же время среди них содержатся в каком-то порядке все числа 1, 2, . . . , p − 1 (по модулю p). Перемножим их всех и получим
a p−1 (p − 1)! = (p − 1)! (mod p) ⇒ a p−1 ≡ 1 (mod p).

По теореме 2.10 нетрудно сообразить, как при простых значениях k = p будет выглядеть полином для функции j0 (x):
j0 (x) = 1 − x p−1 . Таким образом, получено, что при простых значениях k любая функция представима полиномом.
Пусть теперь k — составное. Докажем результат от противного: пусть j0 (x) = a0 + a1 x + · · · + as xs . Тогда j0 (0) = 1 ⇒
a0 = 1. Пусть 0 6= k1 | k ⇒ j0 (k1 ) = 1 + a1 k1 + · · · + as k1s = 0 ⇒ a1 k1 + · · · + as k1s = k − 1 ⇒ k1 | k − 1, чего не может быть
при k > 3. Объединить два полученных выше результата можно в следующей теореме.
Теорема 2.11. Класс функций, представимых полиномами полон тогда и только тогда, когда k — простое.
Теоремы о замкнутых классах в Pk при k > 3. В P2 любой замкнутый класс имеет конечный базис, следовательно,
замкнутых классов в P2 — счетное множество. В Pk при k > 3 ситуация совершенно другая.
Теорема 2.12 (Янов). В Pk при k > 3 существует замкнутый класс, не имеющий базиса.
 Док-во. Построим этот класс. Определим последовательность функций следующим образом: f0 = 0, для i = 1, ∞
(
1 x1 = x2 = · · · = xi = 2,
fi = fi (x1 , . . . , xi ) =
0 иначе.
F = { f0 , f1 , . . . , fm , . . .}. Рассмотрим все функции, получаемые из этих переименованием переменных без отождествления, это множество обозначим M . Докажем по индукции, что класс M замкнут. Для i = 1 это очевидно. Пусть теперь
это верно для i 6 n, докажем для i = n + 1. Рассмотрим f (A1 , . . . , Ai ). Если среди A1 , . . . , Ai есть хотя бы одна формула,
то функция является тождественным нулем и принадлежит M . Если же все A j различные переменные, то функция
получается из некоторой функции F переименованием переменных без отождествления, то есть
 принадлежит M .
Предположим, что у M существует базис. Тогда в нем существует функция f y1 , . . . , yn0 , имеющая наименьшее
число существенных переменных n0 среди всех функций базиса. Тогда возможны два различных случая.

84

ГЛАВА 2. КОНЕЧНОЗНАЧНЫЕ ЛОГИКИ
1. Существует еще одна функция f (u1 , . . . , un ), зависящая от n > n0 существенных переменных. Тогда первую функцию можно получить из этой переименованием переменных с отождествлением.
2. В базисе одна функция. Если это константа 0, то это не базис, следовательно, она должна иметь существенные переменные. В этом случае любая суперпозиция f (A1 , . . . , An ), содержащая формулы на местах переменных,
реализует тождественный ноль, а не содержащая формулы, зависит не более, чем от n переменных, то есть суперпозициями нельзя получить функцию fm , существенно зависящую от m > n переменных.


Теорема 2.13 (Мучник). В Pk при k > 3 существует замкнутый класс со счетным базисом.
 Док-во. Построим этот класс. Пусть F = { f2 , f3 , . . . , fi , . . .}, где
(
1 x1 = x2 = · · · = x j−1 = x j+1 = · · · = xi = 2, x j = 1, j = 1, i
fi (x1 , . . . , xi ) =
0 иначе.
Рассмотрим замыкание M = [F ]. Докажем, что F — базис. Действительно, F полна в M . Покажем, что из F нельзя
удалить ни одну из функций. Пусть для m 6= n существует fn (x1 , . . . , xn ) = fm (A1 , . . . , Am ). Возможны три случая:
1. Среди Ai есть хотя бы две формулы. Тогда они обе принимают значения 0 и 1 и
fm (A1 , . . . , Am ) ≡ 0
), но fn (x1 , . . . , xn ) 6≡ 0. Противоречие.
2. Среди Ai есть ровно одна формула. Тогда при m > 2 существует место, где есть символ переменной xl , 1 6 l 6 n.
Тогда на наборе xl = 1, xi = 2 (l 6= l) fn = 1, fm = 0. Противоречие.
3. Все Ai суть символы переменных. Тогда для m > n ввиду существенности каждой переменной fn неизбежны повторы, и есть два места с xl . На наборе xl = 1, xi = 2 (i 6= l) fn = 1, fm = 0. Противоречие.

Построенный в теореме 2.13 замкнутый класс не имеет конечных базисов. Из хода доказательства видно, что если
взять бесконечную систему F 0 = { fi1 , fi2 , . . . , fis , . . .}, то замкнутый класс M 0 = [F 0 ] будет иметь также счетный базис F 0 , то есть разные подпоследовательности F порождают разные замкнутые классы. Таким образом, справедливо
следующее утверждение.
Следствие 2.4.1 (из теоремы 2.13). Число замкнутых классов в Pk при k > 3 равно континуум.
Примеры.
1. Разложить в полином по модулю k функцию f из Pk :
(a) f = 2x−̇x2 , k = 5


0 1 2 2 4
 Решение. Эта функция задает подстановку
. Представим ее во второй форме: 2x−̇x2 =
0 1 0 0 2
j1 (x) + 2 j4 (x) = j0 (x − 1) + 2 j0 (x − 4) = j0 (x − 1) + 2 j0 (x + 1) = 1 − (x − 1)4 + 2 − 2 (x − 4)4 = 3 − x4 + 4x3 −
6x2 + 4x − 1 − 2x4 − 8x3 − 12x2 − 8x − 2 = 2x4 + x3 + 2x2 + x.

(b) f = max (2x−̇y, x · y) , k = 3
 Решение. Таблица этой функции имеет следующий вид:
y
H
x H
0
1
2

0
0
2
1

1
0
1
2

2
0
2
1


Теперь легко видеть, что эта функция просто равна xy + 2x j0 (y) = xy + 2x 1 − y2 = xy2 + xy + 2x.

(c) f = min x2 , y , k = 3



85

2.4. ОСОБЕННОСТИ МНОГОЗНАЧНЫХ ЛОГИК
 Решение. Таблица этой функции имеет следующий вид:
y
H
x H
0
1
2

0
0
0
0

1
0
1
1

2
0
1
1

Теперь легко видеть, что эта функция просто равна x2 y2 .



2. Выяснить, представима ли полиномом по модулю k функция f из Pk , если:
(a) f = 2 (J1 (x) + J4 (x)) , k = 6

0 1 2 2
 Решение. Эта функция задает подстановку
0 4 0 0
лю 6 с тем, чтобы ограничить степень искомого полинома:
x
x0
x1
x2
x3

0
1
0
0
0

1
1
1
1
1

2
1
2
4
2

3
1
3
3
3


5
. Выпишем табличку степеней по моду0

4
4
4
1
4
4
4

5
1
5
1
5

Легко видеть, что начиная с кубов все степени повторяют стоящие на две строки выше. Следовательно,
достаточно ограничиться квадратами. Поскольку функция сохраняет ноль, искать ее полином будем в виде
ax2 + bx. Решим соответствующую систему линейных уравнений:
1
2
3
4
5

1
4
3
4
0

1
4
0
0
0 ∼ 0
4
0
0
0

1
2
0
0
2

4
4
1
0 ∼
0
0
4

1
2

4
⇒
4



a = 2, b = 2;
a = 5, b = 5.

Таким образом, f (x) = 2x2 + 2x = 5x2 + 5x при k = 6.



(b) f = (max (x, y) − min (x, y))2 , k = 4
 Решение. Если x > y, то выражение в скобках равно x − y, иначе оно равно y − x, но в любом случае
его квадрат равен (x − y)2 = x2 − 2xy + y2 = x2 + (k − 2) xy + y2 , при k = 4: x2 + 2xy + y2 . Заметим, что данная
функция представима полиномом при любом значении k.

(c) f = 3 j0 (x) , k = 6


0 1 2 2 4 5
 Решение. Эта функция задает подстановку
. Как было показано в примере 2a,
0 4 0 0 4 0
достаточно ограничиться квадратами. Также, поскольку f (0) = 3, полином имеет смысл искать в виде
3 + ax + bx2 . Решим соответствующую систему линейных уравнений:
1
2
3
4
5

1
4
3
4
0

3
1
0
0
0 ∼ 0
0
0
0
0

1
2
0
0
2

3
0
3
0
3

Третья строчка показывает, что решений нет.



3. Доказать, что приводимые ниже системы полны в Pk тогда и только тогда, когда k — простое число:
(a) {1, x + y + x · z}
 Решение. Очевидно, что при составных k система не полна, так как состоит из полиномов. При k = 2
система сохраняет единицу, так что в дальнейшем k — простое и нечетное. Имеем 1 + y + 1 · 1 = y +
2, x + 2 + · · · + 2 = x + 1. Из этого можно получить все константы, x + y + x · 0 = x + y, x + 0 + x · y =
| {z }
p+1
2

x (y + 1) , x (y + (k − 1) + 1) = xz. Получен базис системы полиномов — умножение, сложение и константа
1, следовательно, при простых k система полна.


86

ГЛАВА 2. КОНЕЧНОЗНАЧНЫЕ ЛОГИКИ
(b)


x − y + 1, x2 − y, x · y2
 Решение. Поскольку все представленные в системе функции — полиномы, она не полна при составных
значениях k. При k = 2 система полна, так как первая функция не сохраняет ноль, не самодвойственная и не
монотонная, вторая не сохраняет единицу, а третья нелинейная, так что в дальнейшем k простое и нечетное.
Имеем x − x + 1 ≡ 1, 12 − 1 = 0, x − 0 + 1 = x + 1, следовательно, есть все константы и все функции вида
x + i. Теперь получаем функцию x + (k − 1) y + 1 + · · · + (k − 1) y + 1 = x + y + k − 1, откуда x + y + 1 + k − 1 =
|
{z
}
k−1

x + y. Далее, 1 · x2 = x2 , (x + y)2 − x2 + y2 = 2xy, 2xy + · · · + 2xy = xy. Получен базис системы полиномов —
|
{z
}
k+1
2

умножение, сложение и константа 1, следовательно, при простых k система полна.



(c) {1 + x1 − x2 + x1 · x2 · · · xk }
 Решение. Поскольку все представленные в системе функции — полиномы, она не полна при составных
значениях k. В дальнейшем k простое. Имеем, 1+x −x +xk = x +1, 1+x −x +x ·xx · · · (x + (k − 1)) ≡ 0, 1+x1 −
x2 + x1 x2 · 0 · · · 0 = 1 + x1 − x2 , 1 + x1 − (x2 + 1) = x1 − x2 , x1 − x2 − · · · − x2 = x1 + x2 , 1 + x1 − 1 + x1 · 1 · · · 1 · x2 =
|
{z
}
k−1

x1 + x1 x2 , x1 + x1 x2 − x1 = x1 x2 . Получен базис системы полиномов — умножение, сложение и константа 1,
следовательно, при простых k система полна.

Упражнения.
1. Разложить в полином по модулю k функцию f из Pk :

(a) f = min x2 , x3 , k = 5;

(b) f = max 2x−̇1, x2 , k = 5;
(c) f = 3x−̇ (x−̇2x) , k = 7;


(d) f = max (x−̇1)2 , x3 , k = 7;
(e) f = x−̇y, k = 3;
(f) f = Jk−2 (x) , k — произвольное простое число;

(g) f = j2 x − x2 , k — произвольное простое число.
2. Выяснить, представима ли полиномом по модулю k функция f из Pk , если:
(a) f = 3x−̇2x2 , k = 4;
(b) f = (x−̇y) −̇y, k = 4.
3. Доказать, что приводимые ниже системы полны в Pk тогда и только тогда, когда k — простое число:

(a) x − 1, x + y, x2 · y ;
(b) {k − 1, x · y + x − y + z};

(c) k − 2, x + 2y, x · y2 ;

(d) ∼ x, x − y, x2 · y ;
(e) {x − 2, x + 2y + 1, x · y − x − y};

(f) 1, 2x + y, x · y2 − x + y ;

(g) x + y + 1, x · y − x2 ;
(h) {x − 2y, x · y + x + 1}.

